# Analyze the Results and Post-Processing

Besides the diffusion of the CVs, you can perform a block analysis to assess the error and check the simulation's convergence. The PLUMED [error analysis](https://www.plumed-tutorials.org/lessons/21/002/data/NAVIGATION.html) and [metadynamics](https://www.plumed-tutorials.org/lessons/21/004/data/NAVIGATION.html) tutorials discuss these in more detail. This section provides some guidelines on reweighing the simulation to obtain the free energy surface.

## Reweighing Multiple Walkers Metadynamics Simulations

You may have already been introduced to the two main routes of reweighing a metadynamics simulation from the PLUMED metadynamics tutorial: [Calculate the weights from the time-dependence of the metadynamics bias potential](https://pubs.acs.org/doi/10.1021/jp504920s) or [calculate the weights from the metadynamics bias potential obtained at the end of the simulation](https://pubs.acs.org/doi/full/10.1021/ct3002464). This tutorial uses the former way as an example.

To reweigh the frames from multiple walkers metadynamics simulations, you can perform the reweighing for each walker independently and then combine all the histograms to convert the free energy surface. You can construct a `plumed_reweight.dat` file for each walker as follows:
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/./solutions/walker-0/plumed_reweight.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="plumed_reweight.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="plumed_reweight.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-failed-red.svg" alt="tested onmaster" /></a></div>
<div class="headerBadge"><img class="toggler" src="https://img.shields.io/badge/master-incomplete-yellow.svg" alt="tested on master" onmouseup='toggleDisplay("data/./solutions/walker-0/plumed_reweight.dat")' onmousedown='toggleDisplay("data/./solutions/walker-0/plumed_reweight.dat")'/></div>
</div>
</div>
<div id="data/./solutions/walker-0/plumed_reweight.dat_short">
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Read the COLVAR file</span>
<b name="data/./solutions/walker-0/plumed_reweight.datcv1" onclick='showPath("data/./solutions/walker-0/plumed_reweight.dat","data/./solutions/walker-0/plumed_reweight.datcv1","data/./solutions/walker-0/plumed_reweight.datcv1","brown")'>cv1</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=cv1
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight.datcv1">The READ action with label <b>cv1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cv1..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight.datcv2" onclick='showPath("data/./solutions/walker-0/plumed_reweight.dat","data/./solutions/walker-0/plumed_reweight.datcv2","data/./solutions/walker-0/plumed_reweight.datcv2","brown")'>cv2</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=cv2
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight.datcv2">The READ action with label <b>cv2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cv2..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight.datmetad" onclick='showPath("data/./solutions/walker-0/plumed_reweight.dat","data/./solutions/walker-0/plumed_reweight.datmetad","data/./solutions/walker-0/plumed_reweight.datmetad","brown")'>metad</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=metad.rbias

<span style="color:blue" class="comment"># Define weights</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight.datmetad">The READ action with label <b>metad</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">metad..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight.datweights" onclick='showPath("data/./solutions/walker-0/plumed_reweight.dat","data/./solutions/walker-0/plumed_reweight.datweights","data/./solutions/walker-0/plumed_reweight.datweights","brown")'>weights</b>: <span class="plumedtooltip" style="color:green">REWEIGHT_METAD<span class="right">Calculate the weights configurations should contribute to the histogram in a simulation in which a metadynamics bias acts upon the system. <a href="https://www.plumed.org/doc-master/user-doc/html/REWEIGHT_METAD" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">TEMP<span class="right">the system temperature<i></i></span></span>=300

<span style="color:blue" class="comment"># Calculate histograms</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight.datweights">The REWEIGHT_METAD action with label <b>weights</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">weights.value</td><td>the weight to use for this frame to negate the effect the metadynamics bias</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight.dathh" onclick='showPath("data/./solutions/walker-0/plumed_reweight.dat","data/./solutions/walker-0/plumed_reweight.dathh","data/./solutions/walker-0/plumed_reweight.dathh","brown")'>hh</b>: <span class="plumedtooltip" style="color:green">HISTOGRAM<span class="right">Accumulate the average probability density along a few CVs from a trajectory. <a href="https://www.plumed.org/doc-master/user-doc/html/HISTOGRAM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the quantities that are being used to construct the histogram<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight.datcv1">cv1</b>,<b name="data/./solutions/walker-0/plumed_reweight.datcv2">cv2</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.1,0.3 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=0.4,5.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=255,255 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.01,0.15 <span class="plumedtooltip">LOGWEIGHTS<span class="right">the logarithm of the quantity to use as the weights when calculating averages<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight.datweights">weights</b> <span class="plumedtooltip">NORMALIZATION<span class="right"> This controls how the data is normalized it can be set equal to true, false or ndata<i></i></span></span>=true <span class="plumedtooltip">CLEAR<span class="right"> the frequency with whihc to clear the data that is being averaged<i></i></span></span>=<span style="background-color:yellow">__FILL__</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight.dathh">The HISTOGRAM action with label <b>hh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hh.value</td><td>the estimate of the histogram as a function of the argument that was obtained</td></tr></table></span><span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GRID<span class="right">the grid you would like to print (can also use ARG for specifying what is being printed)<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight.dathh">hh</b> <span class="plumedtooltip">FILE<span class="right"> the file on which to write the grid<i></i></span></span>=histogram.dat <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=<span style="background-color:yellow">__FILL__</span>
</pre></div>
<div style="display:none;" id="data/./solutions/walker-0/plumed_reweight.dat_long"><pre class="plumedlisting">
<span style="color:blue" class="comment"># Read the COLVAR file</span>
<b name="data/./solutions/walker-0/plumed_reweight.dat_solcv1" onclick='showPath("data/./solutions/walker-0/plumed_reweight.dat","data/./solutions/walker-0/plumed_reweight.dat_solcv1","data/./solutions/walker-0/plumed_reweight.dat_solcv1","brown")'>cv1</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=cv1
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight.dat_solcv1">The READ action with label <b>cv1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cv1..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight.dat_solcv2" onclick='showPath("data/./solutions/walker-0/plumed_reweight.dat","data/./solutions/walker-0/plumed_reweight.dat_solcv2","data/./solutions/walker-0/plumed_reweight.dat_solcv2","brown")'>cv2</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=cv2
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight.dat_solcv2">The READ action with label <b>cv2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cv2..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight.dat_solmetad" onclick='showPath("data/./solutions/walker-0/plumed_reweight.dat","data/./solutions/walker-0/plumed_reweight.dat_solmetad","data/./solutions/walker-0/plumed_reweight.dat_solmetad","brown")'>metad</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=metad.rbias

<span style="color:blue" class="comment"># Define weights</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight.dat_solmetad">The READ action with label <b>metad</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">metad..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight.dat_solweights" onclick='showPath("data/./solutions/walker-0/plumed_reweight.dat","data/./solutions/walker-0/plumed_reweight.dat_solweights","data/./solutions/walker-0/plumed_reweight.dat_solweights","brown")'>weights</b>: <span class="plumedtooltip" style="color:green">REWEIGHT_METAD<span class="right">Calculate the weights configurations should contribute to the histogram in a simulation in which a metadynamics bias acts upon the system. <a href="https://www.plumed.org/doc-master/user-doc/html/REWEIGHT_METAD" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">TEMP<span class="right">the system temperature<i></i></span></span>=300

<span style="color:blue" class="comment"># Calculate histograms</span>
<span style="color:blue" class="comment"># Assume the errors converge at a block size of 50 ps</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight.dat_solweights">The REWEIGHT_METAD action with label <b>weights</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">weights.value</td><td>the weight to use for this frame to negate the effect the metadynamics bias</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight.dat_solhh" onclick='showPath("data/./solutions/walker-0/plumed_reweight.dat","data/./solutions/walker-0/plumed_reweight.dat_solhh","data/./solutions/walker-0/plumed_reweight.dat_solhh","brown")'>hh</b>: <span class="plumedtooltip" style="color:green">HISTOGRAM<span class="right">Accumulate the average probability density along a few CVs from a trajectory. <a href="https://www.plumed.org/doc-master/user-doc/html/HISTOGRAM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the quantities that are being used to construct the histogram<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight.dat_solcv1">cv1</b>,<b name="data/./solutions/walker-0/plumed_reweight.dat_solcv2">cv2</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.1,0.3 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=0.4,5.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=255,255 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.01,0.15 <span class="plumedtooltip">LOGWEIGHTS<span class="right">the logarithm of the quantity to use as the weights when calculating averages<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight.dat_solweights">weights</b> <span class="plumedtooltip">NORMALIZATION<span class="right"> This controls how the data is normalized it can be set equal to true, false or ndata<i></i></span></span>=true <span class="plumedtooltip">CLEAR<span class="right"> the frequency with whihc to clear the data that is being averaged<i></i></span></span>=10000
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight.dat_solhh">The HISTOGRAM action with label <b>hh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hh.value</td><td>the estimate of the histogram as a function of the argument that was obtained</td></tr></table></span><span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GRID<span class="right">the grid you would like to print (can also use ARG for specifying what is being printed)<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight.dat_solhh">hh</b> <span class="plumedtooltip">FILE<span class="right"> the file on which to write the grid<i></i></span></span>=histogram.dat <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=10000
</pre></div>

 {% endraw %} 
Note that you will need to determine the values of CLEAR in HISTOGRAM and STRIDE in DUMPGRID for the block size in your block analysis. You can perform the reweighing using PLUMED tools:
```
plumed driver --plumed plumed_reweight.dat --noatoms
```

After reweighing all the walkers, you can combine all the histograms to calculate the free energy and the associated error. You can either do it using PLUMED or with the following Python script:
```python
import numpy as np
import matplotlib.pyplot as plt
import glob
import scipy.stats

# This is a script to calculate the free energy surface from the histograms obtained from multiple walkers metadynamics simulations with two collective variables (CV)
# This script uses two walkers as an example

# Function to read in histogram data, normalization, and number of bins for the two CVs
def readhistogram( fname ) :
        # Read in the histogram data
        data = np.loadtxt( fname )
        with open( fname, "r" ) as myfile :
                for line in myfile :
                        if line.startswith("#! SET normalisation") : norm = line.split()[3]
                        if line.startswith("#! SET nbins_cv1") : nbin_cv1 = int(line.split()[3]) + 1
                        if line.startswith("#! SET nbins_cv2") : nbin_cv2 = int(line.split()[3]) + 1
        return float(norm), data, nbin_cv1, nbin_cv2

# Calculate weighted average
norm0, hist0, binx0, biny0 = readhistogram( "./path/to/your/walker-0/directory/histogram.dat" )
N, average = norm0, norm0*hist0[:,2]
norm1, hist1, binx1, biny1 = readhistogram( "./path/to/your/walker-1/directory/histogram.dat" )
N, average = N + norm1, average + norm1*hist1[:,2]
for filen in glob.glob( "./*/analysis.*.histogram.dat" ) :
    norm, histn, binxn, binyn = readhistogram(filen)
    N, average = N + norm, average + norm*histn[:,2]
average = average / N

# Calculate errors
error = norm0*norm0*(hist0[:,2]-average[:])**2
error = error + norm1*norm1*(hist0[:,2]-average[:])**2
for filen in glob.glob( "./*/analysis.*.histogram.dat" ) :
    norm, histn, binxn, binyn = readhistogram(filen)
    error = error + norm*norm*(histn[:,2]-average[:])**2
error = np.sqrt( (error / (N*N)) )

# Convert to free energy
fes = -2.494*np.log( average )
fes -= np.amin(fes)

# Convert to error in fes
ferr = 2.494*error / average
with open('fes-ferr-block-average.dat', 'w') as fout:
    for i in range(len(fes)):
        fout.write("%f  %f  %f  %f\n" % (hist0[:,0][i]*10, hist0[:,1][i], fes[i], ferr[I]))
```

Sometimes, you may want to reweigh the simulation on a different CV, which is not biased through the metadynamics simulation. In this case, you just need to modify the `plumed_reweight.dat` file to inform PLUMED tools to read a different CV column from the COLVAR file:
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/./solutions/walker-0/plumed_reweight_newcv.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="plumed_reweight_newcv.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="plumed_reweight_newcv.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-failed-red.svg" alt="tested onmaster" /></a></div>
<div class="headerBadge"><img class="toggler" src="https://img.shields.io/badge/master-incomplete-yellow.svg" alt="tested on master" onmouseup='toggleDisplay("data/./solutions/walker-0/plumed_reweight_newcv.dat")' onmousedown='toggleDisplay("data/./solutions/walker-0/plumed_reweight_newcv.dat")'/></div>
</div>
</div>
<div id="data/./solutions/walker-0/plumed_reweight_newcv.dat_short">
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Read the COLVAR file</span>
<b name="data/./solutions/walker-0/plumed_reweight_newcv.datcv1" onclick='showPath("data/./solutions/walker-0/plumed_reweight_newcv.dat","data/./solutions/walker-0/plumed_reweight_newcv.datcv1","data/./solutions/walker-0/plumed_reweight_newcv.datcv1","brown")'>cv1</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=cv1
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.datcv1">The READ action with label <b>cv1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cv1..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight_newcv.datcv2" onclick='showPath("data/./solutions/walker-0/plumed_reweight_newcv.dat","data/./solutions/walker-0/plumed_reweight_newcv.datcv2","data/./solutions/walker-0/plumed_reweight_newcv.datcv2","brown")'>cv2</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=<span style="background-color:yellow">__FILL__</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.datcv2">The READ action with label <b>cv2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cv2..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight_newcv.datmetad" onclick='showPath("data/./solutions/walker-0/plumed_reweight_newcv.dat","data/./solutions/walker-0/plumed_reweight_newcv.datmetad","data/./solutions/walker-0/plumed_reweight_newcv.datmetad","brown")'>metad</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=metad.rbias

<span style="color:blue" class="comment"># Define weights</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.datmetad">The READ action with label <b>metad</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">metad..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight_newcv.datweights" onclick='showPath("data/./solutions/walker-0/plumed_reweight_newcv.dat","data/./solutions/walker-0/plumed_reweight_newcv.datweights","data/./solutions/walker-0/plumed_reweight_newcv.datweights","brown")'>weights</b>: <span class="plumedtooltip" style="color:green">REWEIGHT_METAD<span class="right">Calculate the weights configurations should contribute to the histogram in a simulation in which a metadynamics bias acts upon the system. <a href="https://www.plumed.org/doc-master/user-doc/html/REWEIGHT_METAD" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">TEMP<span class="right">the system temperature<i></i></span></span>=300

<span style="color:blue" class="comment"># Calculate histograms</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.datweights">The REWEIGHT_METAD action with label <b>weights</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">weights.value</td><td>the weight to use for this frame to negate the effect the metadynamics bias</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight_newcv.dathh" onclick='showPath("data/./solutions/walker-0/plumed_reweight_newcv.dat","data/./solutions/walker-0/plumed_reweight_newcv.dathh","data/./solutions/walker-0/plumed_reweight_newcv.dathh","brown")'>hh</b>: <span class="plumedtooltip" style="color:green">HISTOGRAM<span class="right">Accumulate the average probability density along a few CVs from a trajectory. <a href="https://www.plumed.org/doc-master/user-doc/html/HISTOGRAM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the quantities that are being used to construct the histogram<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight_newcv.datcv1">cv1</b>,<b name="data/./solutions/walker-0/plumed_reweight_newcv.datcv2">cv2</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.1,__FILL__ <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=0.4,__FILL__ <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=255,255 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.01,__FILL__ <span class="plumedtooltip">LOGWEIGHTS<span class="right">the logarithm of the quantity to use as the weights when calculating averages<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight_newcv.datweights">weights</b> <span class="plumedtooltip">NORMALIZATION<span class="right"> This controls how the data is normalized it can be set equal to true, false or ndata<i></i></span></span>=true <span class="plumedtooltip">CLEAR<span class="right"> the frequency with whihc to clear the data that is being averaged<i></i></span></span>=<span style="background-color:yellow">__FILL__</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.dathh">The HISTOGRAM action with label <b>hh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hh.value</td><td>the estimate of the histogram as a function of the argument that was obtained</td></tr></table></span><span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GRID<span class="right">the grid you would like to print (can also use ARG for specifying what is being printed)<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight_newcv.dathh">hh</b> <span class="plumedtooltip">FILE<span class="right"> the file on which to write the grid<i></i></span></span>=histogram.dat <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=<span style="background-color:yellow">__FILL__</span>
</pre></div>
<div style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.dat_long"><pre class="plumedlisting">
<span style="color:blue" class="comment"># Read the COLVAR file</span>
<b name="data/./solutions/walker-0/plumed_reweight_newcv.dat_solcv1" onclick='showPath("data/./solutions/walker-0/plumed_reweight_newcv.dat","data/./solutions/walker-0/plumed_reweight_newcv.dat_solcv1","data/./solutions/walker-0/plumed_reweight_newcv.dat_solcv1","brown")'>cv1</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=cv1
<span style="color:blue" class="comment"># Assume we want to reweigh the simulation on the number of H-bonds received by the NO2 fragment based on the H-bonds matrix</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.dat_solcv1">The READ action with label <b>cv1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cv1..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight_newcv.dat_solcv2" onclick='showPath("data/./solutions/walker-0/plumed_reweight_newcv.dat","data/./solutions/walker-0/plumed_reweight_newcv.dat_solcv2","data/./solutions/walker-0/plumed_reweight_newcv.dat_solcv2","brown")'>cv2</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=hbmat2.sum
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.dat_solcv2">The READ action with label <b>cv2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cv2..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight_newcv.dat_solmetad" onclick='showPath("data/./solutions/walker-0/plumed_reweight_newcv.dat","data/./solutions/walker-0/plumed_reweight_newcv.dat_solmetad","data/./solutions/walker-0/plumed_reweight_newcv.dat_solmetad","brown")'>metad</b>: <span class="plumedtooltip" style="color:green">READ<span class="right">Read quantities from a colvar file. <a href="https://www.plumed.org/doc-master/user-doc/html/READ" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">FILE<span class="right">the name of the file from which to read these quantities<i></i></span></span>=COLVAR <span class="plumedtooltip">IGNORE_TIME<span class="right"> ignore the time in the colvar file<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the values to read from the file<i></i></span></span>=metad.rbias

<span style="color:blue" class="comment"># Define weights</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.dat_solmetad">The READ action with label <b>metad</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">metad..#!custom</td><td>the names of the output components for this action depend on the actions input file see the example inputs below for details</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight_newcv.dat_solweights" onclick='showPath("data/./solutions/walker-0/plumed_reweight_newcv.dat","data/./solutions/walker-0/plumed_reweight_newcv.dat_solweights","data/./solutions/walker-0/plumed_reweight_newcv.dat_solweights","brown")'>weights</b>: <span class="plumedtooltip" style="color:green">REWEIGHT_METAD<span class="right">Calculate the weights configurations should contribute to the histogram in a simulation in which a metadynamics bias acts upon the system. <a href="https://www.plumed.org/doc-master/user-doc/html/REWEIGHT_METAD" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">TEMP<span class="right">the system temperature<i></i></span></span>=300

<span style="color:blue" class="comment"># Calculate histograms</span>
<span style="color:blue" class="comment"># Assume the errors converge at a block size of 50 ps</span>
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.dat_solweights">The REWEIGHT_METAD action with label <b>weights</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">weights.value</td><td>the weight to use for this frame to negate the effect the metadynamics bias</td></tr></table></span><b name="data/./solutions/walker-0/plumed_reweight_newcv.dat_solhh" onclick='showPath("data/./solutions/walker-0/plumed_reweight_newcv.dat","data/./solutions/walker-0/plumed_reweight_newcv.dat_solhh","data/./solutions/walker-0/plumed_reweight_newcv.dat_solhh","brown")'>hh</b>: <span class="plumedtooltip" style="color:green">HISTOGRAM<span class="right">Accumulate the average probability density along a few CVs from a trajectory. <a href="https://www.plumed.org/doc-master/user-doc/html/HISTOGRAM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the quantities that are being used to construct the histogram<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight_newcv.dat_solcv1">cv1</b>,<b name="data/./solutions/walker-0/plumed_reweight_newcv.dat_solcv2">cv2.sum</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.1,0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=0.4,5.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=255,255 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.01,0.05 <span class="plumedtooltip">LOGWEIGHTS<span class="right">the logarithm of the quantity to use as the weights when calculating averages<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight_newcv.dat_solweights">weights</b> <span class="plumedtooltip">NORMALIZATION<span class="right"> This controls how the data is normalized it can be set equal to true, false or ndata<i></i></span></span>=true <span class="plumedtooltip">CLEAR<span class="right"> the frequency with whihc to clear the data that is being averaged<i></i></span></span>=10000
<span style="display:none;" id="data/./solutions/walker-0/plumed_reweight_newcv.dat_solhh">The HISTOGRAM action with label <b>hh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hh.value</td><td>the estimate of the histogram as a function of the argument that was obtained</td></tr></table></span><span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GRID<span class="right">the grid you would like to print (can also use ARG for specifying what is being printed)<i></i></span></span>=<b name="data/./solutions/walker-0/plumed_reweight_newcv.dat_solhh">hh</b> <span class="plumedtooltip">FILE<span class="right"> the file on which to write the grid<i></i></span></span>=histogram.dat <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=10000
</pre></div>

 {% endraw %} 
