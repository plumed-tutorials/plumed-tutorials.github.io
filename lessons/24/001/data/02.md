# Tutorial 2:<br> Generating a conformational ensemble with GMX and hySAS
The main purpose of hySAS is to allow an MD engine, independently of the force field, to generate a conformational ensemble that is in agreement with the experimental data. To achieve this, a potential is added to the system to discourage conformations that do not match the measured signal. Here, we propose two examples of coupling methods to introduce this energy penalty during the MD simulation.

Most of the SAS options have been discussed in Tutorial 1, here we present two additional flags: EXPINT and SCALE_EXPINT. For each QVALUE is required an EXPINT value, which consists in the experimental intensity measured at that specific momentum transfer. All the EXPINT values must be rescaled to the SAXS intensity at q = 0. To facilitate this operation, it is possible to automatically rescale all the experimental intensity entries with SCALE_EXPINT, which allows to provide the intensity at q = 0. In this way, each EXPINT is divided by SCALE_EXPINT.

In general, the more the q-values and the corresponding experimental intensities, the more intensive the calculation.

#### HARMONIC / LINEAR RESTRAINT

In this example, the SAXS profile is calculated using the ONEBEAD mapping, specifying a solvent electron density of 334 electrons/nm<sup>3</sup> and a correction of 80 electrons/nm<sup>3</sup> for the beads exposed to the solvent. The solvent-accessible surface calculation, which is required to assess the beads' exposure to the solvent, is performed every 10 steps of the simulation. The theoretical intensity at q = 0 is defined by SCALE_EXPINT, while the experimentally determined intensity for a given QVALUE is reported by EXPINT. All the EXPINT values are rescaled by the SCALE_EXPINT value.

The STATS action is then used to calculate statistical properties between the intensities computed from the coordinates of the simulated system for each QVALUE and the corresponding experimental references defined with EXPINT. Specifically, the correlation between the *in silico* intensities and the experimental intensities is considered as an argument for RESTRAINT, an action from the BIAS module. As additional information useful to follow the evolution of the simulation, the radius of gyration of the system is printed every 100 steps. Additional `{}` brackets have been added to prevent a readability issue, they are optional to run the code. When curly brackets are used, ensure that the entire list of arguments is enclosed within one set of curly brackets.

Detailed information on STATS, RESTRAINT and GYRATION can be found in the PLUMED manual.

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/02.md_working_1.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="02.md_working_1.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="02.md_working_1.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span class="plumedtooltip" style="color:green">MOLINFO<span class="right">This command is used to provide information on the molecules that are present in your system. <a href="https://www.plumed.org/doc-master/user-doc/html/MOLINFO" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">STRUCTURE<span class="right">a file in pdb format containing a reference structure<i></i></span></span>=template_AA.pdb

<span id="data/02.md_working_1.datdefSAXS_short"><span style="display:none;" id="data/02.md_working_1.dat">The MOLINFO action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">SAXS<span class="right">Calculates SAXS intensity. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/02.md_working_1.datdefSAXS");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/SAXS">More details</a><i></i></span></span> ...
        <span class="plumedtooltip">LABEL<span class="right">a label for the action so that its output can be referenced in the input to other actions<i></i></span></span>=<b name="data/02.md_working_1.datSAXS" onclick='showPath("data/02.md_working_1.dat","data/02.md_working_1.datSAXS","data/02.md_working_1.datSAXS","black")'>SAXS</b><span style="display:none;" id="data/02.md_working_1.datSAXS">The SAXS action with label <b>SAXS</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">SAXS.q-0</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 0th of these quantities</td></tr><tr><td width="5%">SAXS.q-1</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 1th of these quantities</td></tr><tr><td width="5%">SAXS.q-2</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 2th of these quantities</td></tr><tr><td width="5%">SAXS.q-3</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 3th of these quantities</td></tr><tr><td width="5%">SAXS.q-4</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 4th of these quantities</td></tr><tr><td width="5%">SAXS.q-5</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 5th of these quantities</td></tr><tr><td width="5%">SAXS.q-6</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 6th of these quantities</td></tr><tr><td width="5%">SAXS.q-7</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 7th of these quantities</td></tr><tr><td width="5%">SAXS.q-8</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 8th of these quantities</td></tr><tr><td width="5%">SAXS.q-9</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 9th of these quantities</td></tr><tr><td width="5%">SAXS.q-10</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 10th of these quantities</td></tr><tr><td width="5%">SAXS.q-11</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 11th of these quantities</td></tr><tr><td width="5%">SAXS.q-12</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 12th of these quantities</td></tr><tr><td width="5%">SAXS.exp-0</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 0th of these quantities</td></tr><tr><td width="5%">SAXS.exp-1</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 1th of these quantities</td></tr><tr><td width="5%">SAXS.exp-2</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 2th of these quantities</td></tr><tr><td width="5%">SAXS.exp-3</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 3th of these quantities</td></tr><tr><td width="5%">SAXS.exp-4</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 4th of these quantities</td></tr><tr><td width="5%">SAXS.exp-5</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 5th of these quantities</td></tr><tr><td width="5%">SAXS.exp-6</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 6th of these quantities</td></tr><tr><td width="5%">SAXS.exp-7</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 7th of these quantities</td></tr><tr><td width="5%">SAXS.exp-8</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 8th of these quantities</td></tr><tr><td width="5%">SAXS.exp-9</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 9th of these quantities</td></tr><tr><td width="5%">SAXS.exp-10</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 10th of these quantities</td></tr><tr><td width="5%">SAXS.exp-11</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 11th of these quantities</td></tr><tr><td width="5%">SAXS.exp-12</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 12th of these quantities</td></tr></table></span>
        <span class="plumedtooltip">ATOMS<span class="right">The atoms to be included in the calculation, e<i></i></span></span>=1-11878
        <span class="plumedtooltip">ONEBEAD<span class="right"> calculate SAXS for a single bead model<i></i></span></span>
        <span class="plumedtooltip">TEMPLATE<span class="right"> A PDB file is required for ONEBEAD mapping<i></i></span></span>=template_AA.pdb
        <span style="color:blue" class="comment">#GPU            #This flag requires PLUMED to be compiled with Arrayfire</span>
        <span class="plumedtooltip">SOLVDENS<span class="right"> Density of the solvent to be used for the correction of atomistic form factors<i></i></span></span>=0.334
        <span class="plumedtooltip">SOLVATION_CORRECTION<span class="right"> Solvation layer electron density correction (ONEBEAD only)<i></i></span></span>=0.080
        <span class="plumedtooltip">SOLVATION_STRIDE<span class="right"> Number of steps between every new residues solvation estimation via LCPO (ONEBEAD only)<i></i></span></span>=10
        <span class="plumedtooltip">SASA_CUTOFF<span class="right"> SASA value to consider a residue as exposed to the solvent (ONEBEAD only)<i></i></span></span>=0.7
        <span class="plumedtooltip">SCALE_EXPINT<span class="right"> Scaling value for experimental data normalization<i></i></span></span>=0.281543E+00

<span class="plumedtooltip">QVALUE1<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.00444189      <span class="plumedtooltip">EXPINT1<span class="right">Add an experimental value for each q value<i></i></span></span>=0.279832E+00
<span class="plumedtooltip">QVALUE2<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0133257       <span class="plumedtooltip">EXPINT2<span class="right">Add an experimental value for each q value<i></i></span></span>=0.266507E+00
<span class="plumedtooltip">QVALUE3<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0222823       <span class="plumedtooltip">EXPINT3<span class="right">Add an experimental value for each q value<i></i></span></span>=0.241456E+00
<span class="plumedtooltip">QVALUE4<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0312965       <span class="plumedtooltip">EXPINT4<span class="right">Add an experimental value for each q value<i></i></span></span>=0.207871E+00
<span class="plumedtooltip">QVALUE5<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0402661       <span class="plumedtooltip">EXPINT5<span class="right">Add an experimental value for each q value<i></i></span></span>=0.170297E+00
<span class="plumedtooltip">QVALUE6<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0534267       <span class="plumedtooltip">EXPINT6<span class="right">Add an experimental value for each q value<i></i></span></span>=0.116142E+00
<span class="plumedtooltip">QVALUE7<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0786047       <span class="plumedtooltip">EXPINT7<span class="right">Add an experimental value for each q value<i></i></span></span>=0.427377E-01
<span class="plumedtooltip">QVALUE8<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.103746        <span class="plumedtooltip">EXPINT8<span class="right">Add an experimental value for each q value<i></i></span></span>=0.143592E-01
<span class="plumedtooltip">QVALUE9<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.128888        <span class="plumedtooltip">EXPINT9<span class="right">Add an experimental value for each q value<i></i></span></span>=0.775681E-02
<span class="plumedtooltip">QVALUE10<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.153991       <span class="plumedtooltip">EXPINT10<span class="right">Add an experimental value for each q value<i></i></span></span>=0.564444E-02
<span class="plumedtooltip">QVALUE11<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.179113       <span class="plumedtooltip">EXPINT11<span class="right">Add an experimental value for each q value<i></i></span></span>=0.395988E-02
<span class="plumedtooltip">QVALUE12<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.20428        <span class="plumedtooltip">EXPINT12<span class="right">Add an experimental value for each q value<i></i></span></span>=0.324523E-02
<span class="plumedtooltip">QVALUE13<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.229423       <span class="plumedtooltip">EXPINT13<span class="right">Add an experimental value for each q value<i></i></span></span>=0.321736E-02
... SAXS
</span><span id="data/02.md_working_1.datdefSAXS_long" style="display:none;"><span class="plumedtooltip" style="color:green">SAXS<span class="right">Calculates SAXS intensity. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/02.md_working_1.datdefSAXS");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/SAXS">More details</a><i></i></span></span> ...
        <span class="plumedtooltip">LABEL<span class="right">a label for the action so that its output can be referenced in the input to other actions<i></i></span></span>=<b name="data/02.md_working_1.datSAXS" onclick='showPath("data/02.md_working_1.dat","data/02.md_working_1.datSAXS","data/02.md_working_1.datSAXS","black")'>SAXS</b>
        <span class="plumedtooltip">ATOMS<span class="right">The atoms to be included in the calculation, e<i></i></span></span>=1-11878
        <span class="plumedtooltip">ONEBEAD<span class="right"> calculate SAXS for a single bead model<i></i></span></span>
        <span class="plumedtooltip">TEMPLATE<span class="right"> A PDB file is required for ONEBEAD mapping<i></i></span></span>=template_AA.pdb
        <span style="color:blue" class="comment">#GPU            #This flag requires PLUMED to be compiled with Arrayfire</span>
        <span class="plumedtooltip">SOLVDENS<span class="right"> Density of the solvent to be used for the correction of atomistic form factors<i></i></span></span>=0.334
        <span class="plumedtooltip">SOLVATION_CORRECTION<span class="right"> Solvation layer electron density correction (ONEBEAD only)<i></i></span></span>=0.080
        <span class="plumedtooltip">SOLVATION_STRIDE<span class="right"> Number of steps between every new residues solvation estimation via LCPO (ONEBEAD only)<i></i></span></span>=10
        <span class="plumedtooltip">SASA_CUTOFF<span class="right"> SASA value to consider a residue as exposed to the solvent (ONEBEAD only)<i></i></span></span>=0.7
        <span class="plumedtooltip">SCALE_EXPINT<span class="right"> Scaling value for experimental data normalization<i></i></span></span>=0.281543E+00

<span class="plumedtooltip">QVALUE1<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.00444189      <span class="plumedtooltip">EXPINT1<span class="right">Add an experimental value for each q value<i></i></span></span>=0.279832E+00
<span class="plumedtooltip">QVALUE2<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0133257       <span class="plumedtooltip">EXPINT2<span class="right">Add an experimental value for each q value<i></i></span></span>=0.266507E+00
<span class="plumedtooltip">QVALUE3<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0222823       <span class="plumedtooltip">EXPINT3<span class="right">Add an experimental value for each q value<i></i></span></span>=0.241456E+00
<span class="plumedtooltip">QVALUE4<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0312965       <span class="plumedtooltip">EXPINT4<span class="right">Add an experimental value for each q value<i></i></span></span>=0.207871E+00
<span class="plumedtooltip">QVALUE5<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0402661       <span class="plumedtooltip">EXPINT5<span class="right">Add an experimental value for each q value<i></i></span></span>=0.170297E+00
<span class="plumedtooltip">QVALUE6<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0534267       <span class="plumedtooltip">EXPINT6<span class="right">Add an experimental value for each q value<i></i></span></span>=0.116142E+00
<span class="plumedtooltip">QVALUE7<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0786047       <span class="plumedtooltip">EXPINT7<span class="right">Add an experimental value for each q value<i></i></span></span>=0.427377E-01
<span class="plumedtooltip">QVALUE8<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.103746        <span class="plumedtooltip">EXPINT8<span class="right">Add an experimental value for each q value<i></i></span></span>=0.143592E-01
<span class="plumedtooltip">QVALUE9<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.128888        <span class="plumedtooltip">EXPINT9<span class="right">Add an experimental value for each q value<i></i></span></span>=0.775681E-02
<span class="plumedtooltip">QVALUE10<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.153991       <span class="plumedtooltip">EXPINT10<span class="right">Add an experimental value for each q value<i></i></span></span>=0.564444E-02
<span class="plumedtooltip">QVALUE11<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.179113       <span class="plumedtooltip">EXPINT11<span class="right">Add an experimental value for each q value<i></i></span></span>=0.395988E-02
<span class="plumedtooltip">QVALUE12<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.20428        <span class="plumedtooltip">EXPINT12<span class="right">Add an experimental value for each q value<i></i></span></span>=0.324523E-02
<span class="plumedtooltip">QVALUE13<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.229423       <span class="plumedtooltip">EXPINT13<span class="right">Add an experimental value for each q value<i></i></span></span>=0.321736E-02
 <span class="plumedtooltip">NOISETYPE<span class="right"> functional form of the noise (GAUSS,MGAUSS,OUTLIERS,MOUTLIERS,GENERIC)<i></i></span></span>=MGAUSS <span class="plumedtooltip">WRITE_STRIDE<span class="right"> write the status to a file every N steps, this can be used for restart/continuation<i></i></span></span>=10000 <span class="plumedtooltip">OPTSIGMAMEAN<span class="right"> Set to NONE/SEM to manually set sigma mean, or to estimate it on the fly<i></i></span></span>=NONE <span class="plumedtooltip">SIGMA0<span class="right"> initial value of the uncertainty parameter<i></i></span></span>=1.0 <span class="plumedtooltip">SIGMA_MIN<span class="right"> minimum value of the uncertainty parameter<i></i></span></span>=0.0 <span class="plumedtooltip">SIGMA_MAX<span class="right"> maximum value of the uncertainty parameter<i></i></span></span>=10. <span class="plumedtooltip">DEVICEID<span class="right"> Identifier of the GPU to be used<i></i></span></span>=-1 <span class="plumedtooltip">DEUTER_CONC<span class="right"> Fraction of deuterated solvent<i></i></span></span>=0. <span class="plumedtooltip">N<span class="right"> Number of points in the resolution function integral<i></i></span></span>=10
... SAXS
</span><br/><span style="color:blue" class="comment">#### INFO  ####</span>
<b name="data/02.md_working_1.datst_saxs" onclick='showPath("data/02.md_working_1.dat","data/02.md_working_1.datst_saxs","data/02.md_working_1.datst_saxs","black")'>st_saxs</b><span style="display:none;" id="data/02.md_working_1.datst_saxs">The STATS action with label <b>st_saxs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">st_saxs.sqdevsum</td><td width="5%"><font color="black">scalar</font></td><td>the sum of the squared deviations between arguments and parameters</td></tr><tr><td width="5%">st_saxs.corr</td><td width="5%"><font color="black">scalar</font></td><td>the correlation between arguments and parameters</td></tr><tr><td width="5%">st_saxs.slope</td><td width="5%"><font color="black">scalar</font></td><td>the slope of a linear fit between arguments and parameters</td></tr><tr><td width="5%">st_saxs.intercept</td><td width="5%"><font color="black">scalar</font></td><td>the intercept of a linear fit between arguments and parameters</td></tr></table></span>: <span class="plumedtooltip" style="color:green">STATS<span class="right">Calculates statistical properties of a set of collective variables with respect to a set of reference values. <a href="https://www.plumed.org/doc-master/user-doc/html/STATS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values from which the function is calculated<i></i></span></span>={(SAXS\.q-.*)} <span class="plumedtooltip">PARARG<span class="right">the input for this action is the scalar output from one or more other actions without derivatives<i></i></span></span>={(SAXS\.exp-.*)}
<b name="data/02.md_working_1.datrg_saxs" onclick='showPath("data/02.md_working_1.dat","data/02.md_working_1.datrg_saxs","data/02.md_working_1.datrg_saxs","black")'>rg_saxs</b><span style="display:none;" id="data/02.md_working_1.datrg_saxs">The GYRATION action with label <b>rg_saxs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rg_saxs</td><td width="5%"><font color="black">scalar</font></td><td>the radius of gyration</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GYRATION<span class="right">Calculate the radius of gyration, or other properties related to it. <a href="https://www.plumed.org/doc-master/user-doc/html/GYRATION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">TYPE<span class="right"> The type of calculation relative to the Gyration Tensor you want to perform<i></i></span></span>=RADIUS <span class="plumedtooltip">ATOMS<span class="right">the group of atoms that you are calculating the Gyration Tensor for<i></i></span></span>=1-11878

<span style="color:blue" class="comment">#### RESTRAINTS ####</span>
<span class="plumedtooltip" style="color:green">RESTRAINT<span class="right">Adds harmonic and/or linear restraints on one or more variables. <a href="https://www.plumed.org/doc-master/user-doc/html/RESTRAINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values the harmonic restraint acts upon<i></i></span></span>=<b name="data/02.md_working_1.datst_saxs">st_saxs.corr</b> <span class="plumedtooltip">AT<span class="right">the position of the restraint<i></i></span></span>=1 <span class="plumedtooltip">KAPPA<span class="right"> specifies that the restraint is harmonic and what the values of the force constants on each of the variables are<i></i></span></span>=0 <span class="plumedtooltip">SLOPE<span class="right"> specifies that the restraint is linear and what the values of the force constants on each of the variables are<i></i></span></span>=-10000

<span style="color:blue" class="comment">#### OUT ####</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/02.md_working_1.datrg_saxs">rg_saxs</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=100 <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=GYRATION
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>={st_saxs.*,(SAXS\.q-.*),(SAXS\.exp-.*)} <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=100 <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=STAT_SAXS
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>={(SAXS\.q-.*)} <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=100 <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=SAXSINT
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/02.md_working_1.datst_saxs">st_saxs.corr</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=100 <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=CORRELATION
</pre>
 {% endraw %} 

#### METAINFERENCE
Changing the coupling method does not affect the main SAXS/SANS actions, which remain unchanged. In this example we use metainference, a Bayesian replica-averaging framework that restrain the average predicted data, in this case the SAXS signal calculated from the system coordinates, to be close to the experimental observable, generating an ensemble in accordance to the maximum entropy principle. METAINFERENCE is part of the ISDB module, see the PLUMED manual and the [manuscript](https://doi.org/10.1126/sciadv.1501177) for full details.

Unlike the previous example, we do not use the SCALE_EXPINT flag because the EXPINT values have already been rescaled. In both the examples the maximum momentum transfer accepted for the ONEBEAD mapping is 0.3 Å<sup>-1</sup>.

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/02.md_working_2.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="02.md_working_2.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="02.md_working_2.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span class="plumedtooltip" style="color:green">MOLINFO<span class="right">This command is used to provide information on the molecules that are present in your system. <a href="https://www.plumed.org/doc-master/user-doc/html/MOLINFO" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">STRUCTURE<span class="right">a file in pdb format containing a reference structure<i></i></span></span>=template_AA.pdb

<span id="data/02.md_working_2.datdefsaxsdata_short"><span style="display:none;" id="data/02.md_working_2.dat">The MOLINFO action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">SAXS<span class="right">Calculates SAXS intensity. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/02.md_working_2.datdefsaxsdata");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/SAXS">More details</a><i></i></span></span> ...
        <span class="plumedtooltip">LABEL<span class="right">a label for the action so that its output can be referenced in the input to other actions<i></i></span></span>=<b name="data/02.md_working_2.datsaxsdata" onclick='showPath("data/02.md_working_2.dat","data/02.md_working_2.datsaxsdata","data/02.md_working_2.datsaxsdata","black")'>saxsdata</b><span style="display:none;" id="data/02.md_working_2.datsaxsdata">The SAXS action with label <b>saxsdata</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">saxsdata.q-0</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 0th of these quantities</td></tr><tr><td width="5%">saxsdata.q-1</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 1th of these quantities</td></tr><tr><td width="5%">saxsdata.q-2</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 2th of these quantities</td></tr><tr><td width="5%">saxsdata.q-3</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 3th of these quantities</td></tr><tr><td width="5%">saxsdata.q-4</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 4th of these quantities</td></tr><tr><td width="5%">saxsdata.q-5</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 5th of these quantities</td></tr><tr><td width="5%">saxsdata.q-6</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 6th of these quantities</td></tr><tr><td width="5%">saxsdata.q-7</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 7th of these quantities</td></tr><tr><td width="5%">saxsdata.q-8</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 8th of these quantities</td></tr><tr><td width="5%">saxsdata.q-9</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 9th of these quantities</td></tr><tr><td width="5%">saxsdata.q-10</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 10th of these quantities</td></tr><tr><td width="5%">saxsdata.q-11</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 11th of these quantities</td></tr><tr><td width="5%">saxsdata.q-12</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 12th of these quantities</td></tr><tr><td width="5%">saxsdata.q-13</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 13th of these quantities</td></tr><tr><td width="5%">saxsdata.q-14</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 14th of these quantities</td></tr><tr><td width="5%">saxsdata.q-15</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 15th of these quantities</td></tr><tr><td width="5%">saxsdata.q-16</td><td width="5%"><font color="black">scalar</font></td><td>The # SAXS of q  This is the 16th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-0</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 0th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-1</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 1th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-2</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 2th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-3</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 3th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-4</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 4th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-5</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 5th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-6</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 6th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-7</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 7th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-8</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 8th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-9</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 9th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-10</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 10th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-11</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 11th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-12</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 12th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-13</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 13th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-14</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 14th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-15</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 15th of these quantities</td></tr><tr><td width="5%">saxsdata.exp-16</td><td width="5%"><font color="black">scalar</font></td><td>The # experimental intensity  This is the 16th of these quantities</td></tr><tr><td width="5%">saxsdata.score</td><td width="5%"><font color="black">scalar</font></td><td>the Metainference score</td></tr><tr><td width="5%">saxsdata.neff</td><td width="5%"><font color="black">scalar</font></td><td>effective number of replicas</td></tr><tr><td width="5%">saxsdata.scale</td><td width="5%"><font color="black">scalar</font></td><td>scale parameter</td></tr><tr><td width="5%">saxsdata.acceptScale</td><td width="5%"><font color="black">scalar</font></td><td>MC acceptance for scale value</td></tr><tr><td width="5%">saxsdata.acceptSigma</td><td width="5%"><font color="black">scalar</font></td><td>MC acceptance for sigma values</td></tr><tr><td width="5%">saxsdata.sigmaMean-0</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 0th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-0</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 0th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-1</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 1th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-1</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 1th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-2</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 2th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-2</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 2th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-3</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 3th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-3</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 3th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-4</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 4th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-4</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 4th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-5</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 5th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-5</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 5th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-6</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 6th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-6</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 6th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-7</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 7th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-7</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 7th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-8</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 8th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-8</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 8th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-9</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 9th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-9</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 9th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-10</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 10th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-10</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 10th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-11</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 11th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-11</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 11th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-12</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 12th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-12</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 12th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-13</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 13th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-13</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 13th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-14</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 14th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-14</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 14th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-15</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 15th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-15</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 15th of these quantities</td></tr><tr><td width="5%">saxsdata.sigmaMean-16</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty in the mean estimate  This is the 16th of these quantities</td></tr><tr><td width="5%">saxsdata.sigma-16</td><td width="5%"><font color="black">scalar</font></td><td>uncertainty parameter  This is the 16th of these quantities</td></tr></table></span>
        <span class="plumedtooltip">ATOMS<span class="right">The atoms to be included in the calculation, e<i></i></span></span>=1-11878
        <span class="plumedtooltip">ONEBEAD<span class="right"> calculate SAXS for a single bead model<i></i></span></span>
        <span class="plumedtooltip">TEMPLATE<span class="right"> A PDB file is required for ONEBEAD mapping<i></i></span></span>=template_AA.pdb
        <span style="color:blue" class="comment">#GPU            #This flag requires PLUMED to be compiled with Arrayfire</span>
        <span class="plumedtooltip">SOLVDENS<span class="right"> Density of the solvent to be used for the correction of atomistic form factors<i></i></span></span>=0.334
        <span class="plumedtooltip">SOLVATION_CORRECTION<span class="right"> Solvation layer electron density correction (ONEBEAD only)<i></i></span></span>=0.080
        <span class="plumedtooltip">SOLVATION_STRIDE<span class="right"> Number of steps between every new residues solvation estimation via LCPO (ONEBEAD only)<i></i></span></span>=10
        <span class="plumedtooltip">SASA_CUTOFF<span class="right"> SASA value to consider a residue as exposed to the solvent (ONEBEAD only)<i></i></span></span>=0.7

        <span style="color:blue" class="comment">#QVALUE RANGE 0.01-0.25 (stride: 0.0150014)</span>

        <span class="plumedtooltip">QVALUE1<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0101007       <span class="plumedtooltip">EXPINT1<span class="right">Add an experimental value for each q value<i></i></span></span>=0.9655268182607186
        <span class="plumedtooltip">QVALUE2<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0251021       <span class="plumedtooltip">EXPINT2<span class="right">Add an experimental value for each q value<i></i></span></span>=0.8074336052768617
        <span class="plumedtooltip">QVALUE3<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0401035       <span class="plumedtooltip">EXPINT3<span class="right">Add an experimental value for each q value<i></i></span></span>=0.5867844124283979
        <span class="plumedtooltip">QVALUE4<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0551049       <span class="plumedtooltip">EXPINT4<span class="right">Add an experimental value for each q value<i></i></span></span>=0.3778068043742405
        <span class="plumedtooltip">QVALUE5<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0701063       <span class="plumedtooltip">EXPINT5<span class="right">Add an experimental value for each q value<i></i></span></span>=0.2199053983683388
        <span class="plumedtooltip">QVALUE6<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0851077       <span class="plumedtooltip">EXPINT6<span class="right">Add an experimental value for each q value<i></i></span></span>=0.1176236764450616
        <span class="plumedtooltip">QVALUE7<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1001091       <span class="plumedtooltip">EXPINT7<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0598961117861482
        <span class="plumedtooltip">QVALUE8<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1151105       <span class="plumedtooltip">EXPINT8<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0320698663426488
        <span class="plumedtooltip">QVALUE9<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1301119       <span class="plumedtooltip">EXPINT9<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0197961291442457
        <span class="plumedtooltip">QVALUE10<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1451133      <span class="plumedtooltip">EXPINT10<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0131910258635653
        <span class="plumedtooltip">QVALUE11<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1601147      <span class="plumedtooltip">EXPINT11<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0090075507724353
        <span class="plumedtooltip">QVALUE12<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1751161      <span class="plumedtooltip">EXPINT12<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0070054764797778
        <span class="plumedtooltip">QVALUE13<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1901175      <span class="plumedtooltip">EXPINT13<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0060413990626627
        <span class="plumedtooltip">QVALUE14<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.2051189      <span class="plumedtooltip">EXPINT14<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0049136955389689
        <span class="plumedtooltip">QVALUE15<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.2201203      <span class="plumedtooltip">EXPINT15<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0039878840479083
        <span class="plumedtooltip">QVALUE16<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.2351217      <span class="plumedtooltip">EXPINT16<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0037107186252386
        <span class="plumedtooltip">QVALUE17<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.2501231      <span class="plumedtooltip">EXPINT17<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0033106578718972

        <span class="plumedtooltip">OPTSIGMAMEAN<span class="right"> Set to NONE/SEM to manually set sigma mean, or to estimate it on the fly<i></i></span></span>=SEM_MAX
        <span class="plumedtooltip">SIGMA_MAX_STEPS<span class="right">Number of steps used to optimise SIGMA_MAX, before that the SIGMA_MAX value is used<i></i></span></span>=500000
        <span class="plumedtooltip">AVERAGING<span class="right">Stride for calculation of averaged weights and sigma_mean<i></i></span></span>=500
        <span class="plumedtooltip">DOSCORE<span class="right"> activate metainference<i></i></span></span> <span class="plumedtooltip">SIGMA_MEAN0<span class="right">starting value for the uncertainty in the mean estimate<i></i></span></span>=0.5
        <span class="plumedtooltip">SCALEDATA<span class="right"> Set to TRUE if you want to sample a scaling factor common to all values and replicas<i></i></span></span> <span class="plumedtooltip">SCALE0<span class="right"> initial value of the scaling factor<i></i></span></span>=1.0
        <span class="plumedtooltip">DSCALE<span class="right">maximum MC move of the scaling factor<i></i></span></span>=0.01 <span class="plumedtooltip">SCALE_PRIOR<span class="right"> either FLAT or GAUSSIAN<i></i></span></span>=GAUSSIAN
        <span class="plumedtooltip">SIGMA0<span class="right"> initial value of the uncertainty parameter<i></i></span></span>=0.5 <span class="plumedtooltip">SIGMA_MIN<span class="right"> minimum value of the uncertainty parameter<i></i></span></span>=0.0001 <span class="plumedtooltip">SIGMA_MAX<span class="right"> maximum value of the uncertainty parameter<i></i></span></span>=0.5
        <span class="plumedtooltip">NOISETYPE<span class="right"> functional form of the noise (GAUSS,MGAUSS,OUTLIERS,MOUTLIERS,GENERIC)<i></i></span></span>=MGAUSS
... SAXS
</span><span id="data/02.md_working_2.datdefsaxsdata_long" style="display:none;"><span class="plumedtooltip" style="color:green">SAXS<span class="right">Calculates SAXS intensity. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/02.md_working_2.datdefsaxsdata");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/SAXS">More details</a><i></i></span></span> ...
        <span class="plumedtooltip">LABEL<span class="right">a label for the action so that its output can be referenced in the input to other actions<i></i></span></span>=<b name="data/02.md_working_2.datsaxsdata" onclick='showPath("data/02.md_working_2.dat","data/02.md_working_2.datsaxsdata","data/02.md_working_2.datsaxsdata","black")'>saxsdata</b>
        <span class="plumedtooltip">ATOMS<span class="right">The atoms to be included in the calculation, e<i></i></span></span>=1-11878
        <span class="plumedtooltip">ONEBEAD<span class="right"> calculate SAXS for a single bead model<i></i></span></span>
        <span class="plumedtooltip">TEMPLATE<span class="right"> A PDB file is required for ONEBEAD mapping<i></i></span></span>=template_AA.pdb
        <span style="color:blue" class="comment">#GPU            #This flag requires PLUMED to be compiled with Arrayfire</span>
        <span class="plumedtooltip">SOLVDENS<span class="right"> Density of the solvent to be used for the correction of atomistic form factors<i></i></span></span>=0.334
        <span class="plumedtooltip">SOLVATION_CORRECTION<span class="right"> Solvation layer electron density correction (ONEBEAD only)<i></i></span></span>=0.080
        <span class="plumedtooltip">SOLVATION_STRIDE<span class="right"> Number of steps between every new residues solvation estimation via LCPO (ONEBEAD only)<i></i></span></span>=10
        <span class="plumedtooltip">SASA_CUTOFF<span class="right"> SASA value to consider a residue as exposed to the solvent (ONEBEAD only)<i></i></span></span>=0.7

        <span style="color:blue" class="comment">#QVALUE RANGE 0.01-0.25 (stride: 0.0150014)</span>

        <span class="plumedtooltip">QVALUE1<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0101007       <span class="plumedtooltip">EXPINT1<span class="right">Add an experimental value for each q value<i></i></span></span>=0.9655268182607186
        <span class="plumedtooltip">QVALUE2<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0251021       <span class="plumedtooltip">EXPINT2<span class="right">Add an experimental value for each q value<i></i></span></span>=0.8074336052768617
        <span class="plumedtooltip">QVALUE3<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0401035       <span class="plumedtooltip">EXPINT3<span class="right">Add an experimental value for each q value<i></i></span></span>=0.5867844124283979
        <span class="plumedtooltip">QVALUE4<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0551049       <span class="plumedtooltip">EXPINT4<span class="right">Add an experimental value for each q value<i></i></span></span>=0.3778068043742405
        <span class="plumedtooltip">QVALUE5<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0701063       <span class="plumedtooltip">EXPINT5<span class="right">Add an experimental value for each q value<i></i></span></span>=0.2199053983683388
        <span class="plumedtooltip">QVALUE6<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.0851077       <span class="plumedtooltip">EXPINT6<span class="right">Add an experimental value for each q value<i></i></span></span>=0.1176236764450616
        <span class="plumedtooltip">QVALUE7<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1001091       <span class="plumedtooltip">EXPINT7<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0598961117861482
        <span class="plumedtooltip">QVALUE8<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1151105       <span class="plumedtooltip">EXPINT8<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0320698663426488
        <span class="plumedtooltip">QVALUE9<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1301119       <span class="plumedtooltip">EXPINT9<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0197961291442457
        <span class="plumedtooltip">QVALUE10<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1451133      <span class="plumedtooltip">EXPINT10<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0131910258635653
        <span class="plumedtooltip">QVALUE11<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1601147      <span class="plumedtooltip">EXPINT11<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0090075507724353
        <span class="plumedtooltip">QVALUE12<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1751161      <span class="plumedtooltip">EXPINT12<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0070054764797778
        <span class="plumedtooltip">QVALUE13<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.1901175      <span class="plumedtooltip">EXPINT13<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0060413990626627
        <span class="plumedtooltip">QVALUE14<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.2051189      <span class="plumedtooltip">EXPINT14<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0049136955389689
        <span class="plumedtooltip">QVALUE15<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.2201203      <span class="plumedtooltip">EXPINT15<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0039878840479083
        <span class="plumedtooltip">QVALUE16<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.2351217      <span class="plumedtooltip">EXPINT16<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0037107186252386
        <span class="plumedtooltip">QVALUE17<span class="right">Selected scattering lengths in inverse angstroms are given as QVALUE1, QVALUE2, <i></i></span></span>=0.2501231      <span class="plumedtooltip">EXPINT17<span class="right">Add an experimental value for each q value<i></i></span></span>=0.0033106578718972

        <span class="plumedtooltip">OPTSIGMAMEAN<span class="right"> Set to NONE/SEM to manually set sigma mean, or to estimate it on the fly<i></i></span></span>=SEM_MAX
        <span class="plumedtooltip">SIGMA_MAX_STEPS<span class="right">Number of steps used to optimise SIGMA_MAX, before that the SIGMA_MAX value is used<i></i></span></span>=500000
        <span class="plumedtooltip">AVERAGING<span class="right">Stride for calculation of averaged weights and sigma_mean<i></i></span></span>=500
        <span class="plumedtooltip">DOSCORE<span class="right"> activate metainference<i></i></span></span> <span class="plumedtooltip">SIGMA_MEAN0<span class="right">starting value for the uncertainty in the mean estimate<i></i></span></span>=0.5
        <span class="plumedtooltip">SCALEDATA<span class="right"> Set to TRUE if you want to sample a scaling factor common to all values and replicas<i></i></span></span> <span class="plumedtooltip">SCALE0<span class="right"> initial value of the scaling factor<i></i></span></span>=1.0
        <span class="plumedtooltip">DSCALE<span class="right">maximum MC move of the scaling factor<i></i></span></span>=0.01 <span class="plumedtooltip">SCALE_PRIOR<span class="right"> either FLAT or GAUSSIAN<i></i></span></span>=GAUSSIAN
        <span class="plumedtooltip">SIGMA0<span class="right"> initial value of the uncertainty parameter<i></i></span></span>=0.5 <span class="plumedtooltip">SIGMA_MIN<span class="right"> minimum value of the uncertainty parameter<i></i></span></span>=0.0001 <span class="plumedtooltip">SIGMA_MAX<span class="right"> maximum value of the uncertainty parameter<i></i></span></span>=0.5
        <span class="plumedtooltip">NOISETYPE<span class="right"> functional form of the noise (GAUSS,MGAUSS,OUTLIERS,MOUTLIERS,GENERIC)<i></i></span></span>=MGAUSS
 <span class="plumedtooltip">WRITE_STRIDE<span class="right"> write the status to a file every N steps, this can be used for restart/continuation<i></i></span></span>=10000 <span class="plumedtooltip">DEVICEID<span class="right"> Identifier of the GPU to be used<i></i></span></span>=-1 <span class="plumedtooltip">SCALE_EXPINT<span class="right"> Scaling value for experimental data normalization<i></i></span></span>=1.0 <span class="plumedtooltip">DEUTER_CONC<span class="right"> Fraction of deuterated solvent<i></i></span></span>=0. <span class="plumedtooltip">N<span class="right"> Number of points in the resolution function integral<i></i></span></span>=10
... SAXS
</span><br/><span style="color:blue" class="comment">#### METAINFERENCE ####</span>
<b name="data/02.md_working_2.datsaxsbias" onclick='showPath("data/02.md_working_2.dat","data/02.md_working_2.datsaxsbias","data/02.md_working_2.datsaxsbias","black")'>saxsbias</b><span style="display:none;" id="data/02.md_working_2.datsaxsbias">The BIASVALUE action with label <b>saxsbias</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">saxsbias.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">saxsbias.saxsdata.score_bias</td><td width="5%"><font color="black">scalar</font></td><td>one or multiple instances of this quantity can be referenced elsewhere in the input file. these quantities will named with  the arguments of the bias followed by the character string _bias. These quantities tell the user how much the bias is due to each of the colvars. This particular component measures this quantity for the input CV named saxsdata.score</td></tr></table></span>: <span class="plumedtooltip" style="color:green">BIASVALUE<span class="right">Takes the value of one variable and use it as a bias <a href="https://www.plumed.org/doc-master/user-doc/html/BIASVALUE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the scalar/vector arguments whose values will be used as a bias on the system<i></i></span></span>={(saxsdata\.score)} <span class="plumedtooltip">STRIDE<span class="right">the frequency with which the forces due to the bias should be calculated<i></i></span></span>=2
<b name="data/02.md_working_2.datens" onclick='showPath("data/02.md_working_2.dat","data/02.md_working_2.datens","data/02.md_working_2.datens","black")'>ens</b><span style="display:none;" id="data/02.md_working_2.datens">The ENSEMBLE action with label <b>ens</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ens.saxsdata.q-0</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-0</td></tr><tr><td width="5%">ens.saxsdata.q-1</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-1</td></tr><tr><td width="5%">ens.saxsdata.q-2</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-2</td></tr><tr><td width="5%">ens.saxsdata.q-3</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-3</td></tr><tr><td width="5%">ens.saxsdata.q-4</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-4</td></tr><tr><td width="5%">ens.saxsdata.q-5</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-5</td></tr><tr><td width="5%">ens.saxsdata.q-6</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-6</td></tr><tr><td width="5%">ens.saxsdata.q-7</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-7</td></tr><tr><td width="5%">ens.saxsdata.q-8</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-8</td></tr><tr><td width="5%">ens.saxsdata.q-9</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-9</td></tr><tr><td width="5%">ens.saxsdata.q-10</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-10</td></tr><tr><td width="5%">ens.saxsdata.q-11</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-11</td></tr><tr><td width="5%">ens.saxsdata.q-12</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-12</td></tr><tr><td width="5%">ens.saxsdata.q-13</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-13</td></tr><tr><td width="5%">ens.saxsdata.q-14</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-14</td></tr><tr><td width="5%">ens.saxsdata.q-15</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-15</td></tr><tr><td width="5%">ens.saxsdata.q-16</td><td width="5%"><font color="black">scalar</font></td><td>the average for argument saxsdata.q-16</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ENSEMBLE<span class="right">Calculates the replica averaging of a collective variable over multiple replicas. <a href="https://www.plumed.org/doc-master/user-doc/html/ENSEMBLE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values from which the function is calculated<i></i></span></span>={(saxsdata\.q-.*)}
<br/><span style="color:blue" class="comment">#### STATISTICS ####</span>
<b name="data/02.md_working_2.datstatcg" onclick='showPath("data/02.md_working_2.dat","data/02.md_working_2.datstatcg","data/02.md_working_2.datstatcg","black")'>statcg</b><span style="display:none;" id="data/02.md_working_2.datstatcg">The STATS action with label <b>statcg</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">statcg.sqdevsum</td><td width="5%"><font color="black">scalar</font></td><td>the sum of the squared deviations between arguments and parameters</td></tr><tr><td width="5%">statcg.corr</td><td width="5%"><font color="black">scalar</font></td><td>the correlation between arguments and parameters</td></tr><tr><td width="5%">statcg.slope</td><td width="5%"><font color="black">scalar</font></td><td>the slope of a linear fit between arguments and parameters</td></tr><tr><td width="5%">statcg.intercept</td><td width="5%"><font color="black">scalar</font></td><td>the intercept of a linear fit between arguments and parameters</td></tr></table></span>: <span class="plumedtooltip" style="color:green">STATS<span class="right">Calculates statistical properties of a set of collective variables with respect to a set of reference values. <a href="https://www.plumed.org/doc-master/user-doc/html/STATS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values from which the function is calculated<i></i></span></span>={(ens.*)} <span class="plumedtooltip">PARARG<span class="right">the input for this action is the scalar output from one or more other actions without derivatives<i></i></span></span>={(saxsdata\.exp-.*)}
<br/><span style="color:blue" class="comment">#### PRINT ####</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>={(ens.*)} <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=1000 <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=ENS.SAXSINT
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>={(saxsdata\.score),(saxsdata\.scale),(saxsdata\.acceptSigma),(saxsdata\.sigma.*)} <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=1000 <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=BAYES.SAXS
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>={(saxsdata\.q-.*)} <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=1000 <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=SAXSINT
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/02.md_working_2.datstatcg">statcg.*</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=1000 <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=ST.SAXSCG
</pre>
 {% endraw %} 

##### [Back to hySAS home](NAVIGATION.md)
