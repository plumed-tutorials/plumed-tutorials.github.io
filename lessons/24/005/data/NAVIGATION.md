# Path integral metadynamics

Path integrals simulatins are able to describe the quantum thermodynamics
of distinguishable particles at finite temperature, and are the most accurate
approach to describe the behavior of light nuclei (e.g. hydrogen) at 
room temperature and above. 

They can be combined with metadynamics to accelerate the sampling of rare
events, and compute a "quantum free energies" that reflect (in an approximate
way) the effect of zero-point energy and tunneling on reaction rates. 

## Free-energy of the Zundel cation

This lecture provide a hands-on interactive tutorial (that you can also 
download and run locally) that uses the [i-PI code](http://ipi-code.org)
to perform path-integral simulations for the Zundel cation, a protonated
water dimer. PLUMED is used to compute appropriate collective variables,
using an input as follows

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/NAVIGATION.md_working_1.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="NAVIGATION.md_working_1.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="NAVIGATION.md_working_1.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># default units are LENGTH=nm ENERGY=kJ/mol TIME=ps</span>
<b name="data/NAVIGATION.md_working_1.datdoo" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datdoo","data/NAVIGATION.md_working_1.datdoo","black")'>doo</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datdoo">The DISTANCE action with label <b>doo</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">doo</td><td width="5%"><font color="black">scalar</font></td><td>the DISTANCE between this pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,2 
<span id="data/NAVIGATION.md_working_1.datco1_short"><b name="data/NAVIGATION.md_working_1.datco1" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datco1","data/NAVIGATION.md_working_1.datco1_shortcut","blue")'>co1</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datco1_shortcut">The DISTANCES action with label <b>co1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1</td><td width="5%"><font color="blue">vector</font></td><td>the DISTANCES between the each pair of atoms that were specified</td></tr><tr><td width="5%">co1_lessthan</td><td width="5%"><font color="black">scalar</font></td><td>the number of colvars that have a value less than a threshold</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCES<span class="right">Calculate the distances between multiple piars of atoms This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/NAVIGATION.md_working_1.datco1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCES">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">Calculate the distances between all the atoms in GROUPA and all the atoms in GROUPB<i></i></span></span>=1 <span class="plumedtooltip">GROUPB<span class="right">Calculate the distances between all the atoms in GROUPA and all the atoms in GROUPB<i></i></span></span>=3-7 <span class="plumedtooltip">LESS_THAN<span class="right">calculate the number of variables that are less than a certain target value. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL R_0=0.14}
</span><span id="data/NAVIGATION.md_working_1.datco1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/NAVIGATION.md_working_1.datco1")'># co1: DISTANCES GROUPA=1 GROUPB=3-7 LESS_THAN={RATIONAL R_0=0.14}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/NAVIGATION.md_working_1.datco1" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datco1","data/NAVIGATION.md_working_1.datco1","blue")'>co1</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datco1">The DISTANCE action with label <b>co1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1</td><td width="5%"><font color="blue">vector</font></td><td>the DISTANCE for each set of specified atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS1<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,3 <span class="plumedtooltip">ATOMS2<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,4 <span class="plumedtooltip">ATOMS3<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,5 <span class="plumedtooltip">ATOMS4<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,6 <span class="plumedtooltip">ATOMS5<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,7
<b name="data/NAVIGATION.md_working_1.datco1_lt" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datco1_lt","data/NAVIGATION.md_working_1.datco1_lt","blue")'>co1_lt</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datco1_lt">The LESS_THAN action with label <b>co1_lt</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1_lt</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a function that is one if the input is less than a threshold to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">LESS_THAN<span class="right">Use a switching function to determine how many of the input variables are less than a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/NAVIGATION.md_working_1.datco1">co1</b> <span class="plumedtooltip">SWITCH<span class="right">This keyword is used if you want to employ an alternative to the continuous swiching function defined above<i></i></span></span>={RATIONAL R_0=0.14}
<b name="data/NAVIGATION.md_working_1.datco1_lessthan" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datco1_lessthan","data/NAVIGATION.md_working_1.datco1_lessthan","black")'>co1_lessthan</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datco1_lessthan">The SUM action with label <b>co1_lessthan</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co1_lessthan</td><td width="5%"><font color="black">scalar</font></td><td>the SUM of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SUM<span class="right">Calculate the sum of the arguments <a href="https://www.plumed.org/doc-master/user-doc/html/SUM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/NAVIGATION.md_working_1.datco1_lt">co1_lt</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span id="data/NAVIGATION.md_working_1.datco2_short"><b name="data/NAVIGATION.md_working_1.datco2" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datco2","data/NAVIGATION.md_working_1.datco2_shortcut","blue")'>co2</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datco2_shortcut">The DISTANCES action with label <b>co2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2</td><td width="5%"><font color="blue">vector</font></td><td>the DISTANCES between the each pair of atoms that were specified</td></tr><tr><td width="5%">co2_lessthan</td><td width="5%"><font color="black">scalar</font></td><td>the number of colvars that have a value less than a threshold</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCES<span class="right">Calculate the distances between multiple piars of atoms This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/NAVIGATION.md_working_1.datco2");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCES">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">Calculate the distances between all the atoms in GROUPA and all the atoms in GROUPB<i></i></span></span>=2 <span class="plumedtooltip">GROUPB<span class="right">Calculate the distances between all the atoms in GROUPA and all the atoms in GROUPB<i></i></span></span>=3-7 <span class="plumedtooltip">LESS_THAN<span class="right">calculate the number of variables that are less than a certain target value. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL R_0=0.14}
</span><span id="data/NAVIGATION.md_working_1.datco2_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/NAVIGATION.md_working_1.datco2")'># co2: DISTANCES GROUPA=2 GROUPB=3-7 LESS_THAN={RATIONAL R_0=0.14}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/NAVIGATION.md_working_1.datco2" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datco2","data/NAVIGATION.md_working_1.datco2","blue")'>co2</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datco2">The DISTANCE action with label <b>co2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2</td><td width="5%"><font color="blue">vector</font></td><td>the DISTANCE for each set of specified atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS1<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=2,3 <span class="plumedtooltip">ATOMS2<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=2,4 <span class="plumedtooltip">ATOMS3<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=2,5 <span class="plumedtooltip">ATOMS4<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=2,6 <span class="plumedtooltip">ATOMS5<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=2,7
<b name="data/NAVIGATION.md_working_1.datco2_lt" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datco2_lt","data/NAVIGATION.md_working_1.datco2_lt","blue")'>co2_lt</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datco2_lt">The LESS_THAN action with label <b>co2_lt</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2_lt</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a function that is one if the input is less than a threshold to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">LESS_THAN<span class="right">Use a switching function to determine how many of the input variables are less than a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/NAVIGATION.md_working_1.datco2">co2</b> <span class="plumedtooltip">SWITCH<span class="right">This keyword is used if you want to employ an alternative to the continuous swiching function defined above<i></i></span></span>={RATIONAL R_0=0.14}
<b name="data/NAVIGATION.md_working_1.datco2_lessthan" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datco2_lessthan","data/NAVIGATION.md_working_1.datco2_lessthan","black")'>co2_lessthan</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datco2_lessthan">The SUM action with label <b>co2_lessthan</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">co2_lessthan</td><td width="5%"><font color="black">scalar</font></td><td>the SUM of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SUM<span class="right">Calculate the sum of the arguments <a href="https://www.plumed.org/doc-master/user-doc/html/SUM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/NAVIGATION.md_working_1.datco2_lt">co2_lt</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><b name="data/NAVIGATION.md_working_1.datdc" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datdc","data/NAVIGATION.md_working_1.datdc","black")'>dc</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datdc">The COMBINE action with label <b>dc</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">dc</td><td width="5%"><font color="black">scalar</font></td><td>a linear compbination</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/NAVIGATION.md_working_1.datco1">co1.lessthan</b>,<b name="data/NAVIGATION.md_working_1.datco2">co2.lessthan</b> <span class="plumedtooltip">COEFFICIENTS<span class="right"> the coefficients of the arguments in your function<i></i></span></span>=1,-1 <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/NAVIGATION.md_working_1.datmtd" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datmtd","data/NAVIGATION.md_working_1.datmtd","black")'>mtd</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datmtd">The METAD action with label <b>mtd</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">mtd.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr></table></span>:   <span class="plumedtooltip" style="color:green">METAD<span class="right">Used to performed metadynamics on one or more collective variables. <a href="https://www.plumed.org/doc-master/user-doc/html/METAD" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the scalars on which the bias will act<i></i></span></span>=<b name="data/NAVIGATION.md_working_1.datdoo">doo</b>,<b name="data/NAVIGATION.md_working_1.datdc">dc</b> <span class="plumedtooltip">PACE<span class="right">the frequency for hill addition<i></i></span></span>=10 <span class="plumedtooltip">SIGMA<span class="right">the widths of the Gaussian hills<i></i></span></span>=0.005,0.05 <span class="plumedtooltip">HEIGHT<span class="right">the heights of the Gaussian hills<i></i></span></span>=4 <span class="plumedtooltip">FILE<span class="right"> a file in which the list of added hills is stored<i></i></span></span>=HILLS-pimd <span class="plumedtooltip">BIASFACTOR<span class="right">use well tempered metadynamics and use this bias factor<i></i></span></span>=10 <span class="plumedtooltip">TEMP<span class="right">the system temperature - this is only needed if you are doing well-tempered metadynamics<i></i></span></span>=300
<b name="data/NAVIGATION.md_working_1.datuwall" onclick='showPath("data/NAVIGATION.md_working_1.dat","data/NAVIGATION.md_working_1.datuwall","data/NAVIGATION.md_working_1.datuwall","black")'>uwall</b><span style="display:none;" id="data/NAVIGATION.md_working_1.datuwall">The UPPER_WALLS action with label <b>uwall</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">uwall.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">uwall.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <span class="plumedtooltip" style="color:green">UPPER_WALLS<span class="right">Defines a wall for the value of one or more collective variables, <a href="https://www.plumed.org/doc-master/user-doc/html/UPPER_WALLS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the arguments on which the bias is acting<i></i></span></span>=<b name="data/NAVIGATION.md_working_1.datdoo">doo</b> <span class="plumedtooltip">AT<span class="right">the positions of the wall<i></i></span></span>=0.4 <span class="plumedtooltip">KAPPA<span class="right">the force constant for the wall<i></i></span></span>=250

<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/NAVIGATION.md_working_1.datdoo">doo</b>,<b name="data/NAVIGATION.md_working_1.datco1">co1.*</b>,<b name="data/NAVIGATION.md_working_1.datco2">co2.*</b>,<b name="data/NAVIGATION.md_working_1.datdc">dc</b>,<b name="data/NAVIGATION.md_working_1.datmtd">mtd.*</b>,<b name="data/NAVIGATION.md_working_1.datuwall">uwall.*</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=10 <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=COLVAR-pimd
<span style="display:none;" id="data/NAVIGATION.md_working_1.dat">The PRINT action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FLUSH<span class="right">This command instructs plumed to flush all the open files with a user specified frequency. <a href="https://www.plumed.org/doc-master/user-doc/html/FLUSH" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">STRIDE<span class="right">the frequency with which all the open files should be flushed<i></i></span></span>=1
</pre>
 {% endraw %} 

Depending on your previous experience, you may want to follow the 
lessons on metadynamics, and the external tutorial on path integral
simulations.


```mermaid
flowchart LR
A[Basic plumed syntax] ==> B[Metadynamics]
B ==> D[Path integral metadynamics]
C[Introduction to path integrals] ==> D
click A "../../../21/001/data/NAVIGATION.html" "Follow this lecture for an introduction to PLUMED and enhanced sampling"
click B "../../../21/004/data/NAVIGATION.html" "Follow this lecture if you have never heard of metadynamics before"
click C "https://atomistic-cookbook.org/examples/path-integrals/path-integrals.html" "An interactive tutorial on path integral simulations and how to perform them using i-PI"
click D "https://atomistic-cookbook.org/examples/pi-metad/pi-metad.html" "The main tutorial: combine i-PI and PLUMED to compute free energies including quantum nuclear effects"
```

{% raw %}
<b><a href="https://www.plumed.org/doc-master/user-doc/html/actionlist/?actions=METAD,PRINT,DISTANCES,DISTANCE,SUM,LESS_THAN,COMBINE,UPPER_WALLS,FLUSH" target="_blank">Click here</a> to open manual pages for actions discussed in this tutorial.</b>
{% endraw %}
