# Input files preparation

In the zip file available in the [GitHub repository](https://github.com/compsb-unimi/VMetaD-tutorial) you will find all the initial files needed to run this tutorial.

## Preliminary molecular dynamics run
As a first step for the VMetaD run, we have to choose the atoms which will constitute the reference frame on which we will calculate the position of the ligand with respect to the protein. To be sure in choosing residues that remain stable (i.e. do not belong to a moving loop), we run a 100 ns-long plain molecular dynamics (MD) simulation at 300 K (that is the temperature at which we will run and analyze all the simulations in this tutorial). This run took 2 h on 4 CPUs of a M1 Max MacBook Pro).

After the simulation, we calculate the per-residue root mean square fluctuations (RMSF), which highlights the more dynamic residues.

<p align="center">
  <img src="https://github.com/riccardocapelli/VMetaD-tutorial/blob/main/img/rmsf.jpg?raw=true" alt="Alt text" width="50%">
  <br>
  <em>Per-residue root mean square fluctuation (RMSF) computed from a plain MD simulation of lysozyme-benzene complex. The portion of the plot with light blue background represents the C-terminal domain, where the benzene binds.</em>
</p>

We can see that almost all the C-terminal domain (residues 71-162) does not show large fluctuations, and only few residues are above the (arbitrary) RMSF threshold of 0.15 nm. We thus consider to define the reference frame considering all the residues 71-162 but the five ones with RMSF > 0.15 nm (residues 135, 136, 137, 140, and 141).

## PDB file for reference frame refitting
To be sure to keep the structure stable during the simulation, we will define the reference frame of VMetaD on the residues selected for the fit. To have a reference structure to be used in PLUMED (see the next section for the input file), we convert the initial structure to the PDB format using `gmx editconf` (to ensure consistency with the numbering) and keeping only the C-alphas:
```
gmx editconf -f starting.gro -o ref_ca.pdb
grep "CA" ref_ca.pdb > tmpfile && mv tmpfile ref_ca.pdb
```
Remember to add the correct values to the b-factor columns (and/or removing unwanted atoms for the fitting procedure) telling PLUMED which are the atoms we want to use for the fitting procedure (see the `ref_ca.pdb` file in the folder for reference).

## Choice of the restraining potential size

We now need to choose the size of the restraint potential. In the [original paper](https://doi.org/10.1021/acs.jpclett.9b01183) we showed that the reliability of the estimates is not affected by the size of the potential. However, we have to keep in mind that we need a part of the box where the ligand can stay far away from the protein in order to represent the unbound state in a satisfactory way. An important point here is that the sphere constraint __must__ be inside the box, otherwise the entropic correction will not accurately account for the loss of configurational space. To visually inspect how large the potential is, and to get a feel for the possible movements of the ligand, we can visualize both the system and the restraint with VMD (downloadable [here](https://www.ks.uiuc.edu/Research/vmd/)).

We can open VMD and load the `starting.gro` structure file in the GitHub folder. After the structure is loaded and the visualization has been set up at your taste, you can open the Tk console and write
```
pbc box
```
which draws the cubic box in which the system is inserted. 

Now we can generate the atom selection we defined after checking the RMSF:
```
set sel [atomselect top "resid 71 to 134 or resid 138 to 139 or resid 142 to 162"]
```
The console should answer
```
atomselectXX
```
Where `XX` is a number. The selection for the reference frame has been defined and named `$sel`. Now we can compute the position of the center of mass of this set of atoms:
```
measure center $sel weight mass
```
The console should answer with the position of the center of mass (in Ångstrom)
```
35.28876876831055 34.06196594238281 32.041622161865234
```
Knowing this information, we can draw the sphere with a radius of (for example) 2 nm  (20 Å) with the following command
```
draw sphere {35.28876876831055 34.06196594238281 32.041622161865234} radius 20 resolution 100
```
Receiving a number as an answer from the console. Such number is the ID of the 3D object we just draw. The drawn sphere is opaque, not allowing us to see inside it; to make it transparent, we need to specify that we want a transparent material
```
draw material Transparent
```
We can see that the sphere contains the entire domain, but it is probably too small to represent the unbound state in a precise way. Let's delete the sphere using the ID of the 3D object (let's say that it is `14`), and plot a new sphere of radius 2.8 nm
```
draw delete 14
draw sphere {35.28876876831055 34.06196594238281 32.041622161865234} radius 28 resolution 100
```

You can see the expected result below
<p align="center">
  <img src="https://github.com/riccardocapelli/VMetaD-tutorial/blob/main/img/sphere_box.jpg?raw=true" alt="Alt text" width="50%">
  <br>
  <em>Cartoon representation of the lysozyme-benzene complex, including the restraining potential applied within a 2.8 nm radius of the reference frame center of mass. The boundaries of the simulation box are also highlighted to show that the sphere is entirely contained by the box. </em>
</p>

## The PLUMED input file
_(You can read the following line-by-line description keeping an eye on the `plumed.dat` file in the GitHub folder as a reference)_

### Reference frame setup
We start with the `WHOLEMOLECULES` instruction, to be sure that lysozyme (`ENTITY0`) will not be broken by the periodic boundary condition, as well as the benzene molecule (`ENTITY1`):
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_1.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_1.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_1.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290
</pre>
 {% endraw %} 
Now that we are sure of the integrity of the structures in PLUMED, we perform the rototranslational fit of the system to make sure that the protein will be in the fixed reference frame position:
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_2.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_2.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_2.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_2.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_2.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_2.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290
<a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_2.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><span style="display:none;" id="data/input.md_working_2.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL
</pre>
 {% endraw %} 

We then start with the groups definition. We previously prepared a GROMACS index file (`index.ndx`) with all the groups named as intended. As an alternative, you can also define such groups with atom ids.
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_3.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_3.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_3.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_3.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_3.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_3.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290

<span style="display:none;" id="data/input.md_working_3.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL
<a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_3.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><b name="data/input.md_working_3.datprot_noh" onclick='showPath("data/input.md_working_3.dat","data/input.md_working_3.datprot_noh","data/input.md_working_3.datprot_noh","violet")'>prot_noh</b><span style="display:none;" id="data/input.md_working_3.datprot_noh">The GROUP action with label <b>prot_noh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prot_noh</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=Protein-H
<b name="data/input.md_working_3.datsph" onclick='showPath("data/input.md_working_3.dat","data/input.md_working_3.datsph","data/input.md_working_3.datsph","violet")'>sph</b><span style="display:none;" id="data/input.md_working_3.datsph">The GROUP action with label <b>sph</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=sphere
<b name="data/input.md_working_3.datlig" onclick='showPath("data/input.md_working_3.dat","data/input.md_working_3.datlig","data/input.md_working_3.datlig","violet")'>lig</b><span style="display:none;" id="data/input.md_working_3.datlig">The GROUP action with label <b>lig</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=ligand
</pre>
 {% endraw %} 
We have three groups: 
* `prot_noh`, which contains all the non-hydrogen atoms of the protein (for our multi-eGO potential is equivalent to all the protein, but in all-atom representation it makes a difference);
* `sph`, which contains the atoms that define the reference frame (the C-alpha of the selected residues -see above-);
* `lig`, which contains the atoms of the ligand.

After the definition of the groups, to avoid that the passage in a periodic boundary conditions causes a "jump" of the ligand with respect to the protein, we add a `WRAPAROUND` instruction:
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_4.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_4.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_4.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_4.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_4.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_4.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290

<span style="display:none;" id="data/input.md_working_4.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL

<b name="data/input.md_working_4.datprot_noh" onclick='showPath("data/input.md_working_4.dat","data/input.md_working_4.datprot_noh","data/input.md_working_4.datprot_noh","violet")'>prot_noh</b><span style="display:none;" id="data/input.md_working_4.datprot_noh">The GROUP action with label <b>prot_noh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prot_noh</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=Protein-H
<b name="data/input.md_working_4.datsph" onclick='showPath("data/input.md_working_4.dat","data/input.md_working_4.datsph","data/input.md_working_4.datsph","violet")'>sph</b><span style="display:none;" id="data/input.md_working_4.datsph">The GROUP action with label <b>sph</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=sphere
<b name="data/input.md_working_4.datlig" onclick='showPath("data/input.md_working_4.dat","data/input.md_working_4.datlig","data/input.md_working_4.datlig","violet")'>lig</b><span style="display:none;" id="data/input.md_working_4.datlig">The GROUP action with label <b>lig</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=ligand
<a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_4.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><span class="plumedtooltip" style="color:green">WRAPAROUND<span class="right">Rebuild periodic boundary conditions around chosen atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/WRAPAROUND" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">wrapped atoms<i></i></span></span>=<b name="data/input.md_working_4.datlig">lig</b> <span class="plumedtooltip">AROUND<span class="right">reference atoms<i></i></span></span>=<b name="data/input.md_working_4.datsph">sph</b>
</pre>
 {% endraw %} 
Ending the fitting part of the PLUMED input.

### Spherical coordinates definition
We now compute the position of the center of mass of the atoms defining the reference frame ($(x,y,z)=(0,0,0)$ in our CV space), and the center of mass of the ligand:
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_5.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_5.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_5.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_5.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_5.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_5.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290

<span style="display:none;" id="data/input.md_working_5.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL

<b name="data/input.md_working_5.datprot_noh" onclick='showPath("data/input.md_working_5.dat","data/input.md_working_5.datprot_noh","data/input.md_working_5.datprot_noh","violet")'>prot_noh</b><span style="display:none;" id="data/input.md_working_5.datprot_noh">The GROUP action with label <b>prot_noh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prot_noh</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=Protein-H
<b name="data/input.md_working_5.datsph" onclick='showPath("data/input.md_working_5.dat","data/input.md_working_5.datsph","data/input.md_working_5.datsph","violet")'>sph</b><span style="display:none;" id="data/input.md_working_5.datsph">The GROUP action with label <b>sph</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=sphere
<b name="data/input.md_working_5.datlig" onclick='showPath("data/input.md_working_5.dat","data/input.md_working_5.datlig","data/input.md_working_5.datlig","violet")'>lig</b><span style="display:none;" id="data/input.md_working_5.datlig">The GROUP action with label <b>lig</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=ligand

<span class="plumedtooltip" style="color:green">WRAPAROUND<span class="right">Rebuild periodic boundary conditions around chosen atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/WRAPAROUND" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">wrapped atoms<i></i></span></span>=<b name="data/input.md_working_5.datlig">lig</b> <span class="plumedtooltip">AROUND<span class="right">reference atoms<i></i></span></span>=<b name="data/input.md_working_5.datsph">sph</b>
<a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_5.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><b name="data/input.md_working_5.datsph_center" onclick='showPath("data/input.md_working_5.dat","data/input.md_working_5.datsph_center","data/input.md_working_5.datsph_center","violet")'>sph_center</b><span style="display:none;" id="data/input.md_working_5.datsph_center">The COM action with label <b>sph_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_5.datsph">sph</b>
<b name="data/input.md_working_5.datlig_center" onclick='showPath("data/input.md_working_5.dat","data/input.md_working_5.datlig_center","data/input.md_working_5.datlig_center","violet")'>lig_center</b><span style="display:none;" id="data/input.md_working_5.datlig_center">The COM action with label <b>lig_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_5.datlig">lig</b>

<b name="data/input.md_working_5.datsph_coord" onclick='showPath("data/input.md_working_5.dat","data/input.md_working_5.datsph_coord","data/input.md_working_5.datsph_coord","black")'>sph_coord</b><span style="display:none;" id="data/input.md_working_5.datsph_coord">The POSITION action with label <b>sph_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">sph_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">sph_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_5.datsph_center">sph_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<b name="data/input.md_working_5.datlig_coord" onclick='showPath("data/input.md_working_5.dat","data/input.md_working_5.datlig_coord","data/input.md_working_5.datlig_coord","black")'>lig_coord</b><span style="display:none;" id="data/input.md_working_5.datlig_coord">The POSITION action with label <b>lig_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">lig_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">lig_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_5.datlig_center">lig_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
</pre>
 {% endraw %} 
From the position, we can obtain the cartesian coordinates of the ligand in this reference frame
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_6.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_6.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_6.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_6.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_6.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_6.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290

<span style="display:none;" id="data/input.md_working_6.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL

<b name="data/input.md_working_6.datprot_noh" onclick='showPath("data/input.md_working_6.dat","data/input.md_working_6.datprot_noh","data/input.md_working_6.datprot_noh","violet")'>prot_noh</b><span style="display:none;" id="data/input.md_working_6.datprot_noh">The GROUP action with label <b>prot_noh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prot_noh</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=Protein-H
<b name="data/input.md_working_6.datsph" onclick='showPath("data/input.md_working_6.dat","data/input.md_working_6.datsph","data/input.md_working_6.datsph","violet")'>sph</b><span style="display:none;" id="data/input.md_working_6.datsph">The GROUP action with label <b>sph</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=sphere
<b name="data/input.md_working_6.datlig" onclick='showPath("data/input.md_working_6.dat","data/input.md_working_6.datlig","data/input.md_working_6.datlig","violet")'>lig</b><span style="display:none;" id="data/input.md_working_6.datlig">The GROUP action with label <b>lig</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=ligand

<span class="plumedtooltip" style="color:green">WRAPAROUND<span class="right">Rebuild periodic boundary conditions around chosen atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/WRAPAROUND" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">wrapped atoms<i></i></span></span>=<b name="data/input.md_working_6.datlig">lig</b> <span class="plumedtooltip">AROUND<span class="right">reference atoms<i></i></span></span>=<b name="data/input.md_working_6.datsph">sph</b>

<b name="data/input.md_working_6.datsph_center" onclick='showPath("data/input.md_working_6.dat","data/input.md_working_6.datsph_center","data/input.md_working_6.datsph_center","violet")'>sph_center</b><span style="display:none;" id="data/input.md_working_6.datsph_center">The COM action with label <b>sph_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_6.datsph">sph</b>
<b name="data/input.md_working_6.datlig_center" onclick='showPath("data/input.md_working_6.dat","data/input.md_working_6.datlig_center","data/input.md_working_6.datlig_center","violet")'>lig_center</b><span style="display:none;" id="data/input.md_working_6.datlig_center">The COM action with label <b>lig_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_6.datlig">lig</b>

<b name="data/input.md_working_6.datsph_coord" onclick='showPath("data/input.md_working_6.dat","data/input.md_working_6.datsph_coord","data/input.md_working_6.datsph_coord","black")'>sph_coord</b><span style="display:none;" id="data/input.md_working_6.datsph_coord">The POSITION action with label <b>sph_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">sph_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">sph_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_6.datsph_center">sph_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<b name="data/input.md_working_6.datlig_coord" onclick='showPath("data/input.md_working_6.dat","data/input.md_working_6.datlig_coord","data/input.md_working_6.datlig_coord","black")'>lig_coord</b><span style="display:none;" id="data/input.md_working_6.datlig_coord">The POSITION action with label <b>lig_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">lig_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">lig_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_6.datlig_center">lig_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_6.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><b name="data/input.md_working_6.databs_x" onclick='showPath("data/input.md_working_6.dat","data/input.md_working_6.databs_x","data/input.md_working_6.databs_x","black")'>abs_x</b><span style="display:none;" id="data/input.md_working_6.databs_x">The MATHEVAL action with label <b>abs_x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_x</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_6.datlig_coord">lig_coord.x</b>,<b name="data/input.md_working_6.datsph_coord">sph_coord.x</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_6.databs_y" onclick='showPath("data/input.md_working_6.dat","data/input.md_working_6.databs_y","data/input.md_working_6.databs_y","black")'>abs_y</b><span style="display:none;" id="data/input.md_working_6.databs_y">The MATHEVAL action with label <b>abs_y</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_y</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_6.datlig_coord">lig_coord.y</b>,<b name="data/input.md_working_6.datsph_coord">sph_coord.y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_6.databs_z" onclick='showPath("data/input.md_working_6.dat","data/input.md_working_6.databs_z","data/input.md_working_6.databs_z","black")'>abs_z</b><span style="display:none;" id="data/input.md_working_6.databs_z">The MATHEVAL action with label <b>abs_z</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_z</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_6.datlig_coord">lig_coord.z</b>,<b name="data/input.md_working_6.datsph_coord">sph_coord.z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
</pre>
 {% endraw %} 
and via the usual transformation, obtain the final spherical coordinates $(\rho,\theta,\varphi)$
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_7.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_7.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_7.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_7.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_7.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_7.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290

<span style="display:none;" id="data/input.md_working_7.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL

<b name="data/input.md_working_7.datprot_noh" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.datprot_noh","data/input.md_working_7.datprot_noh","violet")'>prot_noh</b><span style="display:none;" id="data/input.md_working_7.datprot_noh">The GROUP action with label <b>prot_noh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prot_noh</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=Protein-H
<b name="data/input.md_working_7.datsph" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.datsph","data/input.md_working_7.datsph","violet")'>sph</b><span style="display:none;" id="data/input.md_working_7.datsph">The GROUP action with label <b>sph</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=sphere
<b name="data/input.md_working_7.datlig" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.datlig","data/input.md_working_7.datlig","violet")'>lig</b><span style="display:none;" id="data/input.md_working_7.datlig">The GROUP action with label <b>lig</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=ligand

<span class="plumedtooltip" style="color:green">WRAPAROUND<span class="right">Rebuild periodic boundary conditions around chosen atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/WRAPAROUND" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">wrapped atoms<i></i></span></span>=<b name="data/input.md_working_7.datlig">lig</b> <span class="plumedtooltip">AROUND<span class="right">reference atoms<i></i></span></span>=<b name="data/input.md_working_7.datsph">sph</b>

<b name="data/input.md_working_7.datsph_center" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.datsph_center","data/input.md_working_7.datsph_center","violet")'>sph_center</b><span style="display:none;" id="data/input.md_working_7.datsph_center">The COM action with label <b>sph_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_7.datsph">sph</b>
<b name="data/input.md_working_7.datlig_center" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.datlig_center","data/input.md_working_7.datlig_center","violet")'>lig_center</b><span style="display:none;" id="data/input.md_working_7.datlig_center">The COM action with label <b>lig_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_7.datlig">lig</b>

<b name="data/input.md_working_7.datsph_coord" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.datsph_coord","data/input.md_working_7.datsph_coord","black")'>sph_coord</b><span style="display:none;" id="data/input.md_working_7.datsph_coord">The POSITION action with label <b>sph_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">sph_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">sph_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_7.datsph_center">sph_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<b name="data/input.md_working_7.datlig_coord" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.datlig_coord","data/input.md_working_7.datlig_coord","black")'>lig_coord</b><span style="display:none;" id="data/input.md_working_7.datlig_coord">The POSITION action with label <b>lig_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">lig_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">lig_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_7.datlig_center">lig_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<br/><b name="data/input.md_working_7.databs_x" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.databs_x","data/input.md_working_7.databs_x","black")'>abs_x</b><span style="display:none;" id="data/input.md_working_7.databs_x">The MATHEVAL action with label <b>abs_x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_x</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_7.datlig_coord">lig_coord.x</b>,<b name="data/input.md_working_7.datsph_coord">sph_coord.x</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_7.databs_y" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.databs_y","data/input.md_working_7.databs_y","black")'>abs_y</b><span style="display:none;" id="data/input.md_working_7.databs_y">The MATHEVAL action with label <b>abs_y</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_y</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_7.datlig_coord">lig_coord.y</b>,<b name="data/input.md_working_7.datsph_coord">sph_coord.y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_7.databs_z" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.databs_z","data/input.md_working_7.databs_z","black")'>abs_z</b><span style="display:none;" id="data/input.md_working_7.databs_z">The MATHEVAL action with label <b>abs_z</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_z</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_7.datlig_coord">lig_coord.z</b>,<b name="data/input.md_working_7.datsph_coord">sph_coord.z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_7.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><b name="data/input.md_working_7.datrho" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.datrho","data/input.md_working_7.datrho","black")'>rho</b><span style="display:none;" id="data/input.md_working_7.datrho">The MATHEVAL action with label <b>rho</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rho</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_7.databs_x">abs_x</b>,<b name="data/input.md_working_7.databs_y">abs_y</b>,<b name="data/input.md_working_7.databs_z">abs_z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x*x+y*y+z*z) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_7.dattheta" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.dattheta","data/input.md_working_7.dattheta","black")'>theta</b><span style="display:none;" id="data/input.md_working_7.dattheta">The MATHEVAL action with label <b>theta</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">theta</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_7.databs_z">abs_z</b>,<b name="data/input.md_working_7.datrho">rho</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=acos(x/y) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=0.,pi
<b name="data/input.md_working_7.datphi" onclick='showPath("data/input.md_working_7.dat","data/input.md_working_7.datphi","data/input.md_working_7.datphi","black")'>phi</b><span style="display:none;" id="data/input.md_working_7.datphi">The MATHEVAL action with label <b>phi</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">phi</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_7.databs_x">abs_x</b>,<b name="data/input.md_working_7.databs_y">abs_y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=atan2(y,x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=-pi,pi
</pre>
 {% endraw %} 
which will be our CVs.

### Restraining
We now have to impose the spherical restraint. We put a `UPPER_WALLS` which impedes the ligand to go farther than 2.8 nm:
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_8.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_8.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_8.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_8.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_8.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_8.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290

<span style="display:none;" id="data/input.md_working_8.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL

<b name="data/input.md_working_8.datprot_noh" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.datprot_noh","data/input.md_working_8.datprot_noh","violet")'>prot_noh</b><span style="display:none;" id="data/input.md_working_8.datprot_noh">The GROUP action with label <b>prot_noh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prot_noh</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=Protein-H
<b name="data/input.md_working_8.datsph" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.datsph","data/input.md_working_8.datsph","violet")'>sph</b><span style="display:none;" id="data/input.md_working_8.datsph">The GROUP action with label <b>sph</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=sphere
<b name="data/input.md_working_8.datlig" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.datlig","data/input.md_working_8.datlig","violet")'>lig</b><span style="display:none;" id="data/input.md_working_8.datlig">The GROUP action with label <b>lig</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=ligand

<span class="plumedtooltip" style="color:green">WRAPAROUND<span class="right">Rebuild periodic boundary conditions around chosen atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/WRAPAROUND" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">wrapped atoms<i></i></span></span>=<b name="data/input.md_working_8.datlig">lig</b> <span class="plumedtooltip">AROUND<span class="right">reference atoms<i></i></span></span>=<b name="data/input.md_working_8.datsph">sph</b>

<b name="data/input.md_working_8.datsph_center" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.datsph_center","data/input.md_working_8.datsph_center","violet")'>sph_center</b><span style="display:none;" id="data/input.md_working_8.datsph_center">The COM action with label <b>sph_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_8.datsph">sph</b>
<b name="data/input.md_working_8.datlig_center" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.datlig_center","data/input.md_working_8.datlig_center","violet")'>lig_center</b><span style="display:none;" id="data/input.md_working_8.datlig_center">The COM action with label <b>lig_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_8.datlig">lig</b>

<b name="data/input.md_working_8.datsph_coord" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.datsph_coord","data/input.md_working_8.datsph_coord","black")'>sph_coord</b><span style="display:none;" id="data/input.md_working_8.datsph_coord">The POSITION action with label <b>sph_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">sph_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">sph_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_8.datsph_center">sph_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<b name="data/input.md_working_8.datlig_coord" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.datlig_coord","data/input.md_working_8.datlig_coord","black")'>lig_coord</b><span style="display:none;" id="data/input.md_working_8.datlig_coord">The POSITION action with label <b>lig_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">lig_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">lig_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_8.datlig_center">lig_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<br/><b name="data/input.md_working_8.databs_x" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.databs_x","data/input.md_working_8.databs_x","black")'>abs_x</b><span style="display:none;" id="data/input.md_working_8.databs_x">The MATHEVAL action with label <b>abs_x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_x</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_8.datlig_coord">lig_coord.x</b>,<b name="data/input.md_working_8.datsph_coord">sph_coord.x</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_8.databs_y" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.databs_y","data/input.md_working_8.databs_y","black")'>abs_y</b><span style="display:none;" id="data/input.md_working_8.databs_y">The MATHEVAL action with label <b>abs_y</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_y</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_8.datlig_coord">lig_coord.y</b>,<b name="data/input.md_working_8.datsph_coord">sph_coord.y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_8.databs_z" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.databs_z","data/input.md_working_8.databs_z","black")'>abs_z</b><span style="display:none;" id="data/input.md_working_8.databs_z">The MATHEVAL action with label <b>abs_z</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_z</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_8.datlig_coord">lig_coord.z</b>,<b name="data/input.md_working_8.datsph_coord">sph_coord.z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO

<b name="data/input.md_working_8.datrho" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.datrho","data/input.md_working_8.datrho","black")'>rho</b><span style="display:none;" id="data/input.md_working_8.datrho">The MATHEVAL action with label <b>rho</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rho</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_8.databs_x">abs_x</b>,<b name="data/input.md_working_8.databs_y">abs_y</b>,<b name="data/input.md_working_8.databs_z">abs_z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x*x+y*y+z*z) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_8.dattheta" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.dattheta","data/input.md_working_8.dattheta","black")'>theta</b><span style="display:none;" id="data/input.md_working_8.dattheta">The MATHEVAL action with label <b>theta</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">theta</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_8.databs_z">abs_z</b>,<b name="data/input.md_working_8.datrho">rho</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=acos(x/y) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=0.,pi
<b name="data/input.md_working_8.datphi" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.datphi","data/input.md_working_8.datphi","black")'>phi</b><span style="display:none;" id="data/input.md_working_8.datphi">The MATHEVAL action with label <b>phi</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">phi</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_8.databs_x">abs_x</b>,<b name="data/input.md_working_8.databs_y">abs_y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=atan2(y,x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=-pi,pi
<a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_8.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><b name="data/input.md_working_8.datrestr" onclick='showPath("data/input.md_working_8.dat","data/input.md_working_8.datrestr","data/input.md_working_8.datrestr","black")'>restr</b><span style="display:none;" id="data/input.md_working_8.datrestr">The UPPER_WALLS action with label <b>restr</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">restr.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">restr.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <span class="plumedtooltip" style="color:green">UPPER_WALLS<span class="right">Defines a wall for the value of one or more collective variables, <a href="https://www.plumed.org/doc-master/user-doc/html/UPPER_WALLS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the arguments on which the bias is acting<i></i></span></span>=<b name="data/input.md_working_8.datrho">rho</b> <span class="plumedtooltip">AT<span class="right">the positions of the wall<i></i></span></span>=2.8 <span class="plumedtooltip">KAPPA<span class="right">the force constant for the wall<i></i></span></span>=10000
</pre>
 {% endraw %} 
the $k$ value is 10,000 kJ/mol/nm^2, which means that if the ligand is out by 0.1 nm he will feel a potential of 100 kJ/mol.

One effect that we should take into account is the possibility that the ligand, in advanced phases of the simulation, will try to unfold the protein, being the place occupied by it the volume portion with less history-dependent potential deposited. To limit this phenomenon we will put in place a RMSD restraining that will be removed during the reweighting procedure. To compute the RMSD we will use the same atoms included in the `ref_ca.pdb` file instruction
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_9.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_9.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_9.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_9.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_9.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_9.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290

<span style="display:none;" id="data/input.md_working_9.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL

<b name="data/input.md_working_9.datprot_noh" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datprot_noh","data/input.md_working_9.datprot_noh","violet")'>prot_noh</b><span style="display:none;" id="data/input.md_working_9.datprot_noh">The GROUP action with label <b>prot_noh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prot_noh</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=Protein-H
<b name="data/input.md_working_9.datsph" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datsph","data/input.md_working_9.datsph","violet")'>sph</b><span style="display:none;" id="data/input.md_working_9.datsph">The GROUP action with label <b>sph</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=sphere
<b name="data/input.md_working_9.datlig" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datlig","data/input.md_working_9.datlig","violet")'>lig</b><span style="display:none;" id="data/input.md_working_9.datlig">The GROUP action with label <b>lig</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=ligand

<span class="plumedtooltip" style="color:green">WRAPAROUND<span class="right">Rebuild periodic boundary conditions around chosen atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/WRAPAROUND" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">wrapped atoms<i></i></span></span>=<b name="data/input.md_working_9.datlig">lig</b> <span class="plumedtooltip">AROUND<span class="right">reference atoms<i></i></span></span>=<b name="data/input.md_working_9.datsph">sph</b>

<b name="data/input.md_working_9.datsph_center" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datsph_center","data/input.md_working_9.datsph_center","violet")'>sph_center</b><span style="display:none;" id="data/input.md_working_9.datsph_center">The COM action with label <b>sph_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_9.datsph">sph</b>
<b name="data/input.md_working_9.datlig_center" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datlig_center","data/input.md_working_9.datlig_center","violet")'>lig_center</b><span style="display:none;" id="data/input.md_working_9.datlig_center">The COM action with label <b>lig_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_9.datlig">lig</b>

<b name="data/input.md_working_9.datsph_coord" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datsph_coord","data/input.md_working_9.datsph_coord","black")'>sph_coord</b><span style="display:none;" id="data/input.md_working_9.datsph_coord">The POSITION action with label <b>sph_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">sph_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">sph_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_9.datsph_center">sph_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<b name="data/input.md_working_9.datlig_coord" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datlig_coord","data/input.md_working_9.datlig_coord","black")'>lig_coord</b><span style="display:none;" id="data/input.md_working_9.datlig_coord">The POSITION action with label <b>lig_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">lig_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">lig_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_9.datlig_center">lig_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<br/><b name="data/input.md_working_9.databs_x" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.databs_x","data/input.md_working_9.databs_x","black")'>abs_x</b><span style="display:none;" id="data/input.md_working_9.databs_x">The MATHEVAL action with label <b>abs_x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_x</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_9.datlig_coord">lig_coord.x</b>,<b name="data/input.md_working_9.datsph_coord">sph_coord.x</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_9.databs_y" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.databs_y","data/input.md_working_9.databs_y","black")'>abs_y</b><span style="display:none;" id="data/input.md_working_9.databs_y">The MATHEVAL action with label <b>abs_y</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_y</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_9.datlig_coord">lig_coord.y</b>,<b name="data/input.md_working_9.datsph_coord">sph_coord.y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_9.databs_z" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.databs_z","data/input.md_working_9.databs_z","black")'>abs_z</b><span style="display:none;" id="data/input.md_working_9.databs_z">The MATHEVAL action with label <b>abs_z</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_z</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_9.datlig_coord">lig_coord.z</b>,<b name="data/input.md_working_9.datsph_coord">sph_coord.z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO

<b name="data/input.md_working_9.datrho" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datrho","data/input.md_working_9.datrho","black")'>rho</b><span style="display:none;" id="data/input.md_working_9.datrho">The MATHEVAL action with label <b>rho</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rho</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_9.databs_x">abs_x</b>,<b name="data/input.md_working_9.databs_y">abs_y</b>,<b name="data/input.md_working_9.databs_z">abs_z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x*x+y*y+z*z) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_9.dattheta" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.dattheta","data/input.md_working_9.dattheta","black")'>theta</b><span style="display:none;" id="data/input.md_working_9.dattheta">The MATHEVAL action with label <b>theta</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">theta</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_9.databs_z">abs_z</b>,<b name="data/input.md_working_9.datrho">rho</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=acos(x/y) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=0.,pi
<b name="data/input.md_working_9.datphi" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datphi","data/input.md_working_9.datphi","black")'>phi</b><span style="display:none;" id="data/input.md_working_9.datphi">The MATHEVAL action with label <b>phi</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">phi</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_9.databs_x">abs_x</b>,<b name="data/input.md_working_9.databs_y">abs_y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=atan2(y,x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=-pi,pi

<b name="data/input.md_working_9.datrestr" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datrestr","data/input.md_working_9.datrestr","black")'>restr</b><span style="display:none;" id="data/input.md_working_9.datrestr">The UPPER_WALLS action with label <b>restr</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">restr.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">restr.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <span class="plumedtooltip" style="color:green">UPPER_WALLS<span class="right">Defines a wall for the value of one or more collective variables, <a href="https://www.plumed.org/doc-master/user-doc/html/UPPER_WALLS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the arguments on which the bias is acting<i></i></span></span>=<b name="data/input.md_working_9.datrho">rho</b> <span class="plumedtooltip">AT<span class="right">the positions of the wall<i></i></span></span>=2.8 <span class="plumedtooltip">KAPPA<span class="right">the force constant for the wall<i></i></span></span>=10000
<a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_9.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><span id="data/input.md_working_9.datdefrmsd_short"><b name="data/input.md_working_9.datrmsd" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datrmsd","data/input.md_working_9.datrmsd","black")'>rmsd</b><span style="display:none;" id="data/input.md_working_9.datrmsd">The RMSD action with label <b>rmsd</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rmsd</td><td width="5%"><font color="black">scalar</font></td><td>the RMSD between the instantaneous structure and the reference structure that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">RMSD<span class="right">Calculate the RMSD with respect to a reference structure. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_9.datdefrmsd");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RMSD">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL
</span><span id="data/input.md_working_9.datdefrmsd_long" style="display:none;"><b name="data/input.md_working_9.datrmsd" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datrmsd","data/input.md_working_9.datrmsd","black")'>rmsd</b>: <span class="plumedtooltip" style="color:green">RMSD<span class="right">Calculate the RMSD with respect to a reference structure. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_9.datdefrmsd");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RMSD">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL  <span class="plumedtooltip">NUMBER<span class="right"> if there are multiple structures in the pdb file you can specify that you want the RMSD from a specific structure by specifying its place in the file here<i></i></span></span>=0
</span><span id="data/input.md_working_9.datdefrestr_rmsd_short"><b name="data/input.md_working_9.datrestr_rmsd" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datrestr_rmsd","data/input.md_working_9.datrestr_rmsd","black")'>restr_rmsd</b><span style="display:none;" id="data/input.md_working_9.datrestr_rmsd">The RESTRAINT action with label <b>restr_rmsd</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">restr_rmsd.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">restr_rmsd.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <span class="plumedtooltip" style="color:green">RESTRAINT<span class="right">Adds harmonic and/or linear restraints on one or more variables. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_9.datdefrestr_rmsd");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RESTRAINT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values the harmonic restraint acts upon<i></i></span></span>=<b name="data/input.md_working_9.datrmsd">rmsd</b> <span class="plumedtooltip">AT<span class="right">the position of the restraint<i></i></span></span>=0. <span class="plumedtooltip">KAPPA<span class="right"> specifies that the restraint is harmonic and what the values of the force constants on each of the variables are<i></i></span></span>=250.0
</span><span id="data/input.md_working_9.datdefrestr_rmsd_long" style="display:none;"><b name="data/input.md_working_9.datrestr_rmsd" onclick='showPath("data/input.md_working_9.dat","data/input.md_working_9.datrestr_rmsd","data/input.md_working_9.datrestr_rmsd","black")'>restr_rmsd</b>: <span class="plumedtooltip" style="color:green">RESTRAINT<span class="right">Adds harmonic and/or linear restraints on one or more variables. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_9.datdefrestr_rmsd");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RESTRAINT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values the harmonic restraint acts upon<i></i></span></span>=<b name="data/input.md_working_9.datrmsd">rmsd</b> <span class="plumedtooltip">AT<span class="right">the position of the restraint<i></i></span></span>=0. <span class="plumedtooltip">KAPPA<span class="right"> specifies that the restraint is harmonic and what the values of the force constants on each of the variables are<i></i></span></span>=250.0  <span class="plumedtooltip">SLOPE<span class="right"> specifies that the restraint is linear and what the values of the force constants on each of the variables are<i></i></span></span>=0.0
</span></pre>
 {% endraw %} 

### Reweighting CVs
As anticipated in the theory part, to compute binding free energy differences we will need to reweight our free energy landscape on new apt CVs which will allow us in discriminating efficiently the bound and unbound states. Like in the original work, here we will use again the distance from the origin of the reference frame $\rho$ and the number of contacts between the protein and the ligand. This will guarantee that if the guest can be considered not in contact with the host (and thus defining the unbound state), even if $\rho$ is large.

The total number of contact $c$ is defined with a switching function

$$
c = \sum_{i,j} \frac{ 1 - \left(\frac{r_{ij}}{r_0}\right)^{6} } 
{1 - \left(\frac{r_{ij}}{r_0}\right)^{12} }
$$

which runs on all the (heavy) atoms of the protein and all the atoms of the ligand. This is implemented with `COOORDINATION`:
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_10.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_10.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_10.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_10.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_10.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_10.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290

<span style="display:none;" id="data/input.md_working_10.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL

<b name="data/input.md_working_10.datprot_noh" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datprot_noh","data/input.md_working_10.datprot_noh","violet")'>prot_noh</b><span style="display:none;" id="data/input.md_working_10.datprot_noh">The GROUP action with label <b>prot_noh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prot_noh</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=Protein-H
<b name="data/input.md_working_10.datsph" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datsph","data/input.md_working_10.datsph","violet")'>sph</b><span style="display:none;" id="data/input.md_working_10.datsph">The GROUP action with label <b>sph</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=sphere
<b name="data/input.md_working_10.datlig" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datlig","data/input.md_working_10.datlig","violet")'>lig</b><span style="display:none;" id="data/input.md_working_10.datlig">The GROUP action with label <b>lig</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=ligand

<span class="plumedtooltip" style="color:green">WRAPAROUND<span class="right">Rebuild periodic boundary conditions around chosen atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/WRAPAROUND" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">wrapped atoms<i></i></span></span>=<b name="data/input.md_working_10.datlig">lig</b> <span class="plumedtooltip">AROUND<span class="right">reference atoms<i></i></span></span>=<b name="data/input.md_working_10.datsph">sph</b>

<b name="data/input.md_working_10.datsph_center" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datsph_center","data/input.md_working_10.datsph_center","violet")'>sph_center</b><span style="display:none;" id="data/input.md_working_10.datsph_center">The COM action with label <b>sph_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_10.datsph">sph</b>
<b name="data/input.md_working_10.datlig_center" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datlig_center","data/input.md_working_10.datlig_center","violet")'>lig_center</b><span style="display:none;" id="data/input.md_working_10.datlig_center">The COM action with label <b>lig_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_10.datlig">lig</b>

<b name="data/input.md_working_10.datsph_coord" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datsph_coord","data/input.md_working_10.datsph_coord","black")'>sph_coord</b><span style="display:none;" id="data/input.md_working_10.datsph_coord">The POSITION action with label <b>sph_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">sph_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">sph_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_10.datsph_center">sph_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<b name="data/input.md_working_10.datlig_coord" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datlig_coord","data/input.md_working_10.datlig_coord","black")'>lig_coord</b><span style="display:none;" id="data/input.md_working_10.datlig_coord">The POSITION action with label <b>lig_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">lig_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">lig_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_10.datlig_center">lig_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<br/><b name="data/input.md_working_10.databs_x" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.databs_x","data/input.md_working_10.databs_x","black")'>abs_x</b><span style="display:none;" id="data/input.md_working_10.databs_x">The MATHEVAL action with label <b>abs_x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_x</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_10.datlig_coord">lig_coord.x</b>,<b name="data/input.md_working_10.datsph_coord">sph_coord.x</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_10.databs_y" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.databs_y","data/input.md_working_10.databs_y","black")'>abs_y</b><span style="display:none;" id="data/input.md_working_10.databs_y">The MATHEVAL action with label <b>abs_y</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_y</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_10.datlig_coord">lig_coord.y</b>,<b name="data/input.md_working_10.datsph_coord">sph_coord.y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_10.databs_z" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.databs_z","data/input.md_working_10.databs_z","black")'>abs_z</b><span style="display:none;" id="data/input.md_working_10.databs_z">The MATHEVAL action with label <b>abs_z</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_z</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_10.datlig_coord">lig_coord.z</b>,<b name="data/input.md_working_10.datsph_coord">sph_coord.z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO

<b name="data/input.md_working_10.datrho" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datrho","data/input.md_working_10.datrho","black")'>rho</b><span style="display:none;" id="data/input.md_working_10.datrho">The MATHEVAL action with label <b>rho</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rho</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_10.databs_x">abs_x</b>,<b name="data/input.md_working_10.databs_y">abs_y</b>,<b name="data/input.md_working_10.databs_z">abs_z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x*x+y*y+z*z) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_10.dattheta" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.dattheta","data/input.md_working_10.dattheta","black")'>theta</b><span style="display:none;" id="data/input.md_working_10.dattheta">The MATHEVAL action with label <b>theta</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">theta</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_10.databs_z">abs_z</b>,<b name="data/input.md_working_10.datrho">rho</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=acos(x/y) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=0.,pi
<b name="data/input.md_working_10.datphi" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datphi","data/input.md_working_10.datphi","black")'>phi</b><span style="display:none;" id="data/input.md_working_10.datphi">The MATHEVAL action with label <b>phi</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">phi</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_10.databs_x">abs_x</b>,<b name="data/input.md_working_10.databs_y">abs_y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=atan2(y,x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=-pi,pi

<b name="data/input.md_working_10.datrestr" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datrestr","data/input.md_working_10.datrestr","black")'>restr</b><span style="display:none;" id="data/input.md_working_10.datrestr">The UPPER_WALLS action with label <b>restr</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">restr.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">restr.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <span class="plumedtooltip" style="color:green">UPPER_WALLS<span class="right">Defines a wall for the value of one or more collective variables, <a href="https://www.plumed.org/doc-master/user-doc/html/UPPER_WALLS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the arguments on which the bias is acting<i></i></span></span>=<b name="data/input.md_working_10.datrho">rho</b> <span class="plumedtooltip">AT<span class="right">the positions of the wall<i></i></span></span>=2.8 <span class="plumedtooltip">KAPPA<span class="right">the force constant for the wall<i></i></span></span>=10000

<span id="data/input.md_working_10.datdefrmsd_short"><b name="data/input.md_working_10.datrmsd" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datrmsd","data/input.md_working_10.datrmsd","black")'>rmsd</b><span style="display:none;" id="data/input.md_working_10.datrmsd">The RMSD action with label <b>rmsd</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rmsd</td><td width="5%"><font color="black">scalar</font></td><td>the RMSD between the instantaneous structure and the reference structure that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">RMSD<span class="right">Calculate the RMSD with respect to a reference structure. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_10.datdefrmsd");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RMSD">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL
</span><span id="data/input.md_working_10.datdefrmsd_long" style="display:none;"><b name="data/input.md_working_10.datrmsd" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datrmsd","data/input.md_working_10.datrmsd","black")'>rmsd</b>: <span class="plumedtooltip" style="color:green">RMSD<span class="right">Calculate the RMSD with respect to a reference structure. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_10.datdefrmsd");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RMSD">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL  <span class="plumedtooltip">NUMBER<span class="right"> if there are multiple structures in the pdb file you can specify that you want the RMSD from a specific structure by specifying its place in the file here<i></i></span></span>=0
</span><span id="data/input.md_working_10.datdefrestr_rmsd_short"><b name="data/input.md_working_10.datrestr_rmsd" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datrestr_rmsd","data/input.md_working_10.datrestr_rmsd","black")'>restr_rmsd</b><span style="display:none;" id="data/input.md_working_10.datrestr_rmsd">The RESTRAINT action with label <b>restr_rmsd</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">restr_rmsd.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">restr_rmsd.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <span class="plumedtooltip" style="color:green">RESTRAINT<span class="right">Adds harmonic and/or linear restraints on one or more variables. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_10.datdefrestr_rmsd");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RESTRAINT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values the harmonic restraint acts upon<i></i></span></span>=<b name="data/input.md_working_10.datrmsd">rmsd</b> <span class="plumedtooltip">AT<span class="right">the position of the restraint<i></i></span></span>=0. <span class="plumedtooltip">KAPPA<span class="right"> specifies that the restraint is harmonic and what the values of the force constants on each of the variables are<i></i></span></span>=250.0
</span><span id="data/input.md_working_10.datdefrestr_rmsd_long" style="display:none;"><b name="data/input.md_working_10.datrestr_rmsd" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datrestr_rmsd","data/input.md_working_10.datrestr_rmsd","black")'>restr_rmsd</b>: <span class="plumedtooltip" style="color:green">RESTRAINT<span class="right">Adds harmonic and/or linear restraints on one or more variables. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_10.datdefrestr_rmsd");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RESTRAINT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values the harmonic restraint acts upon<i></i></span></span>=<b name="data/input.md_working_10.datrmsd">rmsd</b> <span class="plumedtooltip">AT<span class="right">the position of the restraint<i></i></span></span>=0. <span class="plumedtooltip">KAPPA<span class="right"> specifies that the restraint is harmonic and what the values of the force constants on each of the variables are<i></i></span></span>=250.0  <span class="plumedtooltip">SLOPE<span class="right"> specifies that the restraint is linear and what the values of the force constants on each of the variables are<i></i></span></span>=0.0
</span><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_10.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><span id="data/input.md_working_10.datdefc_short"><b name="data/input.md_working_10.datc" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datc","data/input.md_working_10.datc","black")'>c</b><span style="display:none;" id="data/input.md_working_10.datc">The COORDINATION action with label <b>c</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c</td><td width="5%"><font color="black">scalar</font></td><td>the value of the coordination</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COORDINATION<span class="right">Calculate coordination numbers. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_10.datdefc");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/COORDINATION">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">First list of atoms<i></i></span></span>=<b name="data/input.md_working_10.datlig">lig</b> <span class="plumedtooltip">GROUPB<span class="right">Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted)<i></i></span></span>=<b name="data/input.md_working_10.datprot_noh">prot_noh</b> <span class="plumedtooltip">R_0<span class="right">The r_0 parameter of the switching function<i></i></span></span>=0.45
</span><span id="data/input.md_working_10.datdefc_long" style="display:none;"><b name="data/input.md_working_10.datc" onclick='showPath("data/input.md_working_10.dat","data/input.md_working_10.datc","data/input.md_working_10.datc","black")'>c</b>: <span class="plumedtooltip" style="color:green">COORDINATION<span class="right">Calculate coordination numbers. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_10.datdefc");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/COORDINATION">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">First list of atoms<i></i></span></span>=<b name="data/input.md_working_10.datlig">lig</b> <span class="plumedtooltip">GROUPB<span class="right">Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted)<i></i></span></span>=<b name="data/input.md_working_10.datprot_noh">prot_noh</b> <span class="plumedtooltip">R_0<span class="right">The r_0 parameter of the switching function<i></i></span></span>=0.45  <span class="plumedtooltip">D_0<span class="right"> The d_0 parameter of the switching function<i></i></span></span>=0.0 <span class="plumedtooltip">NN<span class="right"> The n parameter of the switching function <i></i></span></span>=6 <span class="plumedtooltip">MM<span class="right"> The m parameter of the switching function; 0 implies 2*NN<i></i></span></span>=0
</span></pre>
 {% endraw %} 
where we set a $r_0$ parameter at 0.45 nm.

### Volume-based Metadynamics
We now set up the VMetaD:
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_11.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_11.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_11.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_11.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_11.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_11.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290

<span style="display:none;" id="data/input.md_working_11.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL

<b name="data/input.md_working_11.datprot_noh" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datprot_noh","data/input.md_working_11.datprot_noh","violet")'>prot_noh</b><span style="display:none;" id="data/input.md_working_11.datprot_noh">The GROUP action with label <b>prot_noh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prot_noh</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=Protein-H
<b name="data/input.md_working_11.datsph" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datsph","data/input.md_working_11.datsph","violet")'>sph</b><span style="display:none;" id="data/input.md_working_11.datsph">The GROUP action with label <b>sph</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=sphere
<b name="data/input.md_working_11.datlig" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datlig","data/input.md_working_11.datlig","violet")'>lig</b><span style="display:none;" id="data/input.md_working_11.datlig">The GROUP action with label <b>lig</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=ligand

<span class="plumedtooltip" style="color:green">WRAPAROUND<span class="right">Rebuild periodic boundary conditions around chosen atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/WRAPAROUND" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">wrapped atoms<i></i></span></span>=<b name="data/input.md_working_11.datlig">lig</b> <span class="plumedtooltip">AROUND<span class="right">reference atoms<i></i></span></span>=<b name="data/input.md_working_11.datsph">sph</b>

<b name="data/input.md_working_11.datsph_center" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datsph_center","data/input.md_working_11.datsph_center","violet")'>sph_center</b><span style="display:none;" id="data/input.md_working_11.datsph_center">The COM action with label <b>sph_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_11.datsph">sph</b>
<b name="data/input.md_working_11.datlig_center" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datlig_center","data/input.md_working_11.datlig_center","violet")'>lig_center</b><span style="display:none;" id="data/input.md_working_11.datlig_center">The COM action with label <b>lig_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_11.datlig">lig</b>

<b name="data/input.md_working_11.datsph_coord" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datsph_coord","data/input.md_working_11.datsph_coord","black")'>sph_coord</b><span style="display:none;" id="data/input.md_working_11.datsph_coord">The POSITION action with label <b>sph_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">sph_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">sph_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_11.datsph_center">sph_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<b name="data/input.md_working_11.datlig_coord" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datlig_coord","data/input.md_working_11.datlig_coord","black")'>lig_coord</b><span style="display:none;" id="data/input.md_working_11.datlig_coord">The POSITION action with label <b>lig_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">lig_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">lig_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_11.datlig_center">lig_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<br/><b name="data/input.md_working_11.databs_x" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.databs_x","data/input.md_working_11.databs_x","black")'>abs_x</b><span style="display:none;" id="data/input.md_working_11.databs_x">The MATHEVAL action with label <b>abs_x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_x</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_11.datlig_coord">lig_coord.x</b>,<b name="data/input.md_working_11.datsph_coord">sph_coord.x</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_11.databs_y" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.databs_y","data/input.md_working_11.databs_y","black")'>abs_y</b><span style="display:none;" id="data/input.md_working_11.databs_y">The MATHEVAL action with label <b>abs_y</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_y</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_11.datlig_coord">lig_coord.y</b>,<b name="data/input.md_working_11.datsph_coord">sph_coord.y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_11.databs_z" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.databs_z","data/input.md_working_11.databs_z","black")'>abs_z</b><span style="display:none;" id="data/input.md_working_11.databs_z">The MATHEVAL action with label <b>abs_z</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_z</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_11.datlig_coord">lig_coord.z</b>,<b name="data/input.md_working_11.datsph_coord">sph_coord.z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO

<b name="data/input.md_working_11.datrho" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datrho","data/input.md_working_11.datrho","black")'>rho</b><span style="display:none;" id="data/input.md_working_11.datrho">The MATHEVAL action with label <b>rho</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rho</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_11.databs_x">abs_x</b>,<b name="data/input.md_working_11.databs_y">abs_y</b>,<b name="data/input.md_working_11.databs_z">abs_z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x*x+y*y+z*z) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_11.dattheta" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.dattheta","data/input.md_working_11.dattheta","black")'>theta</b><span style="display:none;" id="data/input.md_working_11.dattheta">The MATHEVAL action with label <b>theta</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">theta</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_11.databs_z">abs_z</b>,<b name="data/input.md_working_11.datrho">rho</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=acos(x/y) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=0.,pi
<b name="data/input.md_working_11.datphi" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datphi","data/input.md_working_11.datphi","black")'>phi</b><span style="display:none;" id="data/input.md_working_11.datphi">The MATHEVAL action with label <b>phi</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">phi</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_11.databs_x">abs_x</b>,<b name="data/input.md_working_11.databs_y">abs_y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=atan2(y,x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=-pi,pi

<b name="data/input.md_working_11.datrestr" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datrestr","data/input.md_working_11.datrestr","black")'>restr</b><span style="display:none;" id="data/input.md_working_11.datrestr">The UPPER_WALLS action with label <b>restr</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">restr.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">restr.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <span class="plumedtooltip" style="color:green">UPPER_WALLS<span class="right">Defines a wall for the value of one or more collective variables, <a href="https://www.plumed.org/doc-master/user-doc/html/UPPER_WALLS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the arguments on which the bias is acting<i></i></span></span>=<b name="data/input.md_working_11.datrho">rho</b> <span class="plumedtooltip">AT<span class="right">the positions of the wall<i></i></span></span>=2.8 <span class="plumedtooltip">KAPPA<span class="right">the force constant for the wall<i></i></span></span>=10000

<span id="data/input.md_working_11.datdefrmsd_short"><b name="data/input.md_working_11.datrmsd" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datrmsd","data/input.md_working_11.datrmsd","black")'>rmsd</b><span style="display:none;" id="data/input.md_working_11.datrmsd">The RMSD action with label <b>rmsd</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rmsd</td><td width="5%"><font color="black">scalar</font></td><td>the RMSD between the instantaneous structure and the reference structure that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">RMSD<span class="right">Calculate the RMSD with respect to a reference structure. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_11.datdefrmsd");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RMSD">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL
</span><span id="data/input.md_working_11.datdefrmsd_long" style="display:none;"><b name="data/input.md_working_11.datrmsd" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datrmsd","data/input.md_working_11.datrmsd","black")'>rmsd</b>: <span class="plumedtooltip" style="color:green">RMSD<span class="right">Calculate the RMSD with respect to a reference structure. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_11.datdefrmsd");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RMSD">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL  <span class="plumedtooltip">NUMBER<span class="right"> if there are multiple structures in the pdb file you can specify that you want the RMSD from a specific structure by specifying its place in the file here<i></i></span></span>=0
</span><span id="data/input.md_working_11.datdefrestr_rmsd_short"><b name="data/input.md_working_11.datrestr_rmsd" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datrestr_rmsd","data/input.md_working_11.datrestr_rmsd","black")'>restr_rmsd</b><span style="display:none;" id="data/input.md_working_11.datrestr_rmsd">The RESTRAINT action with label <b>restr_rmsd</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">restr_rmsd.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">restr_rmsd.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <span class="plumedtooltip" style="color:green">RESTRAINT<span class="right">Adds harmonic and/or linear restraints on one or more variables. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_11.datdefrestr_rmsd");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RESTRAINT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values the harmonic restraint acts upon<i></i></span></span>=<b name="data/input.md_working_11.datrmsd">rmsd</b> <span class="plumedtooltip">AT<span class="right">the position of the restraint<i></i></span></span>=0. <span class="plumedtooltip">KAPPA<span class="right"> specifies that the restraint is harmonic and what the values of the force constants on each of the variables are<i></i></span></span>=250.0
</span><span id="data/input.md_working_11.datdefrestr_rmsd_long" style="display:none;"><b name="data/input.md_working_11.datrestr_rmsd" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datrestr_rmsd","data/input.md_working_11.datrestr_rmsd","black")'>restr_rmsd</b>: <span class="plumedtooltip" style="color:green">RESTRAINT<span class="right">Adds harmonic and/or linear restraints on one or more variables. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_11.datdefrestr_rmsd");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RESTRAINT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values the harmonic restraint acts upon<i></i></span></span>=<b name="data/input.md_working_11.datrmsd">rmsd</b> <span class="plumedtooltip">AT<span class="right">the position of the restraint<i></i></span></span>=0. <span class="plumedtooltip">KAPPA<span class="right"> specifies that the restraint is harmonic and what the values of the force constants on each of the variables are<i></i></span></span>=250.0  <span class="plumedtooltip">SLOPE<span class="right"> specifies that the restraint is linear and what the values of the force constants on each of the variables are<i></i></span></span>=0.0
</span><br/><span id="data/input.md_working_11.datdefc_short"><b name="data/input.md_working_11.datc" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datc","data/input.md_working_11.datc","black")'>c</b><span style="display:none;" id="data/input.md_working_11.datc">The COORDINATION action with label <b>c</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c</td><td width="5%"><font color="black">scalar</font></td><td>the value of the coordination</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COORDINATION<span class="right">Calculate coordination numbers. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_11.datdefc");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/COORDINATION">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">First list of atoms<i></i></span></span>=<b name="data/input.md_working_11.datlig">lig</b> <span class="plumedtooltip">GROUPB<span class="right">Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted)<i></i></span></span>=<b name="data/input.md_working_11.datprot_noh">prot_noh</b> <span class="plumedtooltip">R_0<span class="right">The r_0 parameter of the switching function<i></i></span></span>=0.45
</span><span id="data/input.md_working_11.datdefc_long" style="display:none;"><b name="data/input.md_working_11.datc" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datc","data/input.md_working_11.datc","black")'>c</b>: <span class="plumedtooltip" style="color:green">COORDINATION<span class="right">Calculate coordination numbers. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_11.datdefc");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/COORDINATION">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">First list of atoms<i></i></span></span>=<b name="data/input.md_working_11.datlig">lig</b> <span class="plumedtooltip">GROUPB<span class="right">Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted)<i></i></span></span>=<b name="data/input.md_working_11.datprot_noh">prot_noh</b> <span class="plumedtooltip">R_0<span class="right">The r_0 parameter of the switching function<i></i></span></span>=0.45  <span class="plumedtooltip">D_0<span class="right"> The d_0 parameter of the switching function<i></i></span></span>=0.0 <span class="plumedtooltip">NN<span class="right"> The n parameter of the switching function <i></i></span></span>=6 <span class="plumedtooltip">MM<span class="right"> The m parameter of the switching function; 0 implies 2*NN<i></i></span></span>=0
</span><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_11.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><span id="data/input.md_working_11.datdefmetad_short"><span class="plumedtooltip" style="color:green">METAD<span class="right">Used to performed metadynamics on one or more collective variables. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_11.datdefmetad");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/METAD">More details</a><i></i></span></span> ...
  <span class="plumedtooltip">ARG<span class="right">the labels of the scalars on which the bias will act<i></i></span></span>=<b name="data/input.md_working_11.datrho">rho</b>,<b name="data/input.md_working_11.dattheta">theta</b>,<b name="data/input.md_working_11.datphi">phi</b>
  <span class="plumedtooltip">GRID_MIN<span class="right">the lower bounds for the grid<i></i></span></span>=0,0.,-pi
  <span class="plumedtooltip">GRID_MAX<span class="right">the upper bounds for the grid<i></i></span></span>=3.5,pi,pi
  <span class="plumedtooltip">SIGMA<span class="right">the widths of the Gaussian hills<i></i></span></span>=0.1,pi/16.,pi/8
  <span class="plumedtooltip">HEIGHT<span class="right">the heights of the Gaussian hills<i></i></span></span>=0.5
  <span class="plumedtooltip">PACE<span class="right">the frequency for hill addition<i></i></span></span>=2000
  <span class="plumedtooltip">BIASFACTOR<span class="right">use well tempered metadynamics and use this bias factor<i></i></span></span>=10
  <span class="plumedtooltip">TEMP<span class="right">the system temperature - this is only needed if you are doing well-tempered metadynamics<i></i></span></span>=300
  <span class="plumedtooltip">LABEL<span class="right">a label for the action so that its output can be referenced in the input to other actions<i></i></span></span>=<b name="data/input.md_working_11.datmetad" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datmetad","data/input.md_working_11.datmetad","black")'>metad</b><span style="display:none;" id="data/input.md_working_11.datmetad">The METAD action with label <b>metad</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">metad.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">metad.rbias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias normalized using the c(t) reweighting factor [rbias=bias-rct].This component can be used to obtain a reweighted histogram.</td></tr><tr><td width="5%">metad.rct</td><td width="5%"><font color="black">scalar</font></td><td>the reweighting factor c(t).</td></tr></table></span>
  <span class="plumedtooltip">CALC_RCT<span class="right"> calculate the c(t) reweighting factor and use that to obtain the normalized bias [rbias=bias-rct]<i></i></span></span>
... METAD
</span><span id="data/input.md_working_11.datdefmetad_long" style="display:none;"><span class="plumedtooltip" style="color:green">METAD<span class="right">Used to performed metadynamics on one or more collective variables. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_11.datdefmetad");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/METAD">More details</a><i></i></span></span> ...
  <span class="plumedtooltip">ARG<span class="right">the labels of the scalars on which the bias will act<i></i></span></span>=<b name="data/input.md_working_11.datrho">rho</b>,<b name="data/input.md_working_11.dattheta">theta</b>,<b name="data/input.md_working_11.datphi">phi</b>
  <span class="plumedtooltip">GRID_MIN<span class="right">the lower bounds for the grid<i></i></span></span>=0,0.,-pi
  <span class="plumedtooltip">GRID_MAX<span class="right">the upper bounds for the grid<i></i></span></span>=3.5,pi,pi
  <span class="plumedtooltip">SIGMA<span class="right">the widths of the Gaussian hills<i></i></span></span>=0.1,pi/16.,pi/8
  <span class="plumedtooltip">HEIGHT<span class="right">the heights of the Gaussian hills<i></i></span></span>=0.5
  <span class="plumedtooltip">PACE<span class="right">the frequency for hill addition<i></i></span></span>=2000
  <span class="plumedtooltip">BIASFACTOR<span class="right">use well tempered metadynamics and use this bias factor<i></i></span></span>=10
  <span class="plumedtooltip">TEMP<span class="right">the system temperature - this is only needed if you are doing well-tempered metadynamics<i></i></span></span>=300
  <span class="plumedtooltip">LABEL<span class="right">a label for the action so that its output can be referenced in the input to other actions<i></i></span></span>=<b name="data/input.md_working_11.datmetad" onclick='showPath("data/input.md_working_11.dat","data/input.md_working_11.datmetad","data/input.md_working_11.datmetad","black")'>metad</b>
  <span class="plumedtooltip">CALC_RCT<span class="right"> calculate the c(t) reweighting factor and use that to obtain the normalized bias [rbias=bias-rct]<i></i></span></span>
 <span class="plumedtooltip">FILE<span class="right"> a file in which the list of added hills is stored<i></i></span></span>=HILLS
... METAD
</span></pre>
 {% endraw %} 
The most exotic option used is `CALC_RCT`, which allows the calculation on the fly of the [Tiwary-Parrinello estimator](https://doi.org/10.1021/jp504920s) that we will use for reweighting.

### Printing
We finally print all the relevant files that we will use for post-processing and analysis. 
{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/input.md_working_12.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="input.md_working_12.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="input.md_working_12.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/input.md_working_12.dat_hiddenpart1_short"><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_12.dat_hiddenpart1")'># --- Click here to reveal hidden parts of input file ---- 
</a></span><span id="data/input.md_working_12.dat_hiddenpart1_long" style="display:none;"><span class="plumedtooltip" style="color:green">WHOLEMOLECULES<span class="right">This action is used to rebuild molecules that can become split by the periodic boundary conditions. <a href="https://www.plumed.org/doc-master/user-doc/html/WHOLEMOLECULES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ENTITY0<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1-1284 <span class="plumedtooltip">ENTITY1<span class="right">the atoms that make up a molecule that you wish to align<i></i></span></span>=1285-1290

<span style="display:none;" id="data/input.md_working_12.dat">The WHOLEMOLECULES action with label <b></b> calculates something</span><span class="plumedtooltip" style="color:green">FIT_TO_TEMPLATE<span class="right">This action is used to align a molecule to a template. <a href="https://www.plumed.org/doc-master/user-doc/html/FIT_TO_TEMPLATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL

<b name="data/input.md_working_12.datprot_noh" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datprot_noh","data/input.md_working_12.datprot_noh","violet")'>prot_noh</b><span style="display:none;" id="data/input.md_working_12.datprot_noh">The GROUP action with label <b>prot_noh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prot_noh</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=Protein-H
<b name="data/input.md_working_12.datsph" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datsph","data/input.md_working_12.datsph","violet")'>sph</b><span style="display:none;" id="data/input.md_working_12.datsph">The GROUP action with label <b>sph</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=sphere
<b name="data/input.md_working_12.datlig" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datlig","data/input.md_working_12.datlig","violet")'>lig</b><span style="display:none;" id="data/input.md_working_12.datlig">The GROUP action with label <b>lig</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NDX_FILE<span class="right">the name of index file (gromacs syntax)<i></i></span></span>=index.ndx <span class="plumedtooltip">NDX_GROUP<span class="right">the name of the group to be imported (gromacs syntax) - first group found is used by default<i></i></span></span>=ligand

<span class="plumedtooltip" style="color:green">WRAPAROUND<span class="right">Rebuild periodic boundary conditions around chosen atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/WRAPAROUND" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">wrapped atoms<i></i></span></span>=<b name="data/input.md_working_12.datlig">lig</b> <span class="plumedtooltip">AROUND<span class="right">reference atoms<i></i></span></span>=<b name="data/input.md_working_12.datsph">sph</b>

<b name="data/input.md_working_12.datsph_center" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datsph_center","data/input.md_working_12.datsph_center","violet")'>sph_center</b><span style="display:none;" id="data/input.md_working_12.datsph_center">The COM action with label <b>sph_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_12.datsph">sph</b>
<b name="data/input.md_working_12.datlig_center" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datlig_center","data/input.md_working_12.datlig_center","violet")'>lig_center</b><span style="display:none;" id="data/input.md_working_12.datlig_center">The COM action with label <b>lig_center</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_center</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by COM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COM<span class="right">Calculate the center of mass for a group of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/COM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the list of atoms which are involved the virtual atom's definition<i></i></span></span>=<b name="data/input.md_working_12.datlig">lig</b>

<b name="data/input.md_working_12.datsph_coord" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datsph_coord","data/input.md_working_12.datsph_coord","black")'>sph_coord</b><span style="display:none;" id="data/input.md_working_12.datsph_coord">The POSITION action with label <b>sph_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sph_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">sph_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">sph_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_12.datsph_center">sph_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<b name="data/input.md_working_12.datlig_coord" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datlig_coord","data/input.md_working_12.datlig_coord","black")'>lig_coord</b><span style="display:none;" id="data/input.md_working_12.datlig_coord">The POSITION action with label <b>lig_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lig_coord.x</td><td width="5%"><font color="black">scalar</font></td><td>the x-component of the atom position</td></tr><tr><td width="5%">lig_coord.y</td><td width="5%"><font color="black">scalar</font></td><td>the y-component of the atom position</td></tr><tr><td width="5%">lig_coord.z</td><td width="5%"><font color="black">scalar</font></td><td>the z-component of the atom position</td></tr></table></span>: <span class="plumedtooltip" style="color:green">POSITION<span class="right">Calculate the components of the position of an atom or atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/POSITION" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOM<span class="right">the atom number<i></i></span></span>=<b name="data/input.md_working_12.datlig_center">lig_center</b> <span class="plumedtooltip">NOPBC<span class="right"> ignore the periodic boundary conditions when calculating distances<i></i></span></span>
<br/><b name="data/input.md_working_12.databs_x" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.databs_x","data/input.md_working_12.databs_x","black")'>abs_x</b><span style="display:none;" id="data/input.md_working_12.databs_x">The MATHEVAL action with label <b>abs_x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_x</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_12.datlig_coord">lig_coord.x</b>,<b name="data/input.md_working_12.datsph_coord">sph_coord.x</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_12.databs_y" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.databs_y","data/input.md_working_12.databs_y","black")'>abs_y</b><span style="display:none;" id="data/input.md_working_12.databs_y">The MATHEVAL action with label <b>abs_y</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_y</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_12.datlig_coord">lig_coord.y</b>,<b name="data/input.md_working_12.datsph_coord">sph_coord.y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_12.databs_z" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.databs_z","data/input.md_working_12.databs_z","black")'>abs_z</b><span style="display:none;" id="data/input.md_working_12.databs_z">The MATHEVAL action with label <b>abs_z</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">abs_z</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_12.datlig_coord">lig_coord.z</b>,<b name="data/input.md_working_12.datsph_coord">sph_coord.z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x-y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO

<b name="data/input.md_working_12.datrho" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datrho","data/input.md_working_12.datrho","black")'>rho</b><span style="display:none;" id="data/input.md_working_12.datrho">The MATHEVAL action with label <b>rho</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rho</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_12.databs_x">abs_x</b>,<b name="data/input.md_working_12.databs_y">abs_y</b>,<b name="data/input.md_working_12.databs_z">abs_z</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x*x+y*y+z*z) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/input.md_working_12.dattheta" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.dattheta","data/input.md_working_12.dattheta","black")'>theta</b><span style="display:none;" id="data/input.md_working_12.dattheta">The MATHEVAL action with label <b>theta</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">theta</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_12.databs_z">abs_z</b>,<b name="data/input.md_working_12.datrho">rho</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=acos(x/y) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=0.,pi
<b name="data/input.md_working_12.datphi" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datphi","data/input.md_working_12.datphi","black")'>phi</b><span style="display:none;" id="data/input.md_working_12.datphi">The MATHEVAL action with label <b>phi</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">phi</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATHEVAL<span class="right">An alias to the CUSTOM function that can also be used to calaculate combinations of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/MATHEVAL" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/input.md_working_12.databs_x">abs_x</b>,<b name="data/input.md_working_12.databs_y">abs_y</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=atan2(y,x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=-pi,pi

<b name="data/input.md_working_12.datrestr" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datrestr","data/input.md_working_12.datrestr","black")'>restr</b><span style="display:none;" id="data/input.md_working_12.datrestr">The UPPER_WALLS action with label <b>restr</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">restr.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">restr.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <span class="plumedtooltip" style="color:green">UPPER_WALLS<span class="right">Defines a wall for the value of one or more collective variables, <a href="https://www.plumed.org/doc-master/user-doc/html/UPPER_WALLS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the arguments on which the bias is acting<i></i></span></span>=<b name="data/input.md_working_12.datrho">rho</b> <span class="plumedtooltip">AT<span class="right">the positions of the wall<i></i></span></span>=2.8 <span class="plumedtooltip">KAPPA<span class="right">the force constant for the wall<i></i></span></span>=10000

<span id="data/input.md_working_12.datdefrmsd_short"><b name="data/input.md_working_12.datrmsd" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datrmsd","data/input.md_working_12.datrmsd","black")'>rmsd</b><span style="display:none;" id="data/input.md_working_12.datrmsd">The RMSD action with label <b>rmsd</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rmsd</td><td width="5%"><font color="black">scalar</font></td><td>the RMSD between the instantaneous structure and the reference structure that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">RMSD<span class="right">Calculate the RMSD with respect to a reference structure. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_12.datdefrmsd");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RMSD">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL
</span><span id="data/input.md_working_12.datdefrmsd_long" style="display:none;"><b name="data/input.md_working_12.datrmsd" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datrmsd","data/input.md_working_12.datrmsd","black")'>rmsd</b>: <span class="plumedtooltip" style="color:green">RMSD<span class="right">Calculate the RMSD with respect to a reference structure. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_12.datdefrmsd");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RMSD">More details</a><i></i></span></span> <span class="plumedtooltip">REFERENCE<span class="right">a file in pdb format containing the reference structure and the atoms involved in the CV<i></i></span></span>=ref_ca.pdb <span class="plumedtooltip">TYPE<span class="right"> the manner in which RMSD alignment is performed<i></i></span></span>=OPTIMAL  <span class="plumedtooltip">NUMBER<span class="right"> if there are multiple structures in the pdb file you can specify that you want the RMSD from a specific structure by specifying its place in the file here<i></i></span></span>=0
</span><span id="data/input.md_working_12.datdefrestr_rmsd_short"><b name="data/input.md_working_12.datrestr_rmsd" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datrestr_rmsd","data/input.md_working_12.datrestr_rmsd","black")'>restr_rmsd</b><span style="display:none;" id="data/input.md_working_12.datrestr_rmsd">The RESTRAINT action with label <b>restr_rmsd</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">restr_rmsd.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">restr_rmsd.force2</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the squared force due to this bias potential</td></tr></table></span>: <span class="plumedtooltip" style="color:green">RESTRAINT<span class="right">Adds harmonic and/or linear restraints on one or more variables. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_12.datdefrestr_rmsd");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RESTRAINT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values the harmonic restraint acts upon<i></i></span></span>=<b name="data/input.md_working_12.datrmsd">rmsd</b> <span class="plumedtooltip">AT<span class="right">the position of the restraint<i></i></span></span>=0. <span class="plumedtooltip">KAPPA<span class="right"> specifies that the restraint is harmonic and what the values of the force constants on each of the variables are<i></i></span></span>=250.0
</span><span id="data/input.md_working_12.datdefrestr_rmsd_long" style="display:none;"><b name="data/input.md_working_12.datrestr_rmsd" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datrestr_rmsd","data/input.md_working_12.datrestr_rmsd","black")'>restr_rmsd</b>: <span class="plumedtooltip" style="color:green">RESTRAINT<span class="right">Adds harmonic and/or linear restraints on one or more variables. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_12.datdefrestr_rmsd");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RESTRAINT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values the harmonic restraint acts upon<i></i></span></span>=<b name="data/input.md_working_12.datrmsd">rmsd</b> <span class="plumedtooltip">AT<span class="right">the position of the restraint<i></i></span></span>=0. <span class="plumedtooltip">KAPPA<span class="right"> specifies that the restraint is harmonic and what the values of the force constants on each of the variables are<i></i></span></span>=250.0  <span class="plumedtooltip">SLOPE<span class="right"> specifies that the restraint is linear and what the values of the force constants on each of the variables are<i></i></span></span>=0.0
</span><br/><span id="data/input.md_working_12.datdefc_short"><b name="data/input.md_working_12.datc" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datc","data/input.md_working_12.datc","black")'>c</b><span style="display:none;" id="data/input.md_working_12.datc">The COORDINATION action with label <b>c</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c</td><td width="5%"><font color="black">scalar</font></td><td>the value of the coordination</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COORDINATION<span class="right">Calculate coordination numbers. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_12.datdefc");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/COORDINATION">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">First list of atoms<i></i></span></span>=<b name="data/input.md_working_12.datlig">lig</b> <span class="plumedtooltip">GROUPB<span class="right">Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted)<i></i></span></span>=<b name="data/input.md_working_12.datprot_noh">prot_noh</b> <span class="plumedtooltip">R_0<span class="right">The r_0 parameter of the switching function<i></i></span></span>=0.45
</span><span id="data/input.md_working_12.datdefc_long" style="display:none;"><b name="data/input.md_working_12.datc" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datc","data/input.md_working_12.datc","black")'>c</b>: <span class="plumedtooltip" style="color:green">COORDINATION<span class="right">Calculate coordination numbers. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_12.datdefc");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/COORDINATION">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">First list of atoms<i></i></span></span>=<b name="data/input.md_working_12.datlig">lig</b> <span class="plumedtooltip">GROUPB<span class="right">Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted)<i></i></span></span>=<b name="data/input.md_working_12.datprot_noh">prot_noh</b> <span class="plumedtooltip">R_0<span class="right">The r_0 parameter of the switching function<i></i></span></span>=0.45  <span class="plumedtooltip">D_0<span class="right"> The d_0 parameter of the switching function<i></i></span></span>=0.0 <span class="plumedtooltip">NN<span class="right"> The n parameter of the switching function <i></i></span></span>=6 <span class="plumedtooltip">MM<span class="right"> The m parameter of the switching function; 0 implies 2*NN<i></i></span></span>=0
</span><br/><span id="data/input.md_working_12.datdefmetad_short"><span class="plumedtooltip" style="color:green">METAD<span class="right">Used to performed metadynamics on one or more collective variables. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_12.datdefmetad");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/METAD">More details</a><i></i></span></span> ...
  <span class="plumedtooltip">ARG<span class="right">the labels of the scalars on which the bias will act<i></i></span></span>=<b name="data/input.md_working_12.datrho">rho</b>,<b name="data/input.md_working_12.dattheta">theta</b>,<b name="data/input.md_working_12.datphi">phi</b>
  <span class="plumedtooltip">GRID_MIN<span class="right">the lower bounds for the grid<i></i></span></span>=0,0.,-pi
  <span class="plumedtooltip">GRID_MAX<span class="right">the upper bounds for the grid<i></i></span></span>=3.5,pi,pi
  <span class="plumedtooltip">SIGMA<span class="right">the widths of the Gaussian hills<i></i></span></span>=0.1,pi/16.,pi/8
  <span class="plumedtooltip">HEIGHT<span class="right">the heights of the Gaussian hills<i></i></span></span>=0.5
  <span class="plumedtooltip">PACE<span class="right">the frequency for hill addition<i></i></span></span>=2000
  <span class="plumedtooltip">BIASFACTOR<span class="right">use well tempered metadynamics and use this bias factor<i></i></span></span>=10
  <span class="plumedtooltip">TEMP<span class="right">the system temperature - this is only needed if you are doing well-tempered metadynamics<i></i></span></span>=300
  <span class="plumedtooltip">LABEL<span class="right">a label for the action so that its output can be referenced in the input to other actions<i></i></span></span>=<b name="data/input.md_working_12.datmetad" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datmetad","data/input.md_working_12.datmetad","black")'>metad</b><span style="display:none;" id="data/input.md_working_12.datmetad">The METAD action with label <b>metad</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">metad.bias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%">metad.rbias</td><td width="5%"><font color="black">scalar</font></td><td>the instantaneous value of the bias normalized using the c(t) reweighting factor [rbias=bias-rct].This component can be used to obtain a reweighted histogram.</td></tr><tr><td width="5%">metad.rct</td><td width="5%"><font color="black">scalar</font></td><td>the reweighting factor c(t).</td></tr></table></span>
  <span class="plumedtooltip">CALC_RCT<span class="right"> calculate the c(t) reweighting factor and use that to obtain the normalized bias [rbias=bias-rct]<i></i></span></span>
... METAD
</span><span id="data/input.md_working_12.datdefmetad_long" style="display:none;"><span class="plumedtooltip" style="color:green">METAD<span class="right">Used to performed metadynamics on one or more collective variables. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/input.md_working_12.datdefmetad");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/METAD">More details</a><i></i></span></span> ...
  <span class="plumedtooltip">ARG<span class="right">the labels of the scalars on which the bias will act<i></i></span></span>=<b name="data/input.md_working_12.datrho">rho</b>,<b name="data/input.md_working_12.dattheta">theta</b>,<b name="data/input.md_working_12.datphi">phi</b>
  <span class="plumedtooltip">GRID_MIN<span class="right">the lower bounds for the grid<i></i></span></span>=0,0.,-pi
  <span class="plumedtooltip">GRID_MAX<span class="right">the upper bounds for the grid<i></i></span></span>=3.5,pi,pi
  <span class="plumedtooltip">SIGMA<span class="right">the widths of the Gaussian hills<i></i></span></span>=0.1,pi/16.,pi/8
  <span class="plumedtooltip">HEIGHT<span class="right">the heights of the Gaussian hills<i></i></span></span>=0.5
  <span class="plumedtooltip">PACE<span class="right">the frequency for hill addition<i></i></span></span>=2000
  <span class="plumedtooltip">BIASFACTOR<span class="right">use well tempered metadynamics and use this bias factor<i></i></span></span>=10
  <span class="plumedtooltip">TEMP<span class="right">the system temperature - this is only needed if you are doing well-tempered metadynamics<i></i></span></span>=300
  <span class="plumedtooltip">LABEL<span class="right">a label for the action so that its output can be referenced in the input to other actions<i></i></span></span>=<b name="data/input.md_working_12.datmetad" onclick='showPath("data/input.md_working_12.dat","data/input.md_working_12.datmetad","data/input.md_working_12.datmetad","black")'>metad</b>
  <span class="plumedtooltip">CALC_RCT<span class="right"> calculate the c(t) reweighting factor and use that to obtain the normalized bias [rbias=bias-rct]<i></i></span></span>
 <span class="plumedtooltip">FILE<span class="right"> a file in which the list of added hills is stored<i></i></span></span>=HILLS
... METAD
</span><a class="toggler" style="color:red" onclick='toggleDisplay("data/input.md_working_12.dat_hiddenpart1")'># --- Click here to hide input --- 
</a></span><span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/input.md_working_12.datmetad">metad.*</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=metad_data.dat <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=200
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/input.md_working_12.datrmsd">rmsd</b>,<b name="data/input.md_working_12.datrestr_rmsd">restr_rmsd.bias</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=rmsd_restraint.dat <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=200
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/input.md_working_12.datrestr">restr.bias</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=sphere_restraint.dat <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=200
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/input.md_working_12.databs_x">abs_x</b>,<b name="data/input.md_working_12.databs_y">abs_y</b>,<b name="data/input.md_working_12.databs_z">abs_z</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=xyz_coord.dat <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=200
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/input.md_working_12.datrho">rho</b>,<b name="data/input.md_working_12.dattheta">theta</b>,<b name="data/input.md_working_12.datphi">phi</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=rtp_coord.dat <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=200
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/input.md_working_12.datc">c</b>,<b name="data/input.md_working_12.datrho">rho</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=coord_rho.dat <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the quantities of interest should be output<i></i></span></span>=200

<span class="plumedtooltip" style="color:green">FLUSH<span class="right">This command instructs plumed to flush all the open files with a user specified frequency. <a href="https://www.plumed.org/doc-master/user-doc/html/FLUSH" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">STRIDE<span class="right">the frequency with which all the open files should be flushed<i></i></span></span>=200
</pre>
 {% endraw %} 
We will have all the VMetaD quantities in `metad_data.dat`, the restraints data in `{rmsd,sphere}_restaint.dat`, the $(x,y,z)$ and $(\rho,\theta,\varphi)$ coordinates in `xyz_coord.dat` and `rtp_coord.dat`, respectively, and the reweighting CVs in `coord_rho.dat`.

___PLEASE NOTE___: all the printing frequencies are synchronized with the VMetaD `PACE` (every 10 print we deposit 1 gaussian), and it should be synchronized also with trajectory printing (I personally suggest the same frequency used for gaussian deposition). This allows us to restart safely in case of issues and re-run or re-analyze with new CVs the run, if needed.

### Last advices before launching the simulation
One issue that can be observed when launching when running VMetaD is the sudden interruption of the simulation with a cryptic error. Please check the position of the ligand: in most cases, the system reached $(\rho,\theta,\varphi)=(0,0,0)$, where the derivatives of the potential cannot be defined, and thus PLUMED sends an error. Despite being annoying, this is perfectly normal, and does not invalidate the run. Please restart it from the previous checkpoint (save a checkpoint often!).

Another consideration regarding the singularity of the reference frame is its position with respect to the actual binding site. In close proximity of it (let's say less than 2 sigmas in $\rho$) even an extremely small movement in any direction makes the ligand move of several sigmas in $\theta$ and $\varphi$, with the possibility of underestimation of the bias. This could imply the need of longer simulation times to fill up the basin. To limit this effect, we suggest to verify if the origin of the reference frame is farther that 2-3 sigmas in $\rho$ from the binding site (the perfect situation would be setting the origin in a point occupied by the host, at 4-5 Å from the binding site).

### Launch!
You can now run the VMetaD tutorial. We advice you to run it for (at least) 500 ns. In this example, we run it for 1 µs.

##### [Back to VMetad home](NAVIGATION.md)
