# Histograms 

Whenver we compute a histogram we are computing multiple averages at the same time.  Consequently, I think that the input syntax syntax that we use for computing histograms should respect the 
distinction between:

1. Computing a time average
2. Computing a spatial average over multiple indistinguishable instances of the same quantity.
3. Computing an average over replicas

that I discussed in the post on [averaging](averaging).  In this post I will explain how I have implemented histograms in a way that respects this distinction.

## Time-average histograms

The code for calculating a histogram is the same as it was in previous versions of PLUMED.  To calculate the distribution of values that the distance between atoms 1 and 2 took during your simulation
you use the following input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_1.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_1.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_1.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<b name="data/histograms.md_working_1.datx" onclick='showPath("data/histograms.md_working_1.dat","data/histograms.md_working_1.datx","data/histograms.md_working_1.datx","black")'>x</b><span style="display:none;" id="data/histograms.md_working_1.datx">The DISTANCE action with label <b>x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">x</td><td width="5%"><font color="black">scalar</font></td><td>the DISTANCE between this pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,2
<span id="data/histograms.md_working_1.dathA_short"><span id="data/histograms.md_working_1.datdefhA_short"><b name="data/histograms.md_working_1.dathA" onclick='showPath("data/histograms.md_working_1.dat","data/histograms.md_working_1.dathA","data/histograms.md_working_1.dathA_shortcut","green")'>hA</b><span style="display:none;" id="data/histograms.md_working_1.dathA_shortcut">The HISTOGRAM action with label <b>hA</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA</td><td width="5%"><font color="green">grid</font></td><td>the estimate of the histogram as a function of the argument that was obtained</td></tr></table></span>: <span class="plumedtooltip" style="color:green">HISTOGRAM<span class="right">Accumulate the average probability density along a few CVs from a trajectory. This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_1.dathA");'>a shortcut</a> and it has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_1.datdefhA");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/HISTOGRAM">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the quantities that are being used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_1.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1 <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which to store data for averaging<i></i></span></span>=1
</span><span id="data/histograms.md_working_1.datdefhA_long" style="display:none;"><b name="data/histograms.md_working_1.dathA" onclick='showPath("data/histograms.md_working_1.dat","data/histograms.md_working_1.dathA","data/histograms.md_working_1.dathA_shortcut","green")'>hA</b>: <span class="plumedtooltip" style="color:green">HISTOGRAM<span class="right">Accumulate the average probability density along a few CVs from a trajectory. This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_1.dathA");'>a shortcut</a> and uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_1.datdefhA");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/HISTOGRAM">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the quantities that are being used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_1.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1 <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which to store data for averaging<i></i></span></span>=1  <span class="plumedtooltip">NORMALIZATION<span class="right"> This controls how the data is normalized it can be set equal to true, false or ndata<i></i></span></span>=ndata <span class="plumedtooltip">CLEAR<span class="right"> the frequency with whihc to clear the data that is being averaged<i></i></span></span>=0
</span></span><span id="data/histograms.md_working_1.dathA_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/histograms.md_working_1.dathA")'># hA: HISTOGRAM ARG=x GRID_MIN=0.0 GRID_MAX=3.0 GRID_BIN=100 BANDWIDTH=0.1 STRIDE=1</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/histograms.md_working_1.dathA_weight" onclick='showPath("data/histograms.md_working_1.dat","data/histograms.md_working_1.dathA_weight","data/histograms.md_working_1.dathA_weight","black")'>hA_weight</b><span style="display:none;" id="data/histograms.md_working_1.dathA_weight">The CONSTANT action with label <b>hA_weight</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_weight</td><td width="5%"><font color="black">scalar</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=1
<b name="data/histograms.md_working_1.dathA_kde" onclick='showPath("data/histograms.md_working_1.dat","data/histograms.md_working_1.dathA_kde","data/histograms.md_working_1.dathA_kde","green")'>hA_kde</b><span style="display:none;" id="data/histograms.md_working_1.dathA_kde">The KDE action with label <b>hA_kde</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kde</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE <a href="https://www.plumed.org/doc-master/user-doc/html/KDE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_1.datx">x</b>  <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1
<b name="data/histograms.md_working_1.dathA_kdep" onclick='showPath("data/histograms.md_working_1.dat","data/histograms.md_working_1.dathA_kdep","data/histograms.md_working_1.dathA_kdep","green")'>hA_kdep</b><span style="display:none;" id="data/histograms.md_working_1.dathA_kdep">The CUSTOM action with label <b>hA_kdep</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kdep</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_1.dathA_kde">hA_kde</b>,<b name="data/histograms.md_working_1.dathA_weight">hA_weight</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_1.dathA_u" onclick='showPath("data/histograms.md_working_1.dat","data/histograms.md_working_1.dathA_u","data/histograms.md_working_1.dathA_u","green")'>hA_u</b><span style="display:none;" id="data/histograms.md_working_1.dathA_u">The ACCUMULATE action with label <b>hA_u</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_u</td><td width="5%"><font color="green">grid</font></td><td>a sum calculated from the time series of the input quantity</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_1.dathA_kdep">hA_kdep</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1 <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear all the accumulated data<i></i></span></span>=0 
<b name="data/histograms.md_working_1.dathA_nsum" onclick='showPath("data/histograms.md_working_1.dat","data/histograms.md_working_1.dathA_nsum","data/histograms.md_working_1.dathA_nsum","black")'>hA_nsum</b><span style="display:none;" id="data/histograms.md_working_1.dathA_nsum">The ACCUMULATE action with label <b>hA_nsum</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_nsum</td><td width="5%"><font color="black">scalar</font></td><td>a sum calculated from the time series of the input quantity</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_1.dathA_weight">hA_weight</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1 <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear all the accumulated data<i></i></span></span>=0 
<b name="data/histograms.md_working_1.dathA" onclick='showPath("data/histograms.md_working_1.dat","data/histograms.md_working_1.dathA","data/histograms.md_working_1.dathA","green")'>hA</b><span style="display:none;" id="data/histograms.md_working_1.dathA">The CUSTOM action with label <b>hA</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_1.dathA_u">hA_u</b>,<b name="data/histograms.md_working_1.dathA_nsum">hA_nsum</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the grid that you would like to output<i></i></span></span>=<b name="data/histograms.md_working_1.dathA">hA</b> <span class="plumedtooltip">FILE<span class="right"> the file on which to write the grid<i></i></span></span>=histo <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=1 
</pre>
 {% endraw %} 

If you look in more detail at this input though you see that the HISTOGRAM action is a shortcut that expands to the following much longer and more complicated looking input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_2.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_2.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_2.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Compute the distance</span>
<b name="data/histograms.md_working_2.datx" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.datx","data/histograms.md_working_2.datx","black")'>x</b><span style="display:none;" id="data/histograms.md_working_2.datx">The DISTANCE action with label <b>x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">x</td><td width="5%"><font color="black">scalar</font></td><td>the DISTANCE between this pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,2
<span style="color:blue" class="comment"># Setup the weight of the kernel that will be added to our histogram</span>
<span id="data/histograms.md_working_2.datdefhA_weight_short"><b name="data/histograms.md_working_2.dathA_weight" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.dathA_weight","data/histograms.md_working_2.dathA_weight","black")'>hA_weight</b><span style="display:none;" id="data/histograms.md_working_2.dathA_weight">The CONSTANT action with label <b>hA_weight</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_weight</td><td width="5%"><font color="black">scalar</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_2.datdefhA_weight");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1
</span><span id="data/histograms.md_working_2.datdefhA_weight_long" style="display:none;"><b name="data/histograms.md_working_2.dathA_weight" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.dathA_weight","data/histograms.md_working_2.dathA_weight","black")'>hA_weight</b>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_2.datdefhA_weight");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1  <span class="plumedtooltip">NROWS<span class="right"> the number of rows in your input matrix<i></i></span></span>=0 <span class="plumedtooltip">NCOLS<span class="right"> the number of columns in your matrix<i></i></span></span>=0
</span><span style="color:blue" class="comment"># Convert the distance into the single kernel that is added to the grid</span>
<span id="data/histograms.md_working_2.datdefhA_kde_short"><b name="data/histograms.md_working_2.dathA_kde" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.dathA_kde","data/histograms.md_working_2.dathA_kde","green")'>hA_kde</b><span style="display:none;" id="data/histograms.md_working_2.dathA_kde">The KDE action with label <b>hA_kde</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kde</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_2.datdefhA_kde");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_2.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1
</span><span id="data/histograms.md_working_2.datdefhA_kde_long" style="display:none;"><b name="data/histograms.md_working_2.dathA_kde" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.dathA_kde","data/histograms.md_working_2.dathA_kde","green")'>hA_kde</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_2.datdefhA_kde");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_2.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span><span style="color:blue" class="comment"># Multiply the kernel we created by the weight of this frame</span>
<b name="data/histograms.md_working_2.dathA_kdep" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.dathA_kdep","data/histograms.md_working_2.dathA_kdep","green")'>hA_kdep</b><span style="display:none;" id="data/histograms.md_working_2.dathA_kdep">The CUSTOM action with label <b>hA_kdep</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kdep</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_2.dathA_kde">hA_kde</b>,<b name="data/histograms.md_working_2.dathA_weight">hA_weight</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Accumulate all the kernels into the final grid</span>
<span id="data/histograms.md_working_2.datdefhA_u_short"><b name="data/histograms.md_working_2.dathA_u" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.dathA_u","data/histograms.md_working_2.dathA_u","green")'>hA_u</b><span style="display:none;" id="data/histograms.md_working_2.dathA_u">The ACCUMULATE action with label <b>hA_u</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_u</td><td width="5%"><font color="green">grid</font></td><td>a sum calculated from the time series of the input quantity</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_2.datdefhA_u");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_2.dathA_kdep">hA_kdep</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1
</span><span id="data/histograms.md_working_2.datdefhA_u_long" style="display:none;"><b name="data/histograms.md_working_2.dathA_u" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.dathA_u","data/histograms.md_working_2.dathA_u","green")'>hA_u</b>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_2.datdefhA_u");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_2.dathA_kdep">hA_kdep</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1  <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear all the accumulated data<i></i></span></span>=0
</span><span style="color:blue" class="comment"># Accumulate the sum of all the weights of all frames</span>
<span id="data/histograms.md_working_2.datdefhA_nsum_short"><b name="data/histograms.md_working_2.dathA_nsum" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.dathA_nsum","data/histograms.md_working_2.dathA_nsum","black")'>hA_nsum</b><span style="display:none;" id="data/histograms.md_working_2.dathA_nsum">The ACCUMULATE action with label <b>hA_nsum</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_nsum</td><td width="5%"><font color="black">scalar</font></td><td>a sum calculated from the time series of the input quantity</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_2.datdefhA_nsum");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_2.dathA_weight">hA_weight</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1
</span><span id="data/histograms.md_working_2.datdefhA_nsum_long" style="display:none;"><b name="data/histograms.md_working_2.dathA_nsum" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.dathA_nsum","data/histograms.md_working_2.dathA_nsum","black")'>hA_nsum</b>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_2.datdefhA_nsum");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_2.dathA_weight">hA_weight</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1  <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear all the accumulated data<i></i></span></span>=0
</span><span style="color:blue" class="comment"># And compute the average histogram</span>
<b name="data/histograms.md_working_2.dathA" onclick='showPath("data/histograms.md_working_2.dat","data/histograms.md_working_2.dathA","data/histograms.md_working_2.dathA","green")'>hA</b><span style="display:none;" id="data/histograms.md_working_2.dathA">The CUSTOM action with label <b>hA</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_2.dathA_u">hA_u</b>,<b name="data/histograms.md_working_2.dathA_nsum">hA_nsum</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the grid that you would like to output<i></i></span></span>=<b name="data/histograms.md_working_2.dathA">hA</b> <span class="plumedtooltip">FILE<span class="right"> the file on which to write the grid<i></i></span></span>=histo <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=1
</pre>
 {% endraw %} 

One can, in fact, go even further and rewrite this input like this:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_3.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_3.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_3.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<b name="data/histograms.md_working_3.datx" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.datx","data/histograms.md_working_3.datx","black")'>x</b><span style="display:none;" id="data/histograms.md_working_3.datx">The DISTANCE action with label <b>x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">x</td><td width="5%"><font color="black">scalar</font></td><td>the DISTANCE between this pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,2
<span style="color:blue" class="comment"># This bit sets up values that hold the shape of the kernel we are adding.</span>
<span id="data/histograms.md_working_3.datdefhA_sigma_short"><b name="data/histograms.md_working_3.dathA_sigma" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_sigma","data/histograms.md_working_3.dathA_sigma","black")'>hA_sigma</b><span style="display:none;" id="data/histograms.md_working_3.dathA_sigma">The CONSTANT action with label <b>hA_sigma</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_sigma</td><td width="5%"><font color="black">scalar</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_3.datdefhA_sigma");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=0.1
</span><span id="data/histograms.md_working_3.datdefhA_sigma_long" style="display:none;"><b name="data/histograms.md_working_3.dathA_sigma" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_sigma","data/histograms.md_working_3.dathA_sigma","black")'>hA_sigma</b>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_3.datdefhA_sigma");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=0.1  <span class="plumedtooltip">NROWS<span class="right"> the number of rows in your input matrix<i></i></span></span>=0 <span class="plumedtooltip">NCOLS<span class="right"> the number of columns in your matrix<i></i></span></span>=0
</span><b name="data/histograms.md_working_3.dathA_cov" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_cov","data/histograms.md_working_3.dathA_cov","black")'>hA_cov</b><span style="display:none;" id="data/histograms.md_working_3.dathA_cov">The CUSTOM action with label <b>hA_cov</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_cov</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_sigma">hA_sigma</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*x <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_3.dathA_icov" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_icov","data/histograms.md_working_3.dathA_icov","black")'>hA_icov</b><span style="display:none;" id="data/histograms.md_working_3.dathA_icov">The CUSTOM action with label <b>hA_icov</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_icov</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_cov">hA_cov</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=1/x <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># This bit sets up the height of the Gaussian in a way that ensures that the </span>
<span style="color:blue" class="comment"># volume of the kernel is one.</span>
<b name="data/histograms.md_working_3.dathA_h" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_h","data/histograms.md_working_3.dathA_h","black")'>hA_h</b><span style="display:none;" id="data/histograms.md_working_3.dathA_h">The CUSTOM action with label <b>hA_h</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_h</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_sigma">hA_sigma</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=1/(x*sqrt(2*pi)) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span id="data/histograms.md_working_3.datdefhA_weight_short"><b name="data/histograms.md_working_3.dathA_weight" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_weight","data/histograms.md_working_3.dathA_weight","black")'>hA_weight</b><span style="display:none;" id="data/histograms.md_working_3.dathA_weight">The CONSTANT action with label <b>hA_weight</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_weight</td><td width="5%"><font color="black">scalar</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_3.datdefhA_weight");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1
</span><span id="data/histograms.md_working_3.datdefhA_weight_long" style="display:none;"><b name="data/histograms.md_working_3.dathA_weight" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_weight","data/histograms.md_working_3.dathA_weight","black")'>hA_weight</b>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_3.datdefhA_weight");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1  <span class="plumedtooltip">NROWS<span class="right"> the number of rows in your input matrix<i></i></span></span>=0 <span class="plumedtooltip">NCOLS<span class="right"> the number of columns in your matrix<i></i></span></span>=0
</span><span id="data/histograms.md_working_3.datdefhA_kde_short"><b name="data/histograms.md_working_3.dathA_kde" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_kde","data/histograms.md_working_3.dathA_kde","green")'>hA_kde</b><span style="display:none;" id="data/histograms.md_working_3.dathA_kde">The KDE action with label <b>hA_kde</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kde</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_3.datdefhA_kde");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_3.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">HEIGHTS<span class="right">this keyword takes the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_h">hA_h</b> <span class="plumedtooltip">METRIC<span class="right">the inverse covariance to use for the kernels that are added to the grid<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_icov">hA_icov</b>
</span><span id="data/histograms.md_working_3.datdefhA_kde_long" style="display:none;"><b name="data/histograms.md_working_3.dathA_kde" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_kde","data/histograms.md_working_3.dathA_kde","green")'>hA_kde</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_3.datdefhA_kde");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_3.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">HEIGHTS<span class="right">this keyword takes the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_h">hA_h</b> <span class="plumedtooltip">METRIC<span class="right">the inverse covariance to use for the kernels that are added to the grid<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_icov">hA_icov</b>  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span><b name="data/histograms.md_working_3.dathA_kdep" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_kdep","data/histograms.md_working_3.dathA_kdep","green")'>hA_kdep</b><span style="display:none;" id="data/histograms.md_working_3.dathA_kdep">The CUSTOM action with label <b>hA_kdep</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kdep</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_kde">hA_kde</b>,<b name="data/histograms.md_working_3.dathA_weight">hA_weight</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span id="data/histograms.md_working_3.datdefhA_u_short"><b name="data/histograms.md_working_3.dathA_u" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_u","data/histograms.md_working_3.dathA_u","green")'>hA_u</b><span style="display:none;" id="data/histograms.md_working_3.dathA_u">The ACCUMULATE action with label <b>hA_u</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_u</td><td width="5%"><font color="green">grid</font></td><td>a sum calculated from the time series of the input quantity</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_3.datdefhA_u");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_kdep">hA_kdep</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1
</span><span id="data/histograms.md_working_3.datdefhA_u_long" style="display:none;"><b name="data/histograms.md_working_3.dathA_u" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_u","data/histograms.md_working_3.dathA_u","green")'>hA_u</b>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_3.datdefhA_u");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_kdep">hA_kdep</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1  <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear all the accumulated data<i></i></span></span>=0
</span><span id="data/histograms.md_working_3.datdefhA_nsum_short"><b name="data/histograms.md_working_3.dathA_nsum" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_nsum","data/histograms.md_working_3.dathA_nsum","black")'>hA_nsum</b><span style="display:none;" id="data/histograms.md_working_3.dathA_nsum">The ACCUMULATE action with label <b>hA_nsum</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_nsum</td><td width="5%"><font color="black">scalar</font></td><td>a sum calculated from the time series of the input quantity</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_3.datdefhA_nsum");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_weight">hA_weight</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1
</span><span id="data/histograms.md_working_3.datdefhA_nsum_long" style="display:none;"><b name="data/histograms.md_working_3.dathA_nsum" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA_nsum","data/histograms.md_working_3.dathA_nsum","black")'>hA_nsum</b>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_3.datdefhA_nsum");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_weight">hA_weight</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1  <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear all the accumulated data<i></i></span></span>=0
</span><b name="data/histograms.md_working_3.dathA" onclick='showPath("data/histograms.md_working_3.dat","data/histograms.md_working_3.dathA","data/histograms.md_working_3.dathA","green")'>hA</b><span style="display:none;" id="data/histograms.md_working_3.dathA">The CUSTOM action with label <b>hA</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_3.dathA_u">hA_u</b>,<b name="data/histograms.md_working_3.dathA_nsum">hA_nsum</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the grid that you would like to output<i></i></span></span>=<b name="data/histograms.md_working_3.dathA">hA</b> <span class="plumedtooltip">FILE<span class="right"> the file on which to write the grid<i></i></span></span>=histo <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=1
</pre>
 {% endraw %} 

In other words, the input syntax for these actions is flexibile enough that you can pass the shape of the Gaussians that you want to use when constructing your histogram in the input and the heights of the Gaussians to use.  
You can even pass a matrix in the input for the METRIC keyword if you want to use non-diagonal covariance matrices when adding kernels.  In short, users have an exquisite control over the way their histograms are constructed
if they move away from using the short cuts.  Importantly, they can control how the histogram is normalised or not normalised.  In collaborations I have been a part of I have found that folks want to exploit this flexibilty.  
I also hope that the syntax I will describe in these pages offers this flexibilty while still being quite transparant.  

## Time and spatial average histograms

In the inputs above the DISTANCE command outputs a single scalar.  Creating and storing a grid to hold the single Gaussian centered on this distance value using a KDE command and only then adding it to the histogram that is being 
accumulated by the ACCUMULATE command thus perhaps seems perverse.  When one has multiple indistinguishable representations of the same quantity in each trajectory frame, however, the reason for separating these two actions becomes more clear.  Consider the 
following input that is calculating the distribution of coordination numbers:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_4.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_4.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_4.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/histograms.md_working_4.datc1_short"><b name="data/histograms.md_working_4.datc1" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.datc1","data/histograms.md_working_4.datc1_shortcut","blue")'>c1</b><span style="display:none;" id="data/histograms.md_working_4.datc1_shortcut">The COORDINATIONNUMBER action with label <b>c1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1</td><td width="5%"><font color="blue">vector</font></td><td>the coordination numbers of the specified atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COORDINATIONNUMBER<span class="right">Calculate the coordination numbers of atoms so that you can then calculate functions of the distribution of This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_4.datc1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/COORDINATIONNUMBER">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL R_0=1}
</span><span id="data/histograms.md_working_4.datc1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/histograms.md_working_4.datc1")'># c1: COORDINATIONNUMBER SPECIES=1-100 SWITCH={RATIONAL R_0=1}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/histograms.md_working_4.datc1_grp" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.datc1_grp","data/histograms.md_working_4.datc1_grp","violet")'>c1_grp</b><span style="display:none;" id="data/histograms.md_working_4.datc1_grp">The GROUP action with label <b>c1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=1-100
<b name="data/histograms.md_working_4.datc1_mat" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.datc1_mat","data/histograms.md_working_4.datc1_mat","red")'>c1_mat</b><span style="display:none;" id="data/histograms.md_working_4.datc1_mat">The CONTACT_MATRIX action with label <b>c1_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1_mat</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL R_0=1}
<b name="data/histograms.md_working_4.datc1_ones" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.datc1_ones","data/histograms.md_working_4.datc1_ones","blue")'>c1_ones</b><span style="display:none;" id="data/histograms.md_working_4.datc1_ones">The CONSTANT action with label <b>c1_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/histograms.md_working_4.datc1" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.datc1","data/histograms.md_working_4.datc1","blue")'>c1</b><span style="display:none;" id="data/histograms.md_working_4.datc1">The MATRIX_VECTOR_PRODUCT action with label <b>c1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span>  <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/histograms.md_working_4.datc1_mat">c1_mat</b>,<b name="data/histograms.md_working_4.datc1_ones">c1_ones</b>
<span style="color:blue"># --- End of included input --- </span></span><span id="data/histograms.md_working_4.datdefhA_weight_short"><b name="data/histograms.md_working_4.dathA_weight" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.dathA_weight","data/histograms.md_working_4.dathA_weight","black")'>hA_weight</b><span style="display:none;" id="data/histograms.md_working_4.dathA_weight">The CONSTANT action with label <b>hA_weight</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_weight</td><td width="5%"><font color="black">scalar</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_4.datdefhA_weight");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1
</span><span id="data/histograms.md_working_4.datdefhA_weight_long" style="display:none;"><b name="data/histograms.md_working_4.dathA_weight" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.dathA_weight","data/histograms.md_working_4.dathA_weight","black")'>hA_weight</b>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_4.datdefhA_weight");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1  <span class="plumedtooltip">NROWS<span class="right"> the number of rows in your input matrix<i></i></span></span>=0 <span class="plumedtooltip">NCOLS<span class="right"> the number of columns in your matrix<i></i></span></span>=0
</span><span id="data/histograms.md_working_4.datdefhA_kde_short"><b name="data/histograms.md_working_4.dathA_kde" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.dathA_kde","data/histograms.md_working_4.dathA_kde","green")'>hA_kde</b><span style="display:none;" id="data/histograms.md_working_4.dathA_kde">The KDE action with label <b>hA_kde</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kde</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_4.datdefhA_kde");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_4.datc1">c1</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=12.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=120 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1
</span><span id="data/histograms.md_working_4.datdefhA_kde_long" style="display:none;"><b name="data/histograms.md_working_4.dathA_kde" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.dathA_kde","data/histograms.md_working_4.dathA_kde","green")'>hA_kde</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_4.datdefhA_kde");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_4.datc1">c1</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=12.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=120 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span><b name="data/histograms.md_working_4.dathA_kdep" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.dathA_kdep","data/histograms.md_working_4.dathA_kdep","green")'>hA_kdep</b><span style="display:none;" id="data/histograms.md_working_4.dathA_kdep">The CUSTOM action with label <b>hA_kdep</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kdep</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_4.dathA_kde">hA_kde</b>,<b name="data/histograms.md_working_4.dathA_weight">hA_weight</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span id="data/histograms.md_working_4.datdefhA_u_short"><b name="data/histograms.md_working_4.dathA_u" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.dathA_u","data/histograms.md_working_4.dathA_u","green")'>hA_u</b><span style="display:none;" id="data/histograms.md_working_4.dathA_u">The ACCUMULATE action with label <b>hA_u</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_u</td><td width="5%"><font color="green">grid</font></td><td>a sum calculated from the time series of the input quantity</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_4.datdefhA_u");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_4.dathA_kdep">hA_kdep</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1
</span><span id="data/histograms.md_working_4.datdefhA_u_long" style="display:none;"><b name="data/histograms.md_working_4.dathA_u" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.dathA_u","data/histograms.md_working_4.dathA_u","green")'>hA_u</b>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_4.datdefhA_u");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_4.dathA_kdep">hA_kdep</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1  <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear all the accumulated data<i></i></span></span>=0
</span><span id="data/histograms.md_working_4.datdefhA_nsum_short"><b name="data/histograms.md_working_4.dathA_nsum" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.dathA_nsum","data/histograms.md_working_4.dathA_nsum","black")'>hA_nsum</b><span style="display:none;" id="data/histograms.md_working_4.dathA_nsum">The ACCUMULATE action with label <b>hA_nsum</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_nsum</td><td width="5%"><font color="black">scalar</font></td><td>a sum calculated from the time series of the input quantity</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_4.datdefhA_nsum");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_4.dathA_weight">hA_weight</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1
</span><span id="data/histograms.md_working_4.datdefhA_nsum_long" style="display:none;"><b name="data/histograms.md_working_4.dathA_nsum" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.dathA_nsum","data/histograms.md_working_4.dathA_nsum","black")'>hA_nsum</b>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_4.datdefhA_nsum");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_4.dathA_weight">hA_weight</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1  <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear all the accumulated data<i></i></span></span>=0
</span><b name="data/histograms.md_working_4.dathA" onclick='showPath("data/histograms.md_working_4.dat","data/histograms.md_working_4.dathA","data/histograms.md_working_4.dathA","green")'>hA</b><span style="display:none;" id="data/histograms.md_working_4.dathA">The CUSTOM action with label <b>hA</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_4.dathA_u">hA_u</b>,<b name="data/histograms.md_working_4.dathA_nsum">hA_nsum</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the grid that you would like to output<i></i></span></span>=<b name="data/histograms.md_working_4.dathA">hA</b> <span class="plumedtooltip">FILE<span class="right"> the file on which to write the grid<i></i></span></span>=histo <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=1
</pre>
 {% endraw %} 

In the input above the final histogram is caclulated by averaging over time and over the multiple indistinguishable realisations of the coordination number in each trajectory frame.  The KDE action computes a histogram from the instantaneous
values of all the coordination numbers, while the ACCUMULATE then adds all these instantaneous distributions together and hence does the averaging over time.  Notice, furthermore, that we can multiply each instaneous KDE estimate by the 
weight of the corresponding trajectory frame if we are reweighting a biased simulation using a CUSTOM action before we pass the instaneous estimate of the distribution to the ACCUMULATE action.  The input for this type of calculation is pretty 
transparent and flexible as the user does everything with CUSTOM actions (i.e. mathematical equations).  They are not forced to learn an exotic syntax for doing reweighting.

The real reason that I have introduced this separation between the KDE and HISTOGRAM actions is because of how KDE has been used for biasing in papers such as [this one](https://pubs.acs.org/doi/full/10.1021/acs.jctc.7b01027).  In that paper the instantaenous distribution of an order parameter is computed using 
kernel density estimation.  The Kulback Leibler divergence between the instantaneous distribution and some reference distribution is then used as a CV in a biased simulation.  To use a CV like this in PLUMED you would use an input like the one shown below:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_5.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_5.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_5.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<b name="data/histograms.md_working_5.datd1" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datd1","data/histograms.md_working_5.datd1","blue")'>d1</b><span style="display:none;" id="data/histograms.md_working_5.datd1">The DISTANCE action with label <b>d1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">d1</td><td width="5%"><font color="blue">vector</font></td><td>the DISTANCE for each set of specified atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS1<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,2 <span class="plumedtooltip">ATOMS2<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,3 <span class="plumedtooltip">ATOMS3<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,4 <span class="plumedtooltip">ATOMS4<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,5 <span class="plumedtooltip">ATOMS5<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=2,3 <span class="plumedtooltip">ATOMS6<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=2,4 <span class="plumedtooltip">ATOMS7<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=2,5 <span class="plumedtooltip">ATOMS8<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=3,4 <span class="plumedtooltip">ATOMS9<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=3,5 <span class="plumedtooltip">ATOMS10<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=4,5
<b name="data/histograms.md_working_5.datd1lt" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datd1lt","data/histograms.md_working_5.datd1lt","blue")'>d1lt</b><span style="display:none;" id="data/histograms.md_working_5.datd1lt">The LESS_THAN action with label <b>d1lt</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">d1lt</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a function that is one if the input is less than a threshold to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">LESS_THAN<span class="right">Use a switching function to determine how many of the input variables are less than a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_5.datd1">d1</b> <span class="plumedtooltip">SWITCH<span class="right">This keyword is used if you want to employ an alternative to the continuous swiching function defined above<i></i></span></span>={RATIONAL D_0=2.0 R_0=0.5 D_MAX=5.0}
<br/><b name="data/histograms.md_working_5.datd1c" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datd1c","data/histograms.md_working_5.datd1c","blue")'>d1c</b><span style="display:none;" id="data/histograms.md_working_5.datd1c">The DISTANCE action with label <b>d1c</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">d1c.x</td><td width="5%"><font color="blue">vector</font></td><td>the x-component of the vector connecting the two atoms</td></tr><tr><td width="5%">d1c.y</td><td width="5%"><font color="blue">vector</font></td><td>the y-component of the vector connecting the two atoms</td></tr><tr><td width="5%">d1c.z</td><td width="5%"><font color="blue">vector</font></td><td>the z-component of the vector connecting the two atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS1<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=2,1 <span class="plumedtooltip">ATOMS2<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=3,1 <span class="plumedtooltip">ATOMS3<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=4,1 <span class="plumedtooltip">ATOMS4<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=5,1 <span class="plumedtooltip">ATOMS5<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=3,2 <span class="plumedtooltip">ATOMS6<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=4,2 <span class="plumedtooltip">ATOMS7<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=5,2 <span class="plumedtooltip">ATOMS8<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=4,3 <span class="plumedtooltip">ATOMS9<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=5,3 <span class="plumedtooltip">ATOMS10<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=5,4 <span class="plumedtooltip">COMPONENTS<span class="right"> calculate the x, y and z components of the distance separately and store them as label<i></i></span></span>
<b name="data/histograms.md_working_5.datd2" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datd2","data/histograms.md_working_5.datd2","blue")'>d2</b><span style="display:none;" id="data/histograms.md_working_5.datd2">The COMBINE action with label <b>d2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">d2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_5.datd1c">d1c.x</b>,<b name="data/histograms.md_working_5.datd1c">d1c.y</b>,<b name="data/histograms.md_working_5.datd1c">d1c.z</b> <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2 <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_5.dataa" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.dataa","data/histograms.md_working_5.dataa","blue")'>aa</b><span style="display:none;" id="data/histograms.md_working_5.dataa">The CUSTOM action with label <b>aa</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">aa</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_5.datd1c">d1c.z</b>,<b name="data/histograms.md_working_5.datd2">d2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=acos(x/sqrt(y)) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO

<span id="data/histograms.md_working_5.datdefdd0_short"><b name="data/histograms.md_working_5.datdd0" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datdd0","data/histograms.md_working_5.datdd0","violet")'>dd0</b><span style="display:none;" id="data/histograms.md_working_5.datdd0">The FIXEDATOM action with label <b>dd0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">dd0</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by FIXEDATOM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">FIXEDATOM<span class="right">Add a virtual atom in a fixed position. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_5.datdefdd0");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/FIXEDATOM">More details</a><i></i></span></span> <span class="plumedtooltip">AT<span class="right">coordinates of the virtual atom<i></i></span></span>=0,0,0
</span><span id="data/histograms.md_working_5.datdefdd0_long" style="display:none;"><b name="data/histograms.md_working_5.datdd0" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datdd0","data/histograms.md_working_5.datdd0","violet")'>dd0</b>: <span class="plumedtooltip" style="color:green">FIXEDATOM<span class="right">Add a virtual atom in a fixed position. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_5.datdefdd0");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/FIXEDATOM">More details</a><i></i></span></span> <span class="plumedtooltip">AT<span class="right">coordinates of the virtual atom<i></i></span></span>=0,0,0  <span class="plumedtooltip">SET_MASS<span class="right"> mass of the virtual atom<i></i></span></span>=1 <span class="plumedtooltip">SET_CHARGE<span class="right"> charge of the virtual atom<i></i></span></span>=0
</span><span id="data/histograms.md_working_5.datdefddx_short"><b name="data/histograms.md_working_5.datddx" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datddx","data/histograms.md_working_5.datddx","violet")'>ddx</b><span style="display:none;" id="data/histograms.md_working_5.datddx">The FIXEDATOM action with label <b>ddx</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ddx</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by FIXEDATOM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">FIXEDATOM<span class="right">Add a virtual atom in a fixed position. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_5.datdefddx");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/FIXEDATOM">More details</a><i></i></span></span> <span class="plumedtooltip">AT<span class="right">coordinates of the virtual atom<i></i></span></span>=1,0,0
</span><span id="data/histograms.md_working_5.datdefddx_long" style="display:none;"><b name="data/histograms.md_working_5.datddx" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datddx","data/histograms.md_working_5.datddx","violet")'>ddx</b>: <span class="plumedtooltip" style="color:green">FIXEDATOM<span class="right">Add a virtual atom in a fixed position. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_5.datdefddx");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/FIXEDATOM">More details</a><i></i></span></span> <span class="plumedtooltip">AT<span class="right">coordinates of the virtual atom<i></i></span></span>=1,0,0  <span class="plumedtooltip">SET_MASS<span class="right"> mass of the virtual atom<i></i></span></span>=1 <span class="plumedtooltip">SET_CHARGE<span class="right"> charge of the virtual atom<i></i></span></span>=0
</span><span id="data/histograms.md_working_5.datdefddz_short"><b name="data/histograms.md_working_5.datddz" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datddz","data/histograms.md_working_5.datddz","violet")'>ddz</b><span style="display:none;" id="data/histograms.md_working_5.datddz">The FIXEDATOM action with label <b>ddz</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ddz</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by FIXEDATOM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">FIXEDATOM<span class="right">Add a virtual atom in a fixed position. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_5.datdefddz");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/FIXEDATOM">More details</a><i></i></span></span> <span class="plumedtooltip">AT<span class="right">coordinates of the virtual atom<i></i></span></span>=0,0,1
</span><span id="data/histograms.md_working_5.datdefddz_long" style="display:none;"><b name="data/histograms.md_working_5.datddz" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datddz","data/histograms.md_working_5.datddz","violet")'>ddz</b>: <span class="plumedtooltip" style="color:green">FIXEDATOM<span class="right">Add a virtual atom in a fixed position. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_5.datdefddz");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/FIXEDATOM">More details</a><i></i></span></span> <span class="plumedtooltip">AT<span class="right">coordinates of the virtual atom<i></i></span></span>=0,0,1  <span class="plumedtooltip">SET_MASS<span class="right"> mass of the virtual atom<i></i></span></span>=1 <span class="plumedtooltip">SET_CHARGE<span class="right"> charge of the virtual atom<i></i></span></span>=0
</span><br/><b name="data/histograms.md_working_5.dattt" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.dattt","data/histograms.md_working_5.dattt","blue")'>tt</b><span style="display:none;" id="data/histograms.md_working_5.dattt">The TORSION action with label <b>tt</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">tt</td><td width="5%"><font color="blue">vector</font></td><td>the TORSION for each set of specified atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">TORSION<span class="right">Calculate one or multiple torsional angles. <a href="https://www.plumed.org/doc-master/user-doc/html/TORSION" style="color:green">More details</a><i></i></span></span> ...
   <span class="plumedtooltip">VECTORA1<span class="right">two atoms that define a vector<i></i></span></span>=2,1 <span class="plumedtooltip">VECTORB1<span class="right">two atoms that define a vector<i></i></span></span>=<b name="data/histograms.md_working_5.datddx">ddx</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b> <span class="plumedtooltip">AXIS1<span class="right">two atoms that define an axis<i></i></span></span>=<b name="data/histograms.md_working_5.datddz">ddz</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b>
   <span class="plumedtooltip">VECTORA2<span class="right">two atoms that define a vector<i></i></span></span>=3,1 <span class="plumedtooltip">VECTORB2<span class="right">two atoms that define a vector<i></i></span></span>=<b name="data/histograms.md_working_5.datddx">ddx</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b> <span class="plumedtooltip">AXIS2<span class="right">two atoms that define an axis<i></i></span></span>=<b name="data/histograms.md_working_5.datddz">ddz</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b>
   <span class="plumedtooltip">VECTORA3<span class="right">two atoms that define a vector<i></i></span></span>=4,1 <span class="plumedtooltip">VECTORB3<span class="right">two atoms that define a vector<i></i></span></span>=<b name="data/histograms.md_working_5.datddx">ddx</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b> <span class="plumedtooltip">AXIS3<span class="right">two atoms that define an axis<i></i></span></span>=<b name="data/histograms.md_working_5.datddz">ddz</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b>
   <span class="plumedtooltip">VECTORA4<span class="right">two atoms that define a vector<i></i></span></span>=5,1 <span class="plumedtooltip">VECTORB4<span class="right">two atoms that define a vector<i></i></span></span>=<b name="data/histograms.md_working_5.datddx">ddx</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b> <span class="plumedtooltip">AXIS4<span class="right">two atoms that define an axis<i></i></span></span>=<b name="data/histograms.md_working_5.datddz">ddz</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b>
   <span class="plumedtooltip">VECTORA5<span class="right">two atoms that define a vector<i></i></span></span>=3,2 <span class="plumedtooltip">VECTORB5<span class="right">two atoms that define a vector<i></i></span></span>=<b name="data/histograms.md_working_5.datddx">ddx</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b> <span class="plumedtooltip">AXIS5<span class="right">two atoms that define an axis<i></i></span></span>=<b name="data/histograms.md_working_5.datddz">ddz</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b>
   <span class="plumedtooltip">VECTORA6<span class="right">two atoms that define a vector<i></i></span></span>=4,2 <span class="plumedtooltip">VECTORB6<span class="right">two atoms that define a vector<i></i></span></span>=<b name="data/histograms.md_working_5.datddx">ddx</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b> <span class="plumedtooltip">AXIS6<span class="right">two atoms that define an axis<i></i></span></span>=<b name="data/histograms.md_working_5.datddz">ddz</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b>
   <span class="plumedtooltip">VECTORA7<span class="right">two atoms that define a vector<i></i></span></span>=5,2 <span class="plumedtooltip">VECTORB7<span class="right">two atoms that define a vector<i></i></span></span>=<b name="data/histograms.md_working_5.datddx">ddx</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b> <span class="plumedtooltip">AXIS7<span class="right">two atoms that define an axis<i></i></span></span>=<b name="data/histograms.md_working_5.datddz">ddz</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b>
   <span class="plumedtooltip">VECTORA8<span class="right">two atoms that define a vector<i></i></span></span>=4,3 <span class="plumedtooltip">VECTORB8<span class="right">two atoms that define a vector<i></i></span></span>=<b name="data/histograms.md_working_5.datddx">ddx</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b> <span class="plumedtooltip">AXIS8<span class="right">two atoms that define an axis<i></i></span></span>=<b name="data/histograms.md_working_5.datddz">ddz</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b>
   <span class="plumedtooltip">VECTORA9<span class="right">two atoms that define a vector<i></i></span></span>=5,3 <span class="plumedtooltip">VECTORB9<span class="right">two atoms that define a vector<i></i></span></span>=<b name="data/histograms.md_working_5.datddx">ddx</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b> <span class="plumedtooltip">AXIS9<span class="right">two atoms that define an axis<i></i></span></span>=<b name="data/histograms.md_working_5.datddz">ddz</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b>
   <span class="plumedtooltip">VECTORA10<span class="right">two atoms that define a vector<i></i></span></span>=5,4 <span class="plumedtooltip">VECTORB10<span class="right">two atoms that define a vector<i></i></span></span>=<b name="data/histograms.md_working_5.datddx">ddx</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b> <span class="plumedtooltip">AXIS10<span class="right">two atoms that define an axis<i></i></span></span>=<b name="data/histograms.md_working_5.datddz">ddz</b>,<b name="data/histograms.md_working_5.datdd0">dd0</b>
...
<br/><span id="data/histograms.md_working_5.datdefhu_short"><b name="data/histograms.md_working_5.dathu" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.dathu","data/histograms.md_working_5.dathu","green")'>hu</b><span style="display:none;" id="data/histograms.md_working_5.dathu">The KDE action with label <b>hu</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hu</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_5.datdefhu");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">VOLUMES<span class="right">this keyword take the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_5.datd1lt">d1lt</b> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_5.dataa">aa</b>,<b name="data/histograms.md_working_5.dattt">tt</b> <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=20,20 <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0,-pi <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=pi,pi <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.2,0.2
</span><span id="data/histograms.md_working_5.datdefhu_long" style="display:none;"><b name="data/histograms.md_working_5.dathu" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.dathu","data/histograms.md_working_5.dathu","green")'>hu</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_5.datdefhu");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">VOLUMES<span class="right">this keyword take the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_5.datd1lt">d1lt</b> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_5.dataa">aa</b>,<b name="data/histograms.md_working_5.dattt">tt</b> <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=20,20 <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0,-pi <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=pi,pi <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.2,0.2  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span><b name="data/histograms.md_working_5.datde" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datde","data/histograms.md_working_5.datde","black")'>de</b><span style="display:none;" id="data/histograms.md_working_5.datde">The SUM action with label <b>de</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">de</td><td width="5%"><font color="black">scalar</font></td><td>the SUM of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SUM<span class="right">Calculate the sum of the arguments <a href="https://www.plumed.org/doc-master/user-doc/html/SUM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/histograms.md_working_5.datd1lt">d1lt</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_5.dath" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.dath","data/histograms.md_working_5.dath","green")'>h</b><span style="display:none;" id="data/histograms.md_working_5.dath">The CUSTOM action with label <b>h</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">h</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_5.dathu">hu</b>,<b name="data/histograms.md_working_5.datde">de</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_5.datklg" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datklg","data/histograms.md_working_5.datklg","green")'>klg</b><span style="display:none;" id="data/histograms.md_working_5.datklg">The CUSTOM action with label <b>klg</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">klg</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_5.dath">h</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=log(1/x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span id="data/histograms.md_working_5.datkl_short"><b name="data/histograms.md_working_5.datkl" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datkl","data/histograms.md_working_5.datkl_shortcut","black")'>kl</b><span style="display:none;" id="data/histograms.md_working_5.datkl_shortcut">The INTEGRATE_GRID action with label <b>kl</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">kl</td><td width="5%"><font color="black">scalar</font></td><td>the numerical integral of the input function over its whole domain</td></tr></table></span>: <span class="plumedtooltip" style="color:green">INTEGRATE_GRID<span class="right">Calculate the numerical integral of the function stored on the grid This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_5.datkl");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/INTEGRATE_GRID">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the function on a grid that is being integrated<i></i></span></span>=<b name="data/histograms.md_working_5.datklg">klg</b> <span class="plumedtooltip">PERIODIC<span class="right">if the value of the output integral has a periodid domain then you use this keyword to specify the periodicity<i></i></span></span>=NO
</span><span id="data/histograms.md_working_5.datkl_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/histograms.md_working_5.datkl")'># kl: INTEGRATE_GRID ARG=klg PERIODIC=NO</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/histograms.md_working_5.datkl_volelem" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datkl_volelem","data/histograms.md_working_5.datkl_volelem","black")'>kl_volelem</b><span style="display:none;" id="data/histograms.md_working_5.datkl_volelem">The GET_VOLUME_ELEMENT action with label <b>kl_volelem</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">kl_volelem</td><td width="5%"><font color="black">scalar</font></td><td>the volume element </td></tr></table></span>: <span class="plumedtooltip" style="color:green">GET_VOLUME_ELEMENT<span class="right">Get the volume element from the input grid <a href="https://www.plumed.org/doc-master/user-doc/html/GET_VOLUME_ELEMENT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for function on the grid that you need the volume element for<i></i></span></span>=<b name="data/histograms.md_working_5.datklg">klg</b>
<b name="data/histograms.md_working_5.datkl_sum" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datkl_sum","data/histograms.md_working_5.datkl_sum","black")'>kl_sum</b><span style="display:none;" id="data/histograms.md_working_5.datkl_sum">The SUM action with label <b>kl_sum</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">kl_sum</td><td width="5%"><font color="black">scalar</font></td><td>the SUM of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SUM<span class="right">Calculate the sum of the arguments <a href="https://www.plumed.org/doc-master/user-doc/html/SUM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/histograms.md_working_5.datklg">klg</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_5.datkl" onclick='showPath("data/histograms.md_working_5.dat","data/histograms.md_working_5.datkl","data/histograms.md_working_5.datkl","black")'>kl</b><span style="display:none;" id="data/histograms.md_working_5.datkl">The CUSTOM action with label <b>kl</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">kl</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_5.datkl_volelem">kl_volelem</b>,<b name="data/histograms.md_working_5.datkl_sum">kl_sum</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><br/><span class="plumedtooltip" style="color:green">RESTRAINT<span class="right">Adds harmonic and/or linear restraints on one or more variables. <a href="https://www.plumed.org/doc-master/user-doc/html/RESTRAINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values the harmonic restraint acts upon<i></i></span></span>=<b name="data/histograms.md_working_5.datkl">kl</b> <span class="plumedtooltip">AT<span class="right">the position of the restraint<i></i></span></span>=1.0 <span class="plumedtooltip">KAPPA<span class="right"> specifies that the restraint is harmonic and what the values of the force constants on each of the variables are<i></i></span></span>=10
</pre>
 {% endraw %} 

This input looks at the instantaneous distribution of $\theta$ and $\phi$ angles for the bonds between atoms and their neighbours in the first coordination sphere.  $\phi$ is defined as the angle between the vector connecting the two atoms and the positive $z$ direction.
$\theta$ is then the torsional angle between the bond and the positive $x$ direction.  In other words, $\theta$ and $\phi$ are the second two spherical polar coordinates.  You can see that we construct the instantaneous distribution of bonds in this spheircal polar direction
and then compute the Kulbeck-Leibler divergence between this instantaneous distribution and a reference uniform distribution.  Notice, finally, that we can add a restraint on this very complicated CV and that PLUMED will work out the 
derivatives on the atoms using the chain rule for us.  

## The radial distribution function 

The grid and histogram functionality that I have described in the previous sections can be used to calculate the radial distribution function (RDF).  I have thus implemented a shortcut action to calculate the RDF that works as follows.  If you click on the RDF command you will be given the option
to expand the shortcut and see how this command is built from simpler PLUMED actions.

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_6.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_6.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_6.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/histograms.md_working_6.datrdf_short"><span id="data/histograms.md_working_6.datdefrdf_short"><b name="data/histograms.md_working_6.datrdf" onclick='showPath("data/histograms.md_working_6.dat","data/histograms.md_working_6.datrdf","data/histograms.md_working_6.datrdf_shortcut","green")'>rdf</b><span style="display:none;" id="data/histograms.md_working_6.datrdf_shortcut">The RDF action with label <b>rdf</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rdf</td><td width="5%"><font color="green">grid</font></td><td>the radial distribution function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">RDF<span class="right">Calculate the radial distribution function This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_6.datrdf");'>a shortcut</a> and it has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_6.datdefrdf");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RDF">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">the atoms that are being used to calculate the RDF<i></i></span></span>=1-1000 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins to use when computing the RDF<i></i></span></span>=100 <span class="plumedtooltip">MAXR<span class="right">the maximum distance to use for the rdf<i></i></span></span>=1.0 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.01
</span><span id="data/histograms.md_working_6.datdefrdf_long" style="display:none;"><b name="data/histograms.md_working_6.datrdf" onclick='showPath("data/histograms.md_working_6.dat","data/histograms.md_working_6.datrdf","data/histograms.md_working_6.datrdf_shortcut","green")'>rdf</b>: <span class="plumedtooltip" style="color:green">RDF<span class="right">Calculate the radial distribution function This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_6.datrdf");'>a shortcut</a> and uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_6.datdefrdf");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/RDF">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">the atoms that are being used to calculate the RDF<i></i></span></span>=1-1000 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins to use when computing the RDF<i></i></span></span>=100 <span class="plumedtooltip">MAXR<span class="right">the maximum distance to use for the rdf<i></i></span></span>=1.0 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.01  <span class="plumedtooltip">KERNEL<span class="right"> the type of kernel to use for computing the histograms for the RDF<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25 <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear the estimate of the rdf<i></i></span></span>=1 <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which to compute the rdf and accumulate averages<i></i></span></span>=1
</span></span><span id="data/histograms.md_working_6.datrdf_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/histograms.md_working_6.datrdf")'># rdf: RDF GROUP=1-1000 GRID_BIN=100 MAXR=1.0 BANDWIDTH=0.01</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/histograms.md_working_6.datrdf_x2" onclick='showPath("data/histograms.md_working_6.dat","data/histograms.md_working_6.datrdf_x2","data/histograms.md_working_6.datrdf_x2","green")'>rdf_x2</b><span style="display:none;" id="data/histograms.md_working_6.datrdf_x2">The REFERENCE_GRID action with label <b>rdf_x2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rdf_x2</td><td width="5%"><font color="green">grid</font></td><td>the constant function on the grid that was specified in input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">REFERENCE_GRID<span class="right">Setup a constant grid by either reading values from a file or definining a function in input <a href="https://www.plumed.org/doc-master/user-doc/html/REFERENCE_GRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">are the grid directions periodic<i></i></span></span>=NO <span class="plumedtooltip">FUNC<span class="right">the function to compute on the grid<i></i></span></span>=x*x <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=1.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100
<b name="data/histograms.md_working_6.datrdf_vol" onclick='showPath("data/histograms.md_working_6.dat","data/histograms.md_working_6.datrdf_vol","data/histograms.md_working_6.datrdf_vol","black")'>rdf_vol</b><span style="display:none;" id="data/histograms.md_working_6.datrdf_vol">The VOLUME action with label <b>rdf_vol</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rdf_vol</td><td width="5%"><font color="black">scalar</font></td><td>the volume of simulation box</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VOLUME<span class="right">Calculate the volume the simulation box. <a href="https://www.plumed.org/doc-master/user-doc/html/VOLUME" style="color:green">More details</a><i></i></span></span>
<b name="data/histograms.md_working_6.datrdf_mat" onclick='showPath("data/histograms.md_working_6.dat","data/histograms.md_working_6.datrdf_mat","data/histograms.md_working_6.datrdf_mat","red")'>rdf_mat</b><span style="display:none;" id="data/histograms.md_working_6.datrdf_mat">The DISTANCE_MATRIX action with label <b>rdf_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rdf_mat</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE_MATRIX<span class="right">Calculate a matrix of distances between atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">CUTOFF<span class="right"> ignore distances that have a value larger than this cutoff<i></i></span></span>=1.03536 <span class="plumedtooltip">GROUP<span class="right">the atoms for which you would like to calculate the adjacency matrix<i></i></span></span>=1-1000
<b name="data/histograms.md_working_6.datrdf_wmat" onclick='showPath("data/histograms.md_working_6.dat","data/histograms.md_working_6.datrdf_wmat","data/histograms.md_working_6.datrdf_wmat","red")'>rdf_wmat</b><span style="display:none;" id="data/histograms.md_working_6.datrdf_wmat">The CUSTOM action with label <b>rdf_wmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rdf_wmat</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_6.datrdf_mat">rdf_mat</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=step(1.03536-x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_6.datrdf_kde" onclick='showPath("data/histograms.md_working_6.dat","data/histograms.md_working_6.datrdf_kde","data/histograms.md_working_6.datrdf_kde","green")'>rdf_kde</b><span style="display:none;" id="data/histograms.md_working_6.datrdf_kde">The KDE action with label <b>rdf_kde</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rdf_kde</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE <a href="https://www.plumed.org/doc-master/user-doc/html/KDE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_6.datrdf_mat">rdf_mat</b> <span class="plumedtooltip">VOLUMES<span class="right">this keyword take the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_6.datrdf_wmat">rdf_wmat</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=1.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">IGNORE_IF_OUT_OF_RANGE<span class="right"> if a kernel is outside of the range of the grid it is safe to ignore<i></i></span></span> <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.01
<b name="data/histograms.md_working_6.datrdf_vrdf" onclick='showPath("data/histograms.md_working_6.dat","data/histograms.md_working_6.datrdf_vrdf","data/histograms.md_working_6.datrdf_vrdf","green")'>rdf_vrdf</b><span style="display:none;" id="data/histograms.md_working_6.datrdf_vrdf">The CUSTOM action with label <b>rdf_vrdf</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rdf_vrdf</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_6.datrdf_kde">rdf_kde</b>,<b name="data/histograms.md_working_6.datrdf_x2">rdf_x2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/(4*pi*y) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_6.datrdf" onclick='showPath("data/histograms.md_working_6.dat","data/histograms.md_working_6.datrdf","data/histograms.md_working_6.datrdf","green")'>rdf</b><span style="display:none;" id="data/histograms.md_working_6.datrdf">The CUSTOM action with label <b>rdf</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">rdf</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_6.datrdf_vrdf">rdf_vrdf</b>,<b name="data/histograms.md_working_6.datrdf_vol">rdf_vol</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y/(1000*1000)
<span style="color:blue"># --- End of included input --- </span></span><span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the grid that you would like to output<i></i></span></span>=<b name="data/histograms.md_working_6.datrdf">rdf</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=10
</pre>
 {% endraw %} 

Notice that what is output here is the instantaneous RDF.  If you want to compute a time average of the RDF you need to use suitable accumulate actions as described in previous sections.

The RDF was implemented in order to add the [entropy CV](https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.119.015701) that was developed by Piaggi and Parrinello.  This CV computes a Kulbeck-Leibler divergence and thus operates like the CVs described at the end of the previous section.  There is a shortcut to this action to which can be called using the following input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_7.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_7.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_7.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/histograms.md_working_7.datpp_short"><span id="data/histograms.md_working_7.datdefpp_short"><b name="data/histograms.md_working_7.datpp" onclick='showPath("data/histograms.md_working_7.dat","data/histograms.md_working_7.datpp","data/histograms.md_working_7.datpp_shortcut","black")'>pp</b><span style="display:none;" id="data/histograms.md_working_7.datpp_shortcut">The PAIRENTROPY action with label <b>pp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">pp</td><td width="5%"><font color="black">scalar</font></td><td>the KL-entropy that is computed from the radial distribution function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">PAIRENTROPY<span class="right">Calculate the KL Entropy from the radial distribution function This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_7.datpp");'>a shortcut</a> and it has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_7.datdefpp");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/PAIRENTROPY">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">the atoms that are being used to calculate the RDF<i></i></span></span>=1-108 <span class="plumedtooltip">MAXR<span class="right">the maximum distance to use for the rdf<i></i></span></span>=2.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins to use when computing the RDF<i></i></span></span>=20 <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=1.5 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.13
</span><span id="data/histograms.md_working_7.datdefpp_long" style="display:none;"><b name="data/histograms.md_working_7.datpp" onclick='showPath("data/histograms.md_working_7.dat","data/histograms.md_working_7.datpp","data/histograms.md_working_7.datpp_shortcut","black")'>pp</b>: <span class="plumedtooltip" style="color:green">PAIRENTROPY<span class="right">Calculate the KL Entropy from the radial distribution function This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_7.datpp");'>a shortcut</a> and uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_7.datdefpp");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/PAIRENTROPY">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">the atoms that are being used to calculate the RDF<i></i></span></span>=1-108 <span class="plumedtooltip">MAXR<span class="right">the maximum distance to use for the rdf<i></i></span></span>=2.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins to use when computing the RDF<i></i></span></span>=20 <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=1.5 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.13  <span class="plumedtooltip">SIGMA<span class="right"> an alternative method for specifying the bandwidth instead of using the BANDWIDTH keyword<i></i></span></span>=use <span class="plumedtooltip">bandwidth<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>
</span></span><span id="data/histograms.md_working_7.datpp_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/histograms.md_working_7.datpp")'># pp: PAIRENTROPY GROUP=1-108 MAXR=2.0 GRID_BIN=20 CUTOFF=1.5 BANDWIDTH=0.13</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/histograms.md_working_7.datpp_rdf" onclick='showPath("data/histograms.md_working_7.dat","data/histograms.md_working_7.datpp_rdf","data/histograms.md_working_7.datpp_rdf","green")'>pp_rdf</b><span style="display:none;" id="data/histograms.md_working_7.datpp_rdf">The CUSTOM action with label <b>pp_rdf</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">pp_rdf</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">RDF<span class="right">Calculate the radial distribution function <a href="https://www.plumed.org/doc-master/user-doc/html/RDF" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">the atoms that are being used to calculate the RDF<i></i></span></span>=1-108 <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=1.5 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins to use when computing the RDF<i></i></span></span>=20 <span class="plumedtooltip">MAXR<span class="right">the maximum distance to use for the rdf<i></i></span></span>=2.0 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.13 
<b name="data/histograms.md_working_7.datpp_conv_t1" onclick='showPath("data/histograms.md_working_7.dat","data/histograms.md_working_7.datpp_conv_t1","data/histograms.md_working_7.datpp_conv_t1","green")'>pp_conv_t1</b><span style="display:none;" id="data/histograms.md_working_7.datpp_conv_t1">The CUSTOM action with label <b>pp_conv_t1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">pp_conv_t1</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_7.datpp_rdf">pp_rdf</b>,pp_rdf_x2 <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y*log(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_7.datpp_conv_t2" onclick='showPath("data/histograms.md_working_7.dat","data/histograms.md_working_7.datpp_conv_t2","data/histograms.md_working_7.datpp_conv_t2","green")'>pp_conv_t2</b><span style="display:none;" id="data/histograms.md_working_7.datpp_conv_t2">The CUSTOM action with label <b>pp_conv_t2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">pp_conv_t2</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_7.datpp_rdf">pp_rdf</b>,pp_rdf_x2 <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=(1-x)*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_7.datpp_conv" onclick='showPath("data/histograms.md_working_7.dat","data/histograms.md_working_7.datpp_conv","data/histograms.md_working_7.datpp_conv","green")'>pp_conv</b><span style="display:none;" id="data/histograms.md_working_7.datpp_conv">The CUSTOM action with label <b>pp_conv</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">pp_conv</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_7.datpp_conv_t1">pp_conv_t1</b>,<b name="data/histograms.md_working_7.datpp_conv_t2">pp_conv_t2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x+y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_7.datpp_midp" onclick='showPath("data/histograms.md_working_7.dat","data/histograms.md_working_7.datpp_midp","data/histograms.md_working_7.datpp_midp","green")'>pp_midp</b><span style="display:none;" id="data/histograms.md_working_7.datpp_midp">The INTERPOLATE_GRID action with label <b>pp_midp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">pp_midp</td><td width="5%"><font color="green">grid</font></td><td>the function evaluated onto the interpolated grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">INTERPOLATE_GRID<span class="right">Interpolate a smooth function stored on a grid onto a grid with a smaller grid spacing. <a href="https://www.plumed.org/doc-master/user-doc/html/INTERPOLATE_GRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for function on the grid that you would like to interpolate<i></i></span></span>=<b name="data/histograms.md_working_7.datpp_conv">pp_conv</b> <span class="plumedtooltip">INTERPOLATION_TYPE<span class="right"> the method to use for interpolation<i></i></span></span>=linear <span class="plumedtooltip">MIDPOINTS<span class="right"> interpolate the values of the function at the midpoints of the grid coordinates of the input grid<i></i></span></span>
<b name="data/histograms.md_working_7.datpp_int" onclick='showPath("data/histograms.md_working_7.dat","data/histograms.md_working_7.datpp_int","data/histograms.md_working_7.datpp_int","black")'>pp_int</b><span style="display:none;" id="data/histograms.md_working_7.datpp_int">The CUSTOM action with label <b>pp_int</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">pp_int</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">INTEGRATE_GRID<span class="right">Calculate the numerical integral of the function stored on the grid <a href="https://www.plumed.org/doc-master/user-doc/html/INTEGRATE_GRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the function on a grid that is being integrated<i></i></span></span>=<b name="data/histograms.md_working_7.datpp_midp">pp_midp</b> <span class="plumedtooltip">PERIODIC<span class="right">if the value of the output integral has a periodid domain then you use this keyword to specify the periodicity<i></i></span></span>=NO
<b name="data/histograms.md_working_7.datpp" onclick='showPath("data/histograms.md_working_7.dat","data/histograms.md_working_7.datpp","data/histograms.md_working_7.datpp","black")'>pp</b><span style="display:none;" id="data/histograms.md_working_7.datpp">The CUSTOM action with label <b>pp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">pp</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_7.datpp_int">pp_int</b>,pp_rdf_vol <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=-(2*pi*x/y)*108
<span style="color:blue"># --- End of included input --- </span></span></pre>
 {% endraw %} 

If you implement this (and the related PAIRENTROPIES) shortcuts in a single action you may get better performance.  I believe these implementations that use shortcuts provide a useful reference values for these CVs and our easy to maintain.  They are a useful start point for anyone building code to use such a CV in a production calculation.

## Histograms and replicas

If you are running a simulation with four replicas you can construct a histogram using all the data from the replicas by using an input like the one shown below:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_8.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_8.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_8.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment">#SETTINGS NREPLICAS=2</span>
<b name="data/histograms.md_working_8.datd1" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.datd1","data/histograms.md_working_8.datd1","black")'>d1</b><span style="display:none;" id="data/histograms.md_working_8.datd1">The DISTANCE action with label <b>d1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">d1</td><td width="5%"><font color="black">scalar</font></td><td>the DISTANCE between this pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,2
<b name="data/histograms.md_working_8.datd1c" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.datd1c","data/histograms.md_working_8.datd1c","black")'>d1c</b><span style="display:none;" id="data/histograms.md_working_8.datd1c">The GATHER_REPLICAS action with label <b>d1c</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">d1c.rep-1</td><td width="5%"><font color="black">scalar</font></td><td>the input arguments for each of the replicas  This is the 1th of these quantities</td></tr><tr><td width="5%">d1c.rep-2</td><td width="5%"><font color="black">scalar</font></td><td>the input arguments for each of the replicas  This is the 2th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GATHER_REPLICAS<span class="right">Create a vector that contains the copies of the input quantities from all replicas <a href="https://www.plumed.org/doc-master/user-doc/html/GATHER_REPLICAS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the argument from the various replicas that you would like to gather<i></i></span></span>=<b name="data/histograms.md_working_8.datd1">d1</b>
<b name="data/histograms.md_working_8.datd1v" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.datd1v","data/histograms.md_working_8.datd1v","blue")'>d1v</b><span style="display:none;" id="data/histograms.md_working_8.datd1v">The CONCATENATE action with label <b>d1v</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">d1v</td><td width="5%"><font color="blue">vector</font></td><td>the concatenated vector/matrix that was constructed from the input values</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONCATENATE<span class="right">Join vectors or matrices together <a href="https://www.plumed.org/doc-master/user-doc/html/CONCATENATE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that should be concatenated together to form the output vector<i></i></span></span>=<b name="data/histograms.md_working_8.datd1c">d1c.*</b>
<span id="data/histograms.md_working_8.datdefwh_short"><b name="data/histograms.md_working_8.datwh" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.datwh","data/histograms.md_working_8.datwh","blue")'>wh</b><span style="display:none;" id="data/histograms.md_working_8.datwh">The CONSTANT action with label <b>wh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">wh</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_8.datdefwh");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=0.25,0.25
</span><span id="data/histograms.md_working_8.datdefwh_long" style="display:none;"><b name="data/histograms.md_working_8.datwh" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.datwh","data/histograms.md_working_8.datwh","blue")'>wh</b>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_8.datdefwh");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=0.25,0.25  <span class="plumedtooltip">NROWS<span class="right"> the number of rows in your input matrix<i></i></span></span>=0 <span class="plumedtooltip">NCOLS<span class="right"> the number of columns in your matrix<i></i></span></span>=0
</span><span id="data/histograms.md_working_8.datdefhA_weight_short"><b name="data/histograms.md_working_8.dathA_weight" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.dathA_weight","data/histograms.md_working_8.dathA_weight","black")'>hA_weight</b><span style="display:none;" id="data/histograms.md_working_8.dathA_weight">The CONSTANT action with label <b>hA_weight</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_weight</td><td width="5%"><font color="black">scalar</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_8.datdefhA_weight");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1
</span><span id="data/histograms.md_working_8.datdefhA_weight_long" style="display:none;"><b name="data/histograms.md_working_8.dathA_weight" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.dathA_weight","data/histograms.md_working_8.dathA_weight","black")'>hA_weight</b>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_8.datdefhA_weight");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1  <span class="plumedtooltip">NROWS<span class="right"> the number of rows in your input matrix<i></i></span></span>=0 <span class="plumedtooltip">NCOLS<span class="right"> the number of columns in your matrix<i></i></span></span>=0
</span><span id="data/histograms.md_working_8.datdefhA_kde_short"><b name="data/histograms.md_working_8.dathA_kde" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.dathA_kde","data/histograms.md_working_8.dathA_kde","green")'>hA_kde</b><span style="display:none;" id="data/histograms.md_working_8.dathA_kde">The KDE action with label <b>hA_kde</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kde</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_8.datdefhA_kde");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_8.datd1v">d1v</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">VOLUMES<span class="right">this keyword take the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_8.datwh">wh</b> <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1
</span><span id="data/histograms.md_working_8.datdefhA_kde_long" style="display:none;"><b name="data/histograms.md_working_8.dathA_kde" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.dathA_kde","data/histograms.md_working_8.dathA_kde","green")'>hA_kde</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_8.datdefhA_kde");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_8.datd1v">d1v</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">VOLUMES<span class="right">this keyword take the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_8.datwh">wh</b> <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span><b name="data/histograms.md_working_8.dathA_kdep" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.dathA_kdep","data/histograms.md_working_8.dathA_kdep","green")'>hA_kdep</b><span style="display:none;" id="data/histograms.md_working_8.dathA_kdep">The CUSTOM action with label <b>hA_kdep</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kdep</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_8.dathA_kde">hA_kde</b>,<b name="data/histograms.md_working_8.dathA_weight">hA_weight</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span id="data/histograms.md_working_8.datdefhA_u_short"><b name="data/histograms.md_working_8.dathA_u" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.dathA_u","data/histograms.md_working_8.dathA_u","green")'>hA_u</b><span style="display:none;" id="data/histograms.md_working_8.dathA_u">The ACCUMULATE action with label <b>hA_u</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_u</td><td width="5%"><font color="green">grid</font></td><td>a sum calculated from the time series of the input quantity</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_8.datdefhA_u");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_8.dathA_kdep">hA_kdep</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1
</span><span id="data/histograms.md_working_8.datdefhA_u_long" style="display:none;"><b name="data/histograms.md_working_8.dathA_u" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.dathA_u","data/histograms.md_working_8.dathA_u","green")'>hA_u</b>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_8.datdefhA_u");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_8.dathA_kdep">hA_kdep</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1  <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear all the accumulated data<i></i></span></span>=0
</span><span id="data/histograms.md_working_8.datdefhA_nsum_short"><b name="data/histograms.md_working_8.dathA_nsum" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.dathA_nsum","data/histograms.md_working_8.dathA_nsum","black")'>hA_nsum</b><span style="display:none;" id="data/histograms.md_working_8.dathA_nsum">The ACCUMULATE action with label <b>hA_nsum</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_nsum</td><td width="5%"><font color="black">scalar</font></td><td>a sum calculated from the time series of the input quantity</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_8.datdefhA_nsum");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_8.dathA_weight">hA_weight</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1
</span><span id="data/histograms.md_working_8.datdefhA_nsum_long" style="display:none;"><b name="data/histograms.md_working_8.dathA_nsum" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.dathA_nsum","data/histograms.md_working_8.dathA_nsum","black")'>hA_nsum</b>: <span class="plumedtooltip" style="color:green">ACCUMULATE<span class="right">Sum the elements of this value over the course of the trajectory This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_8.datdefhA_nsum");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ACCUMULATE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the argument that is being added to on each timestep<i></i></span></span>=<b name="data/histograms.md_working_8.dathA_weight">hA_weight</b> <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the data should be collected and added to the quantity being averaged<i></i></span></span>=1  <span class="plumedtooltip">CLEAR<span class="right"> the frequency with which to clear all the accumulated data<i></i></span></span>=0
</span><b name="data/histograms.md_working_8.dathA" onclick='showPath("data/histograms.md_working_8.dat","data/histograms.md_working_8.dathA","data/histograms.md_working_8.dathA","green")'>hA</b><span style="display:none;" id="data/histograms.md_working_8.dathA">The CUSTOM action with label <b>hA</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_8.dathA_u">hA_u</b>,<b name="data/histograms.md_working_8.dathA_nsum">hA_nsum</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the grid that you would like to output<i></i></span></span>=<b name="data/histograms.md_working_8.dathA">hA</b> <span class="plumedtooltip">FILE<span class="right"> the file on which to write the grid<i></i></span></span>=histo <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=1
</pre>
 {% endraw %} 

Notice how the GATHER_REPLICAS and CONCATENATE actions are used here to transfer the data on each replica to a four dimensional vector that can be used in the input for KDE.  Notice, furthermore, that by using the VOLUMES/HEIGHTS keyword of KDE we can ascribe weights to the data from each replica.
These weights can be used to do any reweighting to take account of different conditions that might be used with different replicas.

## Spatial averages

Over the last few years researchers from Michele's group and I wrote functionality in PLUMED for [this paper]() on the capiliary fluctuation method and [this one]() on determining the shape of a nucleating solid.  These papers made use of an action called MULTICOLVARDENS that built a continuous representation for the average
value of some atom-based order parameter at each point in the simulation cell.  With the new version of PLUMED there is no need to implement a second MULTICOLVARDENS action as you can calculate these fields by using the KDE command directly as shown below:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_9.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_9.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_9.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/histograms.md_working_9.datdeff_short"><b name="data/histograms.md_working_9.datf" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datf","data/histograms.md_working_9.datf","violet")'>f</b><span style="display:none;" id="data/histograms.md_working_9.datf">The FIXEDATOM action with label <b>f</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">f</td><td width="5%"><font color="violet">atoms</font></td><td>virtual atom calculated by FIXEDATOM action</td></tr></table></span>: <span class="plumedtooltip" style="color:green">FIXEDATOM<span class="right">Add a virtual atom in a fixed position. This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_9.datdeff");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/FIXEDATOM">More details</a><i></i></span></span> <span class="plumedtooltip">AT<span class="right">coordinates of the virtual atom<i></i></span></span>=0,0,0
</span><span id="data/histograms.md_working_9.datdeff_long" style="display:none;"><b name="data/histograms.md_working_9.datf" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datf","data/histograms.md_working_9.datf","violet")'>f</b>: <span class="plumedtooltip" style="color:green">FIXEDATOM<span class="right">Add a virtual atom in a fixed position. This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_9.datdeff");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/FIXEDATOM">More details</a><i></i></span></span> <span class="plumedtooltip">AT<span class="right">coordinates of the virtual atom<i></i></span></span>=0,0,0  <span class="plumedtooltip">SET_MASS<span class="right"> mass of the virtual atom<i></i></span></span>=1 <span class="plumedtooltip">SET_CHARGE<span class="right"> charge of the virtual atom<i></i></span></span>=0
</span><span id="data/histograms.md_working_9.datc1_short"><b name="data/histograms.md_working_9.datc1" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datc1","data/histograms.md_working_9.datc1_shortcut","blue")'>c1</b><span style="display:none;" id="data/histograms.md_working_9.datc1_shortcut">The COORDINATIONNUMBER action with label <b>c1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1</td><td width="5%"><font color="blue">vector</font></td><td>the coordination numbers of the specified atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COORDINATIONNUMBER<span class="right">Calculate the coordination numbers of atoms so that you can then calculate functions of the distribution of This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_9.datc1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/COORDINATIONNUMBER">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL R_0=0.1}
</span><span id="data/histograms.md_working_9.datc1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/histograms.md_working_9.datc1")'># c1: COORDINATIONNUMBER SPECIES=1-100 SWITCH={RATIONAL R_0=0.1}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/histograms.md_working_9.datc1_grp" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datc1_grp","data/histograms.md_working_9.datc1_grp","violet")'>c1_grp</b><span style="display:none;" id="data/histograms.md_working_9.datc1_grp">The GROUP action with label <b>c1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=1-100
<b name="data/histograms.md_working_9.datc1_mat" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datc1_mat","data/histograms.md_working_9.datc1_mat","red")'>c1_mat</b><span style="display:none;" id="data/histograms.md_working_9.datc1_mat">The CONTACT_MATRIX action with label <b>c1_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1_mat</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL R_0=0.1}
<b name="data/histograms.md_working_9.datc1_ones" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datc1_ones","data/histograms.md_working_9.datc1_ones","blue")'>c1_ones</b><span style="display:none;" id="data/histograms.md_working_9.datc1_ones">The CONSTANT action with label <b>c1_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/histograms.md_working_9.datc1" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datc1","data/histograms.md_working_9.datc1","blue")'>c1</b><span style="display:none;" id="data/histograms.md_working_9.datc1">The MATRIX_VECTOR_PRODUCT action with label <b>c1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span>  <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/histograms.md_working_9.datc1_mat">c1_mat</b>,<b name="data/histograms.md_working_9.datc1_ones">c1_ones</b>
<span style="color:blue"># --- End of included input --- </span></span><span id="data/histograms.md_working_9.datd1_short"><b name="data/histograms.md_working_9.datd1" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datd1","data/histograms.md_working_9.datd1","blue")'>d1</b><span style="display:none;" id="data/histograms.md_working_9.datd1">The DISTANCE action with label <b>d1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">d1.x</td><td width="5%"><font color="blue">vector</font></td><td>the x-component of the vector connecting the two atoms</td></tr><tr><td width="5%">d1.y</td><td width="5%"><font color="blue">vector</font></td><td>the y-component of the vector connecting the two atoms</td></tr><tr><td width="5%">d1.z</td><td width="5%"><font color="blue">vector</font></td><td>the z-component of the vector connecting the two atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCES<span class="right">Calculate the distances between multiple piars of atoms This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_9.datd1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCES">More details</a><i></i></span></span> <span class="plumedtooltip">COMPONENTS<span class="right"> calculate the x, y and z components of the distance separately and store them as label<i></i></span></span> <span class="plumedtooltip">ORIGIN<span class="right">calculate the distance of all the atoms specified using the ATOMS keyword from this point<i></i></span></span>=<b name="data/histograms.md_working_9.datf">f</b> <span class="plumedtooltip">ATOMS<span class="right">the pairs of atoms that you would like to calculate the angles for<i></i></span></span>=1-100
</span><span id="data/histograms.md_working_9.datd1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/histograms.md_working_9.datd1")'># d1: DISTANCES COMPONENTS ORIGIN=f ATOMS=1-100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/histograms.md_working_9.datd1" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datd1","data/histograms.md_working_9.datd1","blue")'>d1</b>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">COMPONENTS<span class="right"> calculate the x, y and z components of the distance separately and store them as label<i></i></span></span> <span class="plumedtooltip">ATOMS1<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=<b name="data/histograms.md_working_9.datf">f</b>,1 <span class="plumedtooltip">ATOMS2<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=<b name="data/histograms.md_working_9.datf">f</b>,2 <span class="plumedtooltip">ATOMS3<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=<b name="data/histograms.md_working_9.datf">f</b>,3 <span class="plumedtooltip">ATOMS4<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=<b name="data/histograms.md_working_9.datf">f</b>,4 <span class="plumedtooltip">ATOMS5<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=<b name="data/histograms.md_working_9.datf">f</b>,5     <span style="color:blue" class="comment"># Action input conctinues with 95 further ATOMSn keywords, </span>
<span style="color:blue"># --- End of included input --- </span></span><span id="data/histograms.md_working_9.datdefp_numer_short"><b name="data/histograms.md_working_9.datp_numer" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datp_numer","data/histograms.md_working_9.datp_numer","green")'>p_numer</b><span style="display:none;" id="data/histograms.md_working_9.datp_numer">The KDE action with label <b>p_numer</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">p_numer</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_9.datdefp_numer");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">VOLUMES<span class="right">this keyword take the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_9.datc1">c1</b> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_9.datd1">d1.x</b>,<b name="data/histograms.md_working_9.datd1">d1.y</b>,<b name="data/histograms.md_working_9.datd1">d1.z</b> <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100,100,100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1,0.1,0.1
</span><span id="data/histograms.md_working_9.datdefp_numer_long" style="display:none;"><b name="data/histograms.md_working_9.datp_numer" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datp_numer","data/histograms.md_working_9.datp_numer","green")'>p_numer</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_9.datdefp_numer");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">VOLUMES<span class="right">this keyword take the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_9.datc1">c1</b> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_9.datd1">d1.x</b>,<b name="data/histograms.md_working_9.datd1">d1.y</b>,<b name="data/histograms.md_working_9.datd1">d1.z</b> <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100,100,100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1,0.1,0.1  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=auto,auto,auto <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=auto,auto,auto <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span><span id="data/histograms.md_working_9.datdefp_denom_short"><b name="data/histograms.md_working_9.datp_denom" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datp_denom","data/histograms.md_working_9.datp_denom","green")'>p_denom</b><span style="display:none;" id="data/histograms.md_working_9.datp_denom">The KDE action with label <b>p_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">p_denom</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_9.datdefp_denom");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_9.datd1">d1.x</b>,<b name="data/histograms.md_working_9.datd1">d1.y</b>,<b name="data/histograms.md_working_9.datd1">d1.z</b> <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100,100,100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1,0.1,0.1
</span><span id="data/histograms.md_working_9.datdefp_denom_long" style="display:none;"><b name="data/histograms.md_working_9.datp_denom" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datp_denom","data/histograms.md_working_9.datp_denom","green")'>p_denom</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_9.datdefp_denom");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_9.datd1">d1.x</b>,<b name="data/histograms.md_working_9.datd1">d1.y</b>,<b name="data/histograms.md_working_9.datd1">d1.z</b> <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100,100,100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1,0.1,0.1  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=auto,auto,auto <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=auto,auto,auto <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span><b name="data/histograms.md_working_9.datp" onclick='showPath("data/histograms.md_working_9.dat","data/histograms.md_working_9.datp","data/histograms.md_working_9.datp","green")'>p</b><span style="display:none;" id="data/histograms.md_working_9.datp">The CUSTOM action with label <b>p</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">p</td><td width="5%"><font color="green">grid</font></td><td>the grid obtained by doing an element-wise application of an arbitrary function to the input grid</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_9.datp_numer">p_numer</b>,<b name="data/histograms.md_working_9.datp_denom">p_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span class="plumedtooltip" style="color:green">DUMPGRID<span class="right">Output the function on the grid to a file with the PLUMED grid format. <a href="https://www.plumed.org/doc-master/user-doc/html/DUMPGRID" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the grid that you would like to output<i></i></span></span>=<b name="data/histograms.md_working_9.datp">p</b> <span class="plumedtooltip">FILE<span class="right"> the file on which to write the grid<i></i></span></span>=dens <span class="plumedtooltip">STRIDE<span class="right"> the frequency with which the grid should be output to the file<i></i></span></span>=1
</pre>
 {% endraw %} 

I hope what is beign calculated here is clear from the syntax above.  Notice, furthermore, that if one wants to compute the average over multiple frames you can accumulate the grids with labels p_numer and p_denom.  On steps where the average of the function is desired you can then compute the ratio of the two grids with CUSTOM.

Notice lastly that this input can also be used to calculate the conditional average of a CV as a function of another CV.  In other words, you can use inputs like the one above to calculate the average value of $s$ when some other CV has a fixed value as is discussed in [this paper]().

## Weights, volumes and normalisation

I hope the examples in the previous sections have demonstrated the flexibility of this new implementation of the histogram in PLUMED.  When designing the syntax for this implementation I have tried to ensure that users can control all aspects of making the histogram. In other words, 
I am trying not to force them to make decisions about the way in which the histogram is constructed.  Furthermore, when I have made decisions I have tried to make the log provide information on the decisions that have been made and there is a way for the user to control those decisions.  My reason for 
desining the code in this way is that I have learned from experience that users will often want histograms that are normalised in different ways.  I thus wanted to avoid writing code that forced the histogram to have a particular normalisation.  Really I want the user to decide how (or if) to normalise
their histogram.

One issue that I think has caused some confusion, and that is worth explaining, is whether the Gaussians that are added when you do KDE have a height of 1 or a volume of one.  The default in PLUMED if you use an input like this one:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_10.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_10.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_10.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<b name="data/histograms.md_working_10.datx" onclick='showPath("data/histograms.md_working_10.dat","data/histograms.md_working_10.datx","data/histograms.md_working_10.datx","black")'>x</b><span style="display:none;" id="data/histograms.md_working_10.datx">The DISTANCE action with label <b>x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">x</td><td width="5%"><font color="black">scalar</font></td><td>the DISTANCE between this pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,2
<span id="data/histograms.md_working_10.datdefhA_kde_short"><b name="data/histograms.md_working_10.dathA_kde" onclick='showPath("data/histograms.md_working_10.dat","data/histograms.md_working_10.dathA_kde","data/histograms.md_working_10.dathA_kde","green")'>hA_kde</b><span style="display:none;" id="data/histograms.md_working_10.dathA_kde">The KDE action with label <b>hA_kde</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kde</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_10.datdefhA_kde");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_10.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1
</span><span id="data/histograms.md_working_10.datdefhA_kde_long" style="display:none;"><b name="data/histograms.md_working_10.dathA_kde" onclick='showPath("data/histograms.md_working_10.dat","data/histograms.md_working_10.dathA_kde","data/histograms.md_working_10.dathA_kde","green")'>hA_kde</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_10.datdefhA_kde");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_10.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span></pre>
 {% endraw %} 

Is that the volume of the added Gaussian is one.  If you want the height of the Gaussian to be one you would write:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_11.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_11.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_11.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/histograms.md_working_11.datdefone_short"><b name="data/histograms.md_working_11.datone" onclick='showPath("data/histograms.md_working_11.dat","data/histograms.md_working_11.datone","data/histograms.md_working_11.datone","black")'>one</b><span style="display:none;" id="data/histograms.md_working_11.datone">The CONSTANT action with label <b>one</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">one</td><td width="5%"><font color="black">scalar</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_11.datdefone");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUE<span class="right">the single number that you would like to store<i></i></span></span>=1
</span><span id="data/histograms.md_working_11.datdefone_long" style="display:none;"><b name="data/histograms.md_working_11.datone" onclick='showPath("data/histograms.md_working_11.dat","data/histograms.md_working_11.datone","data/histograms.md_working_11.datone","black")'>one</b>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_11.datdefone");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUE<span class="right">the single number that you would like to store<i></i></span></span>=1  <span class="plumedtooltip">NROWS<span class="right"> the number of rows in your input matrix<i></i></span></span>=0 <span class="plumedtooltip">NCOLS<span class="right"> the number of columns in your matrix<i></i></span></span>=0
</span><b name="data/histograms.md_working_11.datx" onclick='showPath("data/histograms.md_working_11.dat","data/histograms.md_working_11.datx","data/histograms.md_working_11.datx","black")'>x</b><span style="display:none;" id="data/histograms.md_working_11.datx">The DISTANCE action with label <b>x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">x</td><td width="5%"><font color="black">scalar</font></td><td>the DISTANCE between this pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,2
<span id="data/histograms.md_working_11.datdefhA_kde_short"><b name="data/histograms.md_working_11.dathA_kde" onclick='showPath("data/histograms.md_working_11.dat","data/histograms.md_working_11.dathA_kde","data/histograms.md_working_11.dathA_kde","green")'>hA_kde</b><span style="display:none;" id="data/histograms.md_working_11.dathA_kde">The KDE action with label <b>hA_kde</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kde</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_11.datdefhA_kde");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_11.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1 <span class="plumedtooltip">HEIGHTS<span class="right">this keyword takes the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_11.datone">one</b>
</span><span id="data/histograms.md_working_11.datdefhA_kde_long" style="display:none;"><b name="data/histograms.md_working_11.dathA_kde" onclick='showPath("data/histograms.md_working_11.dat","data/histograms.md_working_11.dathA_kde","data/histograms.md_working_11.dathA_kde","green")'>hA_kde</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_11.datdefhA_kde");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_11.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1 <span class="plumedtooltip">HEIGHTS<span class="right">this keyword takes the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_11.datone">one</b>  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span></pre>
 {% endraw %} 

You can also set the volumes of the added kernels to a value other than one by doing:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_12.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_12.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_12.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/histograms.md_working_12.datdeff_short"><b name="data/histograms.md_working_12.datf" onclick='showPath("data/histograms.md_working_12.dat","data/histograms.md_working_12.datf","data/histograms.md_working_12.datf","black")'>f</b><span style="display:none;" id="data/histograms.md_working_12.datf">The CONSTANT action with label <b>f</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">f</td><td width="5%"><font color="black">scalar</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_12.datdeff");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUE<span class="right">the single number that you would like to store<i></i></span></span>=4
</span><span id="data/histograms.md_working_12.datdeff_long" style="display:none;"><b name="data/histograms.md_working_12.datf" onclick='showPath("data/histograms.md_working_12.dat","data/histograms.md_working_12.datf","data/histograms.md_working_12.datf","black")'>f</b>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_12.datdeff");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUE<span class="right">the single number that you would like to store<i></i></span></span>=4  <span class="plumedtooltip">NROWS<span class="right"> the number of rows in your input matrix<i></i></span></span>=0 <span class="plumedtooltip">NCOLS<span class="right"> the number of columns in your matrix<i></i></span></span>=0
</span><b name="data/histograms.md_working_12.datx" onclick='showPath("data/histograms.md_working_12.dat","data/histograms.md_working_12.datx","data/histograms.md_working_12.datx","black")'>x</b><span style="display:none;" id="data/histograms.md_working_12.datx">The DISTANCE action with label <b>x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">x</td><td width="5%"><font color="black">scalar</font></td><td>the DISTANCE between this pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,2
<span id="data/histograms.md_working_12.datdefhA_kde_short"><b name="data/histograms.md_working_12.dathA_kde" onclick='showPath("data/histograms.md_working_12.dat","data/histograms.md_working_12.dathA_kde","data/histograms.md_working_12.dathA_kde","green")'>hA_kde</b><span style="display:none;" id="data/histograms.md_working_12.dathA_kde">The KDE action with label <b>hA_kde</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kde</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_12.datdefhA_kde");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_12.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1 <span class="plumedtooltip">VOLUMES<span class="right">this keyword take the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_12.datf">f</b>
</span><span id="data/histograms.md_working_12.datdefhA_kde_long" style="display:none;"><b name="data/histograms.md_working_12.dathA_kde" onclick='showPath("data/histograms.md_working_12.dat","data/histograms.md_working_12.dathA_kde","data/histograms.md_working_12.dathA_kde","green")'>hA_kde</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_12.datdefhA_kde");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_12.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1 <span class="plumedtooltip">VOLUMES<span class="right">this keyword take the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_12.datf">f</b>  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span></pre>
 {% endraw %} 

This input is, however, just a shortcut that is equivalent to the following longer input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/histograms.md_working_13.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="histograms.md_working_13.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="histograms.md_working_13.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/histograms.md_working_13.datdeff_short"><b name="data/histograms.md_working_13.datf" onclick='showPath("data/histograms.md_working_13.dat","data/histograms.md_working_13.datf","data/histograms.md_working_13.datf","black")'>f</b><span style="display:none;" id="data/histograms.md_working_13.datf">The CONSTANT action with label <b>f</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">f</td><td width="5%"><font color="black">scalar</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_13.datdeff");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUE<span class="right">the single number that you would like to store<i></i></span></span>=4
</span><span id="data/histograms.md_working_13.datdeff_long" style="display:none;"><b name="data/histograms.md_working_13.datf" onclick='showPath("data/histograms.md_working_13.dat","data/histograms.md_working_13.datf","data/histograms.md_working_13.datf","black")'>f</b>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_13.datdeff");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT">More details</a><i></i></span></span> <span class="plumedtooltip">VALUE<span class="right">the single number that you would like to store<i></i></span></span>=4  <span class="plumedtooltip">NROWS<span class="right"> the number of rows in your input matrix<i></i></span></span>=0 <span class="plumedtooltip">NCOLS<span class="right"> the number of columns in your matrix<i></i></span></span>=0
</span><b name="data/histograms.md_working_13.datfh" onclick='showPath("data/histograms.md_working_13.dat","data/histograms.md_working_13.datfh","data/histograms.md_working_13.datfh","black")'>fh</b><span style="display:none;" id="data/histograms.md_working_13.datfh">The CUSTOM action with label <b>fh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">fh</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/histograms.md_working_13.datf">f</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/(sqrt(2*pi)*0.1) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/histograms.md_working_13.datx" onclick='showPath("data/histograms.md_working_13.dat","data/histograms.md_working_13.datx","data/histograms.md_working_13.datx","black")'>x</b><span style="display:none;" id="data/histograms.md_working_13.datx">The DISTANCE action with label <b>x</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">x</td><td width="5%"><font color="black">scalar</font></td><td>the DISTANCE between this pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DISTANCE<span class="right">Calculate the distance/s between pairs of atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/DISTANCE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the pair of atom that we are calculating the distance between<i></i></span></span>=1,2
<span id="data/histograms.md_working_13.datdefhA_kde_short"><b name="data/histograms.md_working_13.dathA_kde" onclick='showPath("data/histograms.md_working_13.dat","data/histograms.md_working_13.dathA_kde","data/histograms.md_working_13.dathA_kde","green")'>hA_kde</b><span style="display:none;" id="data/histograms.md_working_13.dathA_kde">The KDE action with label <b>hA_kde</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">hA_kde</td><td width="5%"><font color="green">grid</font></td><td>a function on a grid that was obtained by doing a Kernel Density Estimation using the input arguments</td></tr></table></span>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_13.datdefhA_kde");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_13.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1 <span class="plumedtooltip">HEIGHTS<span class="right">this keyword takes the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_13.datfh">fh</b>
</span><span id="data/histograms.md_working_13.datdefhA_kde_long" style="display:none;"><b name="data/histograms.md_working_13.dathA_kde" onclick='showPath("data/histograms.md_working_13.dat","data/histograms.md_working_13.dathA_kde","data/histograms.md_working_13.dathA_kde","green")'>hA_kde</b>: <span class="plumedtooltip" style="color:green">KDE<span class="right">Create a histogram from the input scalar/vector/matrix using KDE This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/histograms.md_working_13.datdefhA_kde");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/KDE">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the value that should be used to construct the histogram<i></i></span></span>=<b name="data/histograms.md_working_13.datx">x</b> <span class="plumedtooltip">GRID_MIN<span class="right"> the lower bounds for the grid<i></i></span></span>=0.0 <span class="plumedtooltip">GRID_MAX<span class="right"> the upper bounds for the grid<i></i></span></span>=3.0 <span class="plumedtooltip">GRID_BIN<span class="right">the number of bins for the grid<i></i></span></span>=100 <span class="plumedtooltip">BANDWIDTH<span class="right">the bandwidths for kernel density esimtation<i></i></span></span>=0.1 <span class="plumedtooltip">HEIGHTS<span class="right">this keyword takes the label of an action that calculates a vector of values<i></i></span></span>=<b name="data/histograms.md_working_13.datfh">fh</b>  <span class="plumedtooltip">KERNEL<span class="right"> the kernel function you are using<i></i></span></span>=GAUSSIAN <span class="plumedtooltip">CUTOFF<span class="right"> the cutoff at which to stop evaluating the kernel functions is set equal to sqrt(2*x)*bandwidth in each direction where x is this number<i></i></span></span>=6.25
</span></pre>
 {% endraw %} 

In conclusion, and if in doubt, you can always control the height of the maximum in the added Gaussian by using the HEIGHTS keyword. 
