# Steinhardt parameters in PLUMED

The Steinhardt parameters are arguably some of the most complicated collective variables to use in PLUMED. These variables are difficult to use
because researchers use a variety of subtly different variations on the same basic concept. When you are trying
to reproduce the values quoted in a particular paper you often find that you need to spend time comparing the choices that were made in the paper with the 
choices that have been used in the code you are employing.  To resolve this problem I have tried to use the new shortcut features that I have implemented in 
PLUMED to make the implementation of the Steinhardt parameters in PLUMED a little more transparent.  Hopefully this more transparent and piecemeal implementation
allows users to implement and use all the variations in the literature by modifying the template input files that are generated by the shortcut actions 
that can be used to run the most commonly used Steinhardt variants.

In the following article I will thus explain how the Steinhardt parameters have been implemented and the variety of things that you can do within them.

## Calculating the Steinhardt parameter for a single atom

The Steinhardt parameter is an example of a symmetry function.  In other words, it is a function of the position of the atoms in the first coordination sphere around
a central atom.  If we have a system of $N$ indistinguishable atoms we can thus calculate $N$ separate instances of the Steinhardt parameter.  

Steinhardt parameters are complicated as the [spherical harmonics](https://en.wikipedia.org/wiki/Spherical_harmonics) are used to calculate them. Consequently, 
when we calculate the Steinhardt parameter for atom $i$ we evaluate $(2l + 1)$ complex quntities as follows:

$$
q_{lm}(i) = \frac{\sum_{j \ne i} \sigma(r_{ij})Y_l^m(\theta_{ij},\phi_{ij}) }{ \sum_{j \ne i} \sigma(r_{ij})}
$$  

In this expression the sums run over all the specified atoms. $\sigma(r_{ij})$ is a switching function that acts on the distance, $r_{ij}$, between atom $i$ and atom $j$.
$Y_l^m(\theta_{ij},\phi_{ij})$ is the spherical harmonic, which is a function of the angles $\theta_{ij}$ and $\phi_{ij}$ the vector that connects atom $i$ to atom $j$ 
and the $x$ and $z$ axis of the lab frame respectively.  

We can calculate $q_{lm}(i)$ values for atom 1 in PLUMED using an input like the one shown below.  Here I am using $l=1$ so as to keep the input short.

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_1.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_1.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_1.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the contact matrix between atom 1 and all the other atoms</span>
<b name="data/Steinhardt.md_working_1.datcmat" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datcmat","data/Steinhardt.md_working_1.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_1.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">when you are calculating the adjacency matrix between two sets of atoms this keyword is used to specify the atoms along with the keyword GROUPB<i></i></span></span>=1 <span class="plumedtooltip">GROUPB<span class="right">when you are calculating the adjacency matrix between two sets of atoms this keyword is used to specify the atoms along with the keyword GROUPA<i></i></span></span>=2-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span style="color:blue" class="comment"># Create a vector containing 99 ones</span>
<span id="data/Steinhardt.md_working_1.datones_short"><b name="data/Steinhardt.md_working_1.datones" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datones","data/Steinhardt.md_working_1.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_1.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_1.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=99
</span><span id="data/Steinhardt.md_working_1.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_1.datones")'># ones: ONES SIZE=99</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_1.datones" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datones","data/Steinhardt.md_working_1.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_1.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Calculate the coordination number for atom 1 by multiplying the contact matrix above </span>
<span style="color:blue" class="comment"># by a vector of ones</span>
<b name="data/Steinhardt.md_working_1.datcoord" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datcoord","data/Steinhardt.md_working_1.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_1.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_1.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_1.datones">ones</b>
<span style="color:blue" class="comment"># Evaluate the Y_l^m values for each vector in the first coordination sphere and multiply these </span>
<span style="color:blue" class="comment"># values by \sigma(r_ij).  This action outputs 6 matrices that correspond to the real and imaginary </span>
<span style="color:blue" class="comment"># components of Y^l_m for m values of -1, 0 and +1.</span>
<b name="data/Steinhardt.md_working_1.datsh" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datsh","data/Steinhardt.md_working_1.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_1.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_1.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_1.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_1.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_1.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<span style="color:blue" class="comment"># Now evaluate the numerator in the expression above.  This will output 6 scalars. </span>
<b name="data/Steinhardt.md_working_1.datsp" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datsp","data/Steinhardt.md_working_1.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_1.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_1.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_1.datones">ones</b>
<span style="color:blue" class="comment"># Now evaluate the q_lm(i) values by dividing by  the coordination number of the atom</span>
<b name="data/Steinhardt.md_working_1.datq1-rmn-n1" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datq1-rmn-n1","data/Steinhardt.md_working_1.datq1-rmn-n1","blue")'>q1-rmn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_1.datq1-rmn-n1">The CUSTOM action with label <b>q1-rmn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_1.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_1.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_1.datq1-imn-n1" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datq1-imn-n1","data/Steinhardt.md_working_1.datq1-imn-n1","blue")'>q1-imn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_1.datq1-imn-n1">The CUSTOM action with label <b>q1-imn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_1.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_1.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_1.datq1-rmn-0" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datq1-rmn-0","data/Steinhardt.md_working_1.datq1-rmn-0","blue")'>q1-rmn-0</b><span style="display:none;" id="data/Steinhardt.md_working_1.datq1-rmn-0">The CUSTOM action with label <b>q1-rmn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_1.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_1.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_1.datq1-imn-0" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datq1-imn-0","data/Steinhardt.md_working_1.datq1-imn-0","blue")'>q1-imn-0</b><span style="display:none;" id="data/Steinhardt.md_working_1.datq1-imn-0">The CUSTOM action with label <b>q1-imn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_1.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_1.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_1.datq1-rmn-p1" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datq1-rmn-p1","data/Steinhardt.md_working_1.datq1-rmn-p1","blue")'>q1-rmn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_1.datq1-rmn-p1">The CUSTOM action with label <b>q1-rmn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_1.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_1.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_1.datq1-imn-p1" onclick='showPath("data/Steinhardt.md_working_1.dat","data/Steinhardt.md_working_1.datq1-imn-p1","data/Steinhardt.md_working_1.datq1-imn-p1","blue")'>q1-imn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_1.datq1-imn-p1">The CUSTOM action with label <b>q1-imn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_1.datsp">sp.im-p1</b>,<b name="data/Steinhardt.md_working_1.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># And output these six scalars to a file</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_1.datq1-rmn-n1">q1-rmn-n1</b>,<b name="data/Steinhardt.md_working_1.datq1-imn-n1">q1-imn-n1</b>,<b name="data/Steinhardt.md_working_1.datq1-rmn-0">q1-rmn-0</b>,<b name="data/Steinhardt.md_working_1.datq1-imn-0">q1-imn-0</b>,<b name="data/Steinhardt.md_working_1.datq1-rmn-p1">q1-rmn-p1</b>,<b name="data/Steinhardt.md_working_1.datq1-imn-p1">q1-imn-p1</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

The $q_{lm}(i)$ values that are output by the PLUMED input above are not rotationally invariant.  We thus introduce $q_l(i)$ as follows:

$$
q_{l}(i) = \sqrt{ \sum_{m=-l}^l | q_{lm}(i) |^2 }
$$

This quantity can be calculated using the following PLUMED input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_2.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_2.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_2.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the contact matrix between atom 1 and all the other atoms</span>
<b name="data/Steinhardt.md_working_2.datcmat" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datcmat","data/Steinhardt.md_working_2.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_2.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">when you are calculating the adjacency matrix between two sets of atoms this keyword is used to specify the atoms along with the keyword GROUPB<i></i></span></span>=1 <span class="plumedtooltip">GROUPB<span class="right">when you are calculating the adjacency matrix between two sets of atoms this keyword is used to specify the atoms along with the keyword GROUPA<i></i></span></span>=2-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span style="color:blue" class="comment"># Create a vector containing 99 ones</span>
<span id="data/Steinhardt.md_working_2.datones_short"><b name="data/Steinhardt.md_working_2.datones" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datones","data/Steinhardt.md_working_2.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_2.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_2.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=99
</span><span id="data/Steinhardt.md_working_2.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_2.datones")'># ones: ONES SIZE=99</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_2.datones" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datones","data/Steinhardt.md_working_2.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_2.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Calculate the coordination number for atom 1 by multiplying the contact matrix above </span>
<span style="color:blue" class="comment"># by a vector of ones</span>
<b name="data/Steinhardt.md_working_2.datcoord" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datcoord","data/Steinhardt.md_working_2.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_2.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_2.datones">ones</b>
<span style="color:blue" class="comment"># Evaluate the Y_l^m values for each vector in the first coordination sphere and multiply these </span>
<span style="color:blue" class="comment"># values by \sigma(r_ij).  This action outputs 6 matrices that correspond to the real and imaginary </span>
<span style="color:blue" class="comment"># components of Y^l_m for m values of -1, 0 and +1. </span>
<b name="data/Steinhardt.md_working_2.datsh" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datsh","data/Steinhardt.md_working_2.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_2.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_2.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_2.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_2.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<span style="color:blue" class="comment"># Now evaluate the numerator in the expression above.  This will output 6 scalars.  </span>
<b name="data/Steinhardt.md_working_2.datsp" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datsp","data/Steinhardt.md_working_2.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_2.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_2.datones">ones</b>
<span style="color:blue" class="comment"># Now evaluate the q_lm(i) values by dividing by  the coordination number of the atom</span>
<b name="data/Steinhardt.md_working_2.datq1-rmn-n1" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datq1-rmn-n1","data/Steinhardt.md_working_2.datq1-rmn-n1","blue")'>q1-rmn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_2.datq1-rmn-n1">The CUSTOM action with label <b>q1-rmn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_2.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_2.datq1-imn-n1" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datq1-imn-n1","data/Steinhardt.md_working_2.datq1-imn-n1","blue")'>q1-imn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_2.datq1-imn-n1">The CUSTOM action with label <b>q1-imn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_2.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_2.datq1-rmn-0" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datq1-rmn-0","data/Steinhardt.md_working_2.datq1-rmn-0","blue")'>q1-rmn-0</b><span style="display:none;" id="data/Steinhardt.md_working_2.datq1-rmn-0">The CUSTOM action with label <b>q1-rmn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_2.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_2.datq1-imn-0" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datq1-imn-0","data/Steinhardt.md_working_2.datq1-imn-0","blue")'>q1-imn-0</b><span style="display:none;" id="data/Steinhardt.md_working_2.datq1-imn-0">The CUSTOM action with label <b>q1-imn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_2.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_2.datq1-rmn-p1" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datq1-rmn-p1","data/Steinhardt.md_working_2.datq1-rmn-p1","blue")'>q1-rmn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_2.datq1-rmn-p1">The CUSTOM action with label <b>q1-rmn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_2.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_2.datq1-imn-p1" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datq1-imn-p1","data/Steinhardt.md_working_2.datq1-imn-p1","blue")'>q1-imn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_2.datq1-imn-p1">The CUSTOM action with label <b>q1-imn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datsp">sp.im-p1</b>,<b name="data/Steinhardt.md_working_2.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Calculate the sum of the squares of the q_lm(i) values</span>
<b name="data/Steinhardt.md_working_2.datq1_2" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datq1_2","data/Steinhardt.md_working_2.datq1_2","blue")'>q1_2</b><span style="display:none;" id="data/Steinhardt.md_working_2.datq1_2">The COMBINE action with label <b>q1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datq1-rmn-n1">q1-rmn-n1</b>,<b name="data/Steinhardt.md_working_2.datq1-imn-n1">q1-imn-n1</b>,<b name="data/Steinhardt.md_working_2.datq1-rmn-0">q1-rmn-0</b>,<b name="data/Steinhardt.md_working_2.datq1-imn-0">q1-imn-0</b>,<b name="data/Steinhardt.md_working_2.datq1-rmn-p1">q1-rmn-p1</b>,<b name="data/Steinhardt.md_working_2.datq1-imn-p1">q1-imn-p1</b>
<span style="color:blue" class="comment"># Take the square root of the sum of the squares</span>
<b name="data/Steinhardt.md_working_2.datq1" onclick='showPath("data/Steinhardt.md_working_2.dat","data/Steinhardt.md_working_2.datq1","data/Steinhardt.md_working_2.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_2.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datq1_2">q1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># And output this single scalar that results to a file</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_2.datq1">q1</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar 
</pre>
 {% endraw %} 

Alternatively, we could compute the following quantity:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_3.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_3.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_3.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the contact matrix between atom 1 and all the other atoms</span>
<b name="data/Steinhardt.md_working_3.datcmat" onclick='showPath("data/Steinhardt.md_working_3.dat","data/Steinhardt.md_working_3.datcmat","data/Steinhardt.md_working_3.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_3.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">when you are calculating the adjacency matrix between two sets of atoms this keyword is used to specify the atoms along with the keyword GROUPB<i></i></span></span>=1 <span class="plumedtooltip">GROUPB<span class="right">when you are calculating the adjacency matrix between two sets of atoms this keyword is used to specify the atoms along with the keyword GROUPA<i></i></span></span>=2-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span style="color:blue" class="comment"># Create a vector containing 99 ones</span>
<span id="data/Steinhardt.md_working_3.datones_short"><b name="data/Steinhardt.md_working_3.datones" onclick='showPath("data/Steinhardt.md_working_3.dat","data/Steinhardt.md_working_3.datones","data/Steinhardt.md_working_3.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_3.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_3.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=99
</span><span id="data/Steinhardt.md_working_3.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_3.datones")'># ones: ONES SIZE=99</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_3.datones" onclick='showPath("data/Steinhardt.md_working_3.dat","data/Steinhardt.md_working_3.datones","data/Steinhardt.md_working_3.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_3.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Calculate the coordination number for atom 1 by multiplying the contact matrix above</span>
<span style="color:blue" class="comment"># by a vector of ones</span>
<b name="data/Steinhardt.md_working_3.datcoord" onclick='showPath("data/Steinhardt.md_working_3.dat","data/Steinhardt.md_working_3.datcoord","data/Steinhardt.md_working_3.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_3.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_3.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_3.datones">ones</b>
<span style="color:blue" class="comment"># Evaluate the Y_l^m values for each vector in the first coordination sphere and multiply these</span>
<span style="color:blue" class="comment"># values by \sigma(r_ij).  This action outputs 6 matrices that correspond to the real and imaginary</span>
<span style="color:blue" class="comment"># components of Y^l_m for m values of -1, 0 and +1.</span>
<b name="data/Steinhardt.md_working_3.datsh" onclick='showPath("data/Steinhardt.md_working_3.dat","data/Steinhardt.md_working_3.datsh","data/Steinhardt.md_working_3.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_3.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_3.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_3.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_3.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_3.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<span style="color:blue" class="comment"># Now evaluate the numerators in the expression above.  This will output 6 scalars.</span>
<b name="data/Steinhardt.md_working_3.datsp" onclick='showPath("data/Steinhardt.md_working_3.dat","data/Steinhardt.md_working_3.datsp","data/Steinhardt.md_working_3.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_3.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_3.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_3.datones">ones</b>
<span style="color:blue" class="comment"># Now take the sum of the squares of the numerators</span>
<b name="data/Steinhardt.md_working_3.datq1_2" onclick='showPath("data/Steinhardt.md_working_3.dat","data/Steinhardt.md_working_3.datq1_2","data/Steinhardt.md_working_3.datq1_2","blue")'>q1_2</b><span style="display:none;" id="data/Steinhardt.md_working_3.datq1_2">The COMBINE action with label <b>q1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_3.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_3.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_3.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_3.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_3.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_3.datsp">sp.im-p1</b>
<span style="color:blue" class="comment"># Square root </span>
<b name="data/Steinhardt.md_working_3.datq1" onclick='showPath("data/Steinhardt.md_working_3.dat","data/Steinhardt.md_working_3.datq1","data/Steinhardt.md_working_3.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_3.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_3.datq1_2">q1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># And divide by the number of neighbours</span>
<b name="data/Steinhardt.md_working_3.datanorm" onclick='showPath("data/Steinhardt.md_working_3.dat","data/Steinhardt.md_working_3.datanorm","data/Steinhardt.md_working_3.datanorm","blue")'>anorm</b><span style="display:none;" id="data/Steinhardt.md_working_3.datanorm">The CUSTOM action with label <b>anorm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">anorm</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_3.datq1">q1</b>,<b name="data/Steinhardt.md_working_3.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
</pre>
 {% endraw %} 

This input computes:

$$
q_l(i) = \frac{1}{N(i)} \sqrt{\sum_{m=-1}^l N(i)^2 |  q_{lm}(i) |^2} \qquad \textrm{where} \qquad N(i) = \sum_{j \ne i} \sigma(r_{ij})
$$

This should be equivalent to what is computed by the first input but there may be some small differences in practise because of numerical error.
I only mention this alternative claculation method as this is done when the shortcut below is employed:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_4.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_4.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_4.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/Steinhardt.md_working_4.datq1_short"><b name="data/Steinhardt.md_working_4.datq1" onclick='showPath("data/Steinhardt.md_working_4.dat","data/Steinhardt.md_working_4.datq1","data/Steinhardt.md_working_4.datq1_shortcut","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_4.datq1_shortcut">The Q1 action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the norms of the vectors of spherical harmonic coefficients</td></tr></table></span>: <span class="plumedtooltip" style="color:green">Q1<span class="right">Calculate 1st order Steinhardt parameters This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_4.datq1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/Q1">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIESA<span class="right">the list of atoms for which the symmetry function is being calculated<i></i></span></span>=1 <span class="plumedtooltip">SPECIESB<span class="right">the list of atoms that can be in the environments of each of the atoms for which the symmetry function is being calculated<i></i></span></span>=2-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
</span><span id="data/Steinhardt.md_working_4.datq1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_4.datq1")'># q1: Q1 SPECIESA=1 SPECIESB=2-100 SWITCH={RATIONAL D_0=2.0 R_0=1.0}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_4.datq1_grp" onclick='showPath("data/Steinhardt.md_working_4.dat","data/Steinhardt.md_working_4.datq1_grp","data/Steinhardt.md_working_4.datq1_grp","violet")'>q1_grp</b><span style="display:none;" id="data/Steinhardt.md_working_4.datq1_grp">The GROUP action with label <b>q1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=1
<b name="data/Steinhardt.md_working_4.datq1_mat" onclick='showPath("data/Steinhardt.md_working_4.dat","data/Steinhardt.md_working_4.datq1_mat","data/Steinhardt.md_working_4.datq1_mat","red")'>q1_mat</b><span style="display:none;" id="data/Steinhardt.md_working_4.datq1_mat">The CONTACT_MATRIX action with label <b>q1_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_mat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">q1_mat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">q1_mat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">q1_mat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUPA<span class="right">when you are calculating the adjacency matrix between two sets of atoms this keyword is used to specify the atoms along with the keyword GROUPB<i></i></span></span>=1 <span class="plumedtooltip">GROUPB<span class="right">when you are calculating the adjacency matrix between two sets of atoms this keyword is used to specify the atoms along with the keyword GROUPA<i></i></span></span>=2-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span>
<b name="data/Steinhardt.md_working_4.datq1_sh" onclick='showPath("data/Steinhardt.md_working_4.dat","data/Steinhardt.md_working_4.datq1_sh","data/Steinhardt.md_working_4.datq1_sh","red")'>q1_sh</b><span style="display:none;" id="data/Steinhardt.md_working_4.datq1_sh">The SPHERICAL_HARMONIC action with label <b>q1_sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_4.datq1_mat">q1_mat.x</b>,<b name="data/Steinhardt.md_working_4.datq1_mat">q1_mat.y</b>,<b name="data/Steinhardt.md_working_4.datq1_mat">q1_mat.z</b>,<b name="data/Steinhardt.md_working_4.datq1_mat">q1_mat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_4.datq1_denom_ones" onclick='showPath("data/Steinhardt.md_working_4.dat","data/Steinhardt.md_working_4.datq1_denom_ones","data/Steinhardt.md_working_4.datq1_denom_ones","blue")'>q1_denom_ones</b><span style="display:none;" id="data/Steinhardt.md_working_4.datq1_denom_ones">The CONSTANT action with label <b>q1_denom_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=99
<b name="data/Steinhardt.md_working_4.datq1_denom" onclick='showPath("data/Steinhardt.md_working_4.dat","data/Steinhardt.md_working_4.datq1_denom","data/Steinhardt.md_working_4.datq1_denom","blue")'>q1_denom</b><span style="display:none;" id="data/Steinhardt.md_working_4.datq1_denom">The MATRIX_VECTOR_PRODUCT action with label <b>q1_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_4.datq1_mat">q1_mat.w</b>,<b name="data/Steinhardt.md_working_4.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_4.datq1_sp" onclick='showPath("data/Steinhardt.md_working_4.dat","data/Steinhardt.md_working_4.datq1_sp","data/Steinhardt.md_working_4.datq1_sp","blue")'>q1_sp</b><span style="display:none;" id="data/Steinhardt.md_working_4.datq1_sp">The MATRIX_VECTOR_PRODUCT action with label <b>q1_sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-p1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-p1 and the vector q1_denom_ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_4.datq1_sh">q1_sh.*</b>,<b name="data/Steinhardt.md_working_4.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_4.datq1_norm2" onclick='showPath("data/Steinhardt.md_working_4.dat","data/Steinhardt.md_working_4.datq1_norm2","data/Steinhardt.md_working_4.datq1_norm2","blue")'>q1_norm2</b><span style="display:none;" id="data/Steinhardt.md_working_4.datq1_norm2">The COMBINE action with label <b>q1_norm2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_4.datq1_sp">q1_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_4.datq1_sp">q1_sp.im-n1</b>,<b name="data/Steinhardt.md_working_4.datq1_sp">q1_sp.rm-0</b>,<b name="data/Steinhardt.md_working_4.datq1_sp">q1_sp.im-0</b>,<b name="data/Steinhardt.md_working_4.datq1_sp">q1_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_4.datq1_sp">q1_sp.im-p1</b>
<b name="data/Steinhardt.md_working_4.datq1_norm" onclick='showPath("data/Steinhardt.md_working_4.dat","data/Steinhardt.md_working_4.datq1_norm","data/Steinhardt.md_working_4.datq1_norm","blue")'>q1_norm</b><span style="display:none;" id="data/Steinhardt.md_working_4.datq1_norm">The CUSTOM action with label <b>q1_norm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_4.datq1_norm2">q1_norm2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_4.datq1" onclick='showPath("data/Steinhardt.md_working_4.dat","data/Steinhardt.md_working_4.datq1","data/Steinhardt.md_working_4.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_4.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_4.datq1_norm">q1_norm</b>,<b name="data/Steinhardt.md_working_4.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_4.datq1">q1</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

As you can see the Q1 action in this second input expands to the input above.

# Calculating the Steinhardt parameters for multiple atoms

Consider the following input for calculating Steinhardt parameters:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_5.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_5.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_5.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/Steinhardt.md_working_5.datq4_short"><b name="data/Steinhardt.md_working_5.datq4" onclick='showPath("data/Steinhardt.md_working_5.dat","data/Steinhardt.md_working_5.datq4","data/Steinhardt.md_working_5.datq4_shortcut","blue")'>q4</b><span style="display:none;" id="data/Steinhardt.md_working_5.datq4_shortcut">The Q4 action with label <b>q4</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q4</td><td width="5%"><font color="blue">vector</font></td><td>the norms of the vectors of spherical harmonic coefficients</td></tr></table></span>: <span class="plumedtooltip" style="color:green">Q4<span class="right">Calculate fourth order Steinhardt parameters. This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_5.datq4");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/Q4">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
</span><span id="data/Steinhardt.md_working_5.datq4_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_5.datq4")'># q4: Q4 SPECIES=1-100 SWITCH={RATIONAL D_0=2.0 R_0=1.0}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_5.datq4_grp" onclick='showPath("data/Steinhardt.md_working_5.dat","data/Steinhardt.md_working_5.datq4_grp","data/Steinhardt.md_working_5.datq4_grp","violet")'>q4_grp</b><span style="display:none;" id="data/Steinhardt.md_working_5.datq4_grp">The GROUP action with label <b>q4_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q4_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=1-100
<b name="data/Steinhardt.md_working_5.datq4_mat" onclick='showPath("data/Steinhardt.md_working_5.dat","data/Steinhardt.md_working_5.datq4_mat","data/Steinhardt.md_working_5.datq4_mat","red")'>q4_mat</b><span style="display:none;" id="data/Steinhardt.md_working_5.datq4_mat">The CONTACT_MATRIX action with label <b>q4_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q4_mat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">q4_mat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">q4_mat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">q4_mat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span>
<b name="data/Steinhardt.md_working_5.datq4_sh" onclick='showPath("data/Steinhardt.md_working_5.dat","data/Steinhardt.md_working_5.datq4_sh","data/Steinhardt.md_working_5.datq4_sh","red")'>q4_sh</b><span style="display:none;" id="data/Steinhardt.md_working_5.datq4_sh">The SPHERICAL_HARMONIC action with label <b>q4_sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q4_sh.rm-n4</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n4th of these quantities</td></tr><tr><td width="5%">q4_sh.rm-n3</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n3th of these quantities</td></tr><tr><td width="5%">q4_sh.rm-n2</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n2th of these quantities</td></tr><tr><td width="5%">q4_sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q4_sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q4_sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">q4_sh.rm-p2</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p2th of these quantities</td></tr><tr><td width="5%">q4_sh.rm-p3</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p3th of these quantities</td></tr><tr><td width="5%">q4_sh.rm-p4</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p4th of these quantities</td></tr><tr><td width="5%">q4_sh.im-n4</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n4th of these quantities</td></tr><tr><td width="5%">q4_sh.im-n3</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n3th of these quantities</td></tr><tr><td width="5%">q4_sh.im-n2</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n2th of these quantities</td></tr><tr><td width="5%">q4_sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q4_sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q4_sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">q4_sh.im-p2</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p2th of these quantities</td></tr><tr><td width="5%">q4_sh.im-p3</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p3th of these quantities</td></tr><tr><td width="5%">q4_sh.im-p4</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p4th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_5.datq4_mat">q4_mat.x</b>,<b name="data/Steinhardt.md_working_5.datq4_mat">q4_mat.y</b>,<b name="data/Steinhardt.md_working_5.datq4_mat">q4_mat.z</b>,<b name="data/Steinhardt.md_working_5.datq4_mat">q4_mat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=4
<b name="data/Steinhardt.md_working_5.datq4_denom_ones" onclick='showPath("data/Steinhardt.md_working_5.dat","data/Steinhardt.md_working_5.datq4_denom_ones","data/Steinhardt.md_working_5.datq4_denom_ones","blue")'>q4_denom_ones</b><span style="display:none;" id="data/Steinhardt.md_working_5.datq4_denom_ones">The CONSTANT action with label <b>q4_denom_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q4_denom_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_5.datq4_denom" onclick='showPath("data/Steinhardt.md_working_5.dat","data/Steinhardt.md_working_5.datq4_denom","data/Steinhardt.md_working_5.datq4_denom","blue")'>q4_denom</b><span style="display:none;" id="data/Steinhardt.md_working_5.datq4_denom">The MATRIX_VECTOR_PRODUCT action with label <b>q4_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q4_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_5.datq4_mat">q4_mat.w</b>,<b name="data/Steinhardt.md_working_5.datq4_denom_ones">q4_denom_ones</b>
<b name="data/Steinhardt.md_working_5.datq4_sp" onclick='showPath("data/Steinhardt.md_working_5.dat","data/Steinhardt.md_working_5.datq4_sp","data/Steinhardt.md_working_5.datq4_sp","blue")'>q4_sp</b><span style="display:none;" id="data/Steinhardt.md_working_5.datq4_sp">The MATRIX_VECTOR_PRODUCT action with label <b>q4_sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q4_sp.rm-n4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.rm-n4 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.rm-n3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.rm-n3 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.rm-n2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.rm-n2 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.rm-n1 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.rm-0 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.rm-p1 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.rm-p2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.rm-p2 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.rm-p3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.rm-p3 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.rm-p4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.rm-p4 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.im-n4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.im-n4 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.im-n3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.im-n3 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.im-n2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.im-n2 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.im-n1 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.im-0 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.im-p1 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.im-p2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.im-p2 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.im-p3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.im-p3 and the vector q4_denom_ones</td></tr><tr><td width="5%">q4_sp.im-p4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q4_sh.im-p4 and the vector q4_denom_ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_5.datq4_sh">q4_sh.*</b>,<b name="data/Steinhardt.md_working_5.datq4_denom_ones">q4_denom_ones</b>
<b name="data/Steinhardt.md_working_5.datq4_norm2" onclick='showPath("data/Steinhardt.md_working_5.dat","data/Steinhardt.md_working_5.datq4_norm2","data/Steinhardt.md_working_5.datq4_norm2","blue")'>q4_norm2</b><span style="display:none;" id="data/Steinhardt.md_working_5.datq4_norm2">The COMBINE action with label <b>q4_norm2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q4_norm2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.rm-n4</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.im-n4</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.rm-n3</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.im-n3</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.rm-n2</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.im-n2</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.im-n1</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.rm-0</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.im-0</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.im-p1</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.rm-p2</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.im-p2</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.rm-p3</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.im-p3</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.rm-p4</b>,<b name="data/Steinhardt.md_working_5.datq4_sp">q4_sp.im-p4</b>
<b name="data/Steinhardt.md_working_5.datq4_norm" onclick='showPath("data/Steinhardt.md_working_5.dat","data/Steinhardt.md_working_5.datq4_norm","data/Steinhardt.md_working_5.datq4_norm","blue")'>q4_norm</b><span style="display:none;" id="data/Steinhardt.md_working_5.datq4_norm">The CUSTOM action with label <b>q4_norm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q4_norm</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_5.datq4_norm2">q4_norm2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_5.datq4" onclick='showPath("data/Steinhardt.md_working_5.dat","data/Steinhardt.md_working_5.datq4","data/Steinhardt.md_working_5.datq4","blue")'>q4</b><span style="display:none;" id="data/Steinhardt.md_working_5.datq4">The CUSTOM action with label <b>q4</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q4</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_5.datq4_norm">q4_norm</b>,<b name="data/Steinhardt.md_working_5.datq4_denom">q4_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_5.datq4">q4</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

The colvar file that is output by this action will contain 100 $q_l(i)$ values for each time step.  If you look at the expanded version of the input you can see that it has the same
structure as the inputs that we looked at for calculating the $q_l(i)$ for a single atom in the previous section.  The difference is in the contact matrix that is calculated in the
first line of the input. When we are calculating a single $q_l(i)$ value this is a $1 \times 99$ matrix. For the input above the contact matrix is a $100 \times 100$
matrix.  When we do the MATRIX_VECTOR_PRODUCT we thus have a series of vectors with 100 elements (i.e. one element for each atom).  The vectors output by this action are this size as there are 100 rows 
in the constact matrix and not just one.  

The expanded version of the input file is clear because when we apply the SPHERICAL_HARMONIC operation we do it element-wise.  The user can use this action as if it is generating $2(2l+1)$ matrices with the 
same shape as the CONTACT_MATRIX by applying computing $\sigma(r_{ij})Y_l^m(\theta_{ij},\phi_{ij})$ for each bond vector.  (PLUMED is (obviously) not computing the Steinhardt parameter in this way as that would
be horribly inneficient.)  They are thus free to do many different things with the vectors that are computed.

# Calculating functions of the distribution of Steinhardt Parameters

When you use the shortcut actions Q1, Q3, Q4 and Q6 you can use keywords such as MEAN, LOWEST, LESS_THAN, MORE_THAN to calculate functions of the distribution of $q_l(i)$ values in the same way that you would use
these keywords with other symmetry functions such as COORDINATIONNUMBERS. When you use these keywords with Steinhardt parameters there are subtleties in the literature that you should be know about.  These subtleties
are easily understood if you look at the full inputs that PLUMED generates when you use these shortcuts.  Lets start by considering the following input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_6.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_6.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_6.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the contact matrix for the first 100 atoms in the input file</span>
<b name="data/Steinhardt.md_working_6.datcmat" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datcmat","data/Steinhardt.md_working_6.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_6.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span style="color:blue" class="comment"># Create a vector containing 100 ones</span>
<span id="data/Steinhardt.md_working_6.datones_short"><b name="data/Steinhardt.md_working_6.datones" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datones","data/Steinhardt.md_working_6.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_6.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_6.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
</span><span id="data/Steinhardt.md_working_6.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_6.datones")'># ones: ONES SIZE=100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_6.datones" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datones","data/Steinhardt.md_working_6.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_6.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Calculate the coordination numbers for the atoms by multiplying the contact matrix above</span>
<span style="color:blue" class="comment"># by a vector of ones</span>
<b name="data/Steinhardt.md_working_6.datcoord" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datcoord","data/Steinhardt.md_working_6.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_6.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_6.datones">ones</b>
<span style="color:blue" class="comment"># Evaluate the Y_l^m values for each vector in the first coordination sphere and multiply these</span>
<span style="color:blue" class="comment"># values by \sigma(r_ij).  This action outputs 6 matrices that correspond to the real and imaginary</span>
<span style="color:blue" class="comment"># components of Y^l_m for m values of -1, 0 and +1.</span>
<b name="data/Steinhardt.md_working_6.datsh" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datsh","data/Steinhardt.md_working_6.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_6.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_6.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_6.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_6.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<span style="color:blue" class="comment"># Now evaluate the numerator in the expression above.  This will output 6 vectors each of which has 100 components.</span>
<b name="data/Steinhardt.md_working_6.datsp" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datsp","data/Steinhardt.md_working_6.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_6.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_6.datones">ones</b>
<span style="color:blue" class="comment"># Now evaluate the q_lm(i) values for each atom by dividing by  the coordination number of the corresponding atom</span>
<b name="data/Steinhardt.md_working_6.datq1-rmn-n1" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datq1-rmn-n1","data/Steinhardt.md_working_6.datq1-rmn-n1","blue")'>q1-rmn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_6.datq1-rmn-n1">The CUSTOM action with label <b>q1-rmn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_6.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_6.datq1-imn-n1" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datq1-imn-n1","data/Steinhardt.md_working_6.datq1-imn-n1","blue")'>q1-imn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_6.datq1-imn-n1">The CUSTOM action with label <b>q1-imn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_6.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_6.datq1-rmn-0" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datq1-rmn-0","data/Steinhardt.md_working_6.datq1-rmn-0","blue")'>q1-rmn-0</b><span style="display:none;" id="data/Steinhardt.md_working_6.datq1-rmn-0">The CUSTOM action with label <b>q1-rmn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_6.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_6.datq1-imn-0" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datq1-imn-0","data/Steinhardt.md_working_6.datq1-imn-0","blue")'>q1-imn-0</b><span style="display:none;" id="data/Steinhardt.md_working_6.datq1-imn-0">The CUSTOM action with label <b>q1-imn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_6.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_6.datq1-rmn-p1" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datq1-rmn-p1","data/Steinhardt.md_working_6.datq1-rmn-p1","blue")'>q1-rmn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_6.datq1-rmn-p1">The CUSTOM action with label <b>q1-rmn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_6.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_6.datq1-imn-p1" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datq1-imn-p1","data/Steinhardt.md_working_6.datq1-imn-p1","blue")'>q1-imn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_6.datq1-imn-p1">The CUSTOM action with label <b>q1-imn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datsp">sp.im-p1</b>,<b name="data/Steinhardt.md_working_6.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Calculate the sum of the squares of the q_lm(i) values</span>
<b name="data/Steinhardt.md_working_6.datq1_2" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datq1_2","data/Steinhardt.md_working_6.datq1_2","blue")'>q1_2</b><span style="display:none;" id="data/Steinhardt.md_working_6.datq1_2">The COMBINE action with label <b>q1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datq1-rmn-n1">q1-rmn-n1</b>,<b name="data/Steinhardt.md_working_6.datq1-imn-n1">q1-imn-n1</b>,<b name="data/Steinhardt.md_working_6.datq1-rmn-0">q1-rmn-0</b>,<b name="data/Steinhardt.md_working_6.datq1-imn-0">q1-imn-0</b>,<b name="data/Steinhardt.md_working_6.datq1-rmn-p1">q1-rmn-p1</b>,<b name="data/Steinhardt.md_working_6.datq1-imn-p1">q1-imn-p1</b>
<span style="color:blue" class="comment"># Take the square root of the sum of the squares.  This outputs a vector with 100 components</span>
<b name="data/Steinhardt.md_working_6.datq1" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datq1","data/Steinhardt.md_working_6.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_6.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datq1_2">q1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Calculate the average Q1 values.</span>
<b name="data/Steinhardt.md_working_6.datq1_mean" onclick='showPath("data/Steinhardt.md_working_6.dat","data/Steinhardt.md_working_6.datq1_mean","data/Steinhardt.md_working_6.datq1_mean","black")'>q1_mean</b><span style="display:none;" id="data/Steinhardt.md_working_6.datq1_mean">The MEAN action with label <b>q1_mean</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_mean</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datq1">q1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># And output this single scalar that results to a file</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_6.datq1_mean">q1_mean</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

The average that is being calculated here is:

$$
\langle q_l \rangle = \frac{1}{N} \sum_{i=1}^N q_l(i)
$$

which is also what is computed if we use the following shortcut:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_7.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_7.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_7.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/Steinhardt.md_working_7.datq1_short"><b name="data/Steinhardt.md_working_7.datq1" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1","data/Steinhardt.md_working_7.datq1_shortcut","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1_shortcut">The Q1 action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the norms of the vectors of spherical harmonic coefficients</td></tr><tr><td width="5%">q1_mean</td><td width="5%"><font color="black">scalar</font></td><td>the mean of the colvars</td></tr></table></span>: <span class="plumedtooltip" style="color:green">Q1<span class="right">Calculate 1st order Steinhardt parameters This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_7.datq1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/Q1">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">MEAN<span class="right"> calculate the mean of all the quantities<i></i></span></span>
</span><span id="data/Steinhardt.md_working_7.datq1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_7.datq1")'># q1: Q1 SPECIES=1-100 SWITCH={RATIONAL D_0=2.0 R_0=1.0} MEAN</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_7.datq1_grp" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1_grp","data/Steinhardt.md_working_7.datq1_grp","violet")'>q1_grp</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1_grp">The GROUP action with label <b>q1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=1-100
<b name="data/Steinhardt.md_working_7.datq1_mat" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1_mat","data/Steinhardt.md_working_7.datq1_mat","red")'>q1_mat</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1_mat">The CONTACT_MATRIX action with label <b>q1_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_mat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">q1_mat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">q1_mat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">q1_mat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span>
<b name="data/Steinhardt.md_working_7.datq1_sh" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1_sh","data/Steinhardt.md_working_7.datq1_sh","red")'>q1_sh</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1_sh">The SPHERICAL_HARMONIC action with label <b>q1_sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_7.datq1_mat">q1_mat.x</b>,<b name="data/Steinhardt.md_working_7.datq1_mat">q1_mat.y</b>,<b name="data/Steinhardt.md_working_7.datq1_mat">q1_mat.z</b>,<b name="data/Steinhardt.md_working_7.datq1_mat">q1_mat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_7.datq1_denom_ones" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1_denom_ones","data/Steinhardt.md_working_7.datq1_denom_ones","blue")'>q1_denom_ones</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1_denom_ones">The CONSTANT action with label <b>q1_denom_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_7.datq1_denom" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1_denom","data/Steinhardt.md_working_7.datq1_denom","blue")'>q1_denom</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1_denom">The MATRIX_VECTOR_PRODUCT action with label <b>q1_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_7.datq1_mat">q1_mat.w</b>,<b name="data/Steinhardt.md_working_7.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_7.datq1_sp" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1_sp","data/Steinhardt.md_working_7.datq1_sp","blue")'>q1_sp</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1_sp">The MATRIX_VECTOR_PRODUCT action with label <b>q1_sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-p1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-p1 and the vector q1_denom_ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_7.datq1_sh">q1_sh.*</b>,<b name="data/Steinhardt.md_working_7.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_7.datq1_norm2" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1_norm2","data/Steinhardt.md_working_7.datq1_norm2","blue")'>q1_norm2</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1_norm2">The COMBINE action with label <b>q1_norm2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_7.datq1_sp">q1_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_7.datq1_sp">q1_sp.im-n1</b>,<b name="data/Steinhardt.md_working_7.datq1_sp">q1_sp.rm-0</b>,<b name="data/Steinhardt.md_working_7.datq1_sp">q1_sp.im-0</b>,<b name="data/Steinhardt.md_working_7.datq1_sp">q1_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_7.datq1_sp">q1_sp.im-p1</b>
<b name="data/Steinhardt.md_working_7.datq1_norm" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1_norm","data/Steinhardt.md_working_7.datq1_norm","blue")'>q1_norm</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1_norm">The CUSTOM action with label <b>q1_norm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_7.datq1_norm2">q1_norm2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_7.datq1" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1","data/Steinhardt.md_working_7.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_7.datq1_norm">q1_norm</b>,<b name="data/Steinhardt.md_working_7.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_7.datq1_mean" onclick='showPath("data/Steinhardt.md_working_7.dat","data/Steinhardt.md_working_7.datq1_mean","data/Steinhardt.md_working_7.datq1_mean","black")'>q1_mean</b><span style="display:none;" id="data/Steinhardt.md_working_7.datq1_mean">The MEAN action with label <b>q1_mean</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_mean</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_7.datq1">q1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_7.datq1_mean">q1_mean</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

We do not need to average the $q_l(i)$ values.  We could instead calculate the average of the $q_{lm}(i)$ values and the magnitude of the resulting vector like this:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_8.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_8.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_8.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the contact matrix for the first 100 atoms in the input file</span>
<b name="data/Steinhardt.md_working_8.datcmat" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datcmat","data/Steinhardt.md_working_8.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_8.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span style="color:blue" class="comment"># Create a vector containing 100 ones</span>
<span id="data/Steinhardt.md_working_8.datones_short"><b name="data/Steinhardt.md_working_8.datones" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datones","data/Steinhardt.md_working_8.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_8.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_8.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100 
</span><span id="data/Steinhardt.md_working_8.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_8.datones")'># ones: ONES SIZE=100 </span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_8.datones" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datones","data/Steinhardt.md_working_8.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_8.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Calculate the coordination numbers for the atoms by multiplying the contact matrix above</span>
<span style="color:blue" class="comment"># by a vector of ones</span>
<b name="data/Steinhardt.md_working_8.datcoord" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datcoord","data/Steinhardt.md_working_8.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_8.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_8.datones">ones</b>
<span style="color:blue" class="comment"># Evaluate the Y_l^m values for each vector in the first coordination sphere and multiply these</span>
<span style="color:blue" class="comment"># values by \sigma(r_ij).  This action outputs 6 matrices that correspond to the real and imaginary</span>
<span style="color:blue" class="comment"># components of Y^l_m for m values of -1, 0 and +1.</span>
<b name="data/Steinhardt.md_working_8.datsh" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datsh","data/Steinhardt.md_working_8.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_8.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_8.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_8.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_8.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<span style="color:blue" class="comment"># Now evaluate the numerator in the expression above.  This will output 6 vectors each of which has 100 components.</span>
<b name="data/Steinhardt.md_working_8.datsp" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datsp","data/Steinhardt.md_working_8.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_8.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_8.datones">ones</b>
<span style="color:blue" class="comment"># Now evaluate the q_lm(i) values for each atom by dividing by  the coordination number of the corresponding atom</span>
<b name="data/Steinhardt.md_working_8.datq1-rmn-n1" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-rmn-n1","data/Steinhardt.md_working_8.datq1-rmn-n1","blue")'>q1-rmn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-rmn-n1">The CUSTOM action with label <b>q1-rmn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_8.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_8.datq1-imn-n1" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-imn-n1","data/Steinhardt.md_working_8.datq1-imn-n1","blue")'>q1-imn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-imn-n1">The CUSTOM action with label <b>q1-imn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_8.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_8.datq1-rmn-0" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-rmn-0","data/Steinhardt.md_working_8.datq1-rmn-0","blue")'>q1-rmn-0</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-rmn-0">The CUSTOM action with label <b>q1-rmn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_8.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_8.datq1-imn-0" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-imn-0","data/Steinhardt.md_working_8.datq1-imn-0","blue")'>q1-imn-0</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-imn-0">The CUSTOM action with label <b>q1-imn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_8.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_8.datq1-rmn-p1" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-rmn-p1","data/Steinhardt.md_working_8.datq1-rmn-p1","blue")'>q1-rmn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-rmn-p1">The CUSTOM action with label <b>q1-rmn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_8.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_8.datq1-imn-p1" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-imn-p1","data/Steinhardt.md_working_8.datq1-imn-p1","blue")'>q1-imn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-imn-p1">The CUSTOM action with label <b>q1-imn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datsp">sp.im-p1</b>,<b name="data/Steinhardt.md_working_8.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Now calculate the mean for each m value.  The output from these six actions are scalars</span>
<b name="data/Steinhardt.md_working_8.datq1-rms-n1" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-rms-n1","data/Steinhardt.md_working_8.datq1-rms-n1","black")'>q1-rms-n1</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-rms-n1">The MEAN action with label <b>q1-rms-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rms-n1</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datq1-rmn-n1">q1-rmn-n1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_8.datq1-ims-n1" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-ims-n1","data/Steinhardt.md_working_8.datq1-ims-n1","black")'>q1-ims-n1</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-ims-n1">The MEAN action with label <b>q1-ims-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-ims-n1</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datq1-imn-n1">q1-imn-n1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_8.datq1-rms-0" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-rms-0","data/Steinhardt.md_working_8.datq1-rms-0","black")'>q1-rms-0</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-rms-0">The MEAN action with label <b>q1-rms-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rms-0</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datq1-rmn-0">q1-rmn-0</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_8.datq1-ims-0" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-ims-0","data/Steinhardt.md_working_8.datq1-ims-0","black")'>q1-ims-0</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-ims-0">The MEAN action with label <b>q1-ims-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-ims-0</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datq1-imn-0">q1-imn-0</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_8.datq1-rms-p1" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-rms-p1","data/Steinhardt.md_working_8.datq1-rms-p1","black")'>q1-rms-p1</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-rms-p1">The MEAN action with label <b>q1-rms-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rms-p1</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datq1-rmn-p1">q1-rmn-p1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_8.datq1-ims-p1" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1-ims-p1","data/Steinhardt.md_working_8.datq1-ims-p1","black")'>q1-ims-p1</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1-ims-p1">The MEAN action with label <b>q1-ims-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-ims-p1</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datq1-imn-p1">q1-imn-p1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Now calculate the sum of the squares</span>
<b name="data/Steinhardt.md_working_8.datq1_mean2" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1_mean2","data/Steinhardt.md_working_8.datq1_mean2","black")'>q1_mean2</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1_mean2">The COMBINE action with label <b>q1_mean2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_mean2</td><td width="5%"><font color="black">scalar</font></td><td>a linear compbination</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datq1-rms-n1">q1-rms-n1</b>,<b name="data/Steinhardt.md_working_8.datq1-ims-n1">q1-ims-n1</b>,<b name="data/Steinhardt.md_working_8.datq1-rms-0">q1-rms-0</b>,<b name="data/Steinhardt.md_working_8.datq1-ims-0">q1-ims-0</b>,<b name="data/Steinhardt.md_working_8.datq1-rms-p1">q1-rms-p1</b>,<b name="data/Steinhardt.md_working_8.datq1-ims-p1">q1-ims-p1</b>
<span style="color:blue" class="comment"># Take the square root </span>
<b name="data/Steinhardt.md_working_8.datq1_mean" onclick='showPath("data/Steinhardt.md_working_8.dat","data/Steinhardt.md_working_8.datq1_mean","data/Steinhardt.md_working_8.datq1_mean","black")'>q1_mean</b><span style="display:none;" id="data/Steinhardt.md_working_8.datq1_mean">The CUSTOM action with label <b>q1_mean</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_mean</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datq1_mean2">q1_mean2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Print the final value</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_8.datq1_mean">q1_mean</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

The quantity that has been computed by this input is:

$$
\langle q_l \rangle = \sqrt{ \sum_{m=-l}^l | \langle q_{lm} \rangle |^2 } \qquad \textrm{where} \qquad \langle q_{lm} \rangle = \frac{1}{N} \sum_{i=1}^N q_{lm}(i) 
$$

This quantity can also be calculated using the following shortcut input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_9.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_9.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_9.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span id="data/Steinhardt.md_working_9.datq1_short"><b name="data/Steinhardt.md_working_9.datq1" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1","data/Steinhardt.md_working_9.datq1_shortcut","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_shortcut">The Q1 action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the norms of the vectors of spherical harmonic coefficients</td></tr></table></span>: <span class="plumedtooltip" style="color:green">Q1<span class="right">Calculate 1st order Steinhardt parameters This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_9.datq1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/Q1">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">VMEAN<span class="right"> calculate the norm of the mean vector<i></i></span></span>
</span><span id="data/Steinhardt.md_working_9.datq1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_9.datq1")'># q1: Q1 SPECIES=1-100 SWITCH={RATIONAL D_0=2.0 R_0=1.0} VMEAN</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_9.datq1_grp" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_grp","data/Steinhardt.md_working_9.datq1_grp","violet")'>q1_grp</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_grp">The GROUP action with label <b>q1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=1-100
<b name="data/Steinhardt.md_working_9.datq1_mat" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_mat","data/Steinhardt.md_working_9.datq1_mat","red")'>q1_mat</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_mat">The CONTACT_MATRIX action with label <b>q1_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_mat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">q1_mat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">q1_mat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">q1_mat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span>
<b name="data/Steinhardt.md_working_9.datq1_sh" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_sh","data/Steinhardt.md_working_9.datq1_sh","red")'>q1_sh</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_sh">The SPHERICAL_HARMONIC action with label <b>q1_sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_mat">q1_mat.x</b>,<b name="data/Steinhardt.md_working_9.datq1_mat">q1_mat.y</b>,<b name="data/Steinhardt.md_working_9.datq1_mat">q1_mat.z</b>,<b name="data/Steinhardt.md_working_9.datq1_mat">q1_mat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_9.datq1_denom_ones" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_denom_ones","data/Steinhardt.md_working_9.datq1_denom_ones","blue")'>q1_denom_ones</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_denom_ones">The CONSTANT action with label <b>q1_denom_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_9.datq1_denom" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_denom","data/Steinhardt.md_working_9.datq1_denom","blue")'>q1_denom</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_denom">The MATRIX_VECTOR_PRODUCT action with label <b>q1_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_mat">q1_mat.w</b>,<b name="data/Steinhardt.md_working_9.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_9.datq1_sp" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_sp","data/Steinhardt.md_working_9.datq1_sp","blue")'>q1_sp</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_sp">The MATRIX_VECTOR_PRODUCT action with label <b>q1_sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-p1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-p1 and the vector q1_denom_ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_sh">q1_sh.*</b>,<b name="data/Steinhardt.md_working_9.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_9.datq1_rmn-n1" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_rmn-n1","data/Steinhardt.md_working_9.datq1_rmn-n1","blue")'>q1_rmn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_rmn-n1">The CUSTOM action with label <b>q1_rmn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_rmn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_9.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_imn-n1" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_imn-n1","data/Steinhardt.md_working_9.datq1_imn-n1","blue")'>q1_imn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_imn-n1">The CUSTOM action with label <b>q1_imn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_imn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.im-n1</b>,<b name="data/Steinhardt.md_working_9.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_rmn-0" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_rmn-0","data/Steinhardt.md_working_9.datq1_rmn-0","blue")'>q1_rmn-0</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_rmn-0">The CUSTOM action with label <b>q1_rmn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_rmn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.rm-0</b>,<b name="data/Steinhardt.md_working_9.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_imn-0" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_imn-0","data/Steinhardt.md_working_9.datq1_imn-0","blue")'>q1_imn-0</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_imn-0">The CUSTOM action with label <b>q1_imn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_imn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.im-0</b>,<b name="data/Steinhardt.md_working_9.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_rmn-p1" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_rmn-p1","data/Steinhardt.md_working_9.datq1_rmn-p1","blue")'>q1_rmn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_rmn-p1">The CUSTOM action with label <b>q1_rmn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_rmn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_9.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_imn-p1" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_imn-p1","data/Steinhardt.md_working_9.datq1_imn-p1","blue")'>q1_imn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_imn-p1">The CUSTOM action with label <b>q1_imn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_imn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.im-p1</b>,<b name="data/Steinhardt.md_working_9.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_rms-n1" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_rms-n1","data/Steinhardt.md_working_9.datq1_rms-n1","black")'>q1_rms-n1</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_rms-n1">The MEAN action with label <b>q1_rms-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_rms-n1</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_rmn-n1">q1_rmn-n1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_ims-n1" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_ims-n1","data/Steinhardt.md_working_9.datq1_ims-n1","black")'>q1_ims-n1</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_ims-n1">The MEAN action with label <b>q1_ims-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_ims-n1</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_imn-n1">q1_imn-n1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_rms-0" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_rms-0","data/Steinhardt.md_working_9.datq1_rms-0","black")'>q1_rms-0</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_rms-0">The MEAN action with label <b>q1_rms-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_rms-0</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_rmn-0">q1_rmn-0</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_ims-0" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_ims-0","data/Steinhardt.md_working_9.datq1_ims-0","black")'>q1_ims-0</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_ims-0">The MEAN action with label <b>q1_ims-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_ims-0</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_imn-0">q1_imn-0</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_rms-p1" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_rms-p1","data/Steinhardt.md_working_9.datq1_rms-p1","black")'>q1_rms-p1</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_rms-p1">The MEAN action with label <b>q1_rms-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_rms-p1</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_rmn-p1">q1_rmn-p1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_ims-p1" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_ims-p1","data/Steinhardt.md_working_9.datq1_ims-p1","black")'>q1_ims-p1</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_ims-p1">The MEAN action with label <b>q1_ims-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_ims-p1</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_imn-p1">q1_imn-p1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_vmean2" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_vmean2","data/Steinhardt.md_working_9.datq1_vmean2","black")'>q1_vmean2</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_vmean2">The COMBINE action with label <b>q1_vmean2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_vmean2</td><td width="5%"><font color="black">scalar</font></td><td>a linear compbination</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_rms-n1">q1_rms-n1</b>,<b name="data/Steinhardt.md_working_9.datq1_ims-n1">q1_ims-n1</b>,<b name="data/Steinhardt.md_working_9.datq1_rms-0">q1_rms-0</b>,<b name="data/Steinhardt.md_working_9.datq1_ims-0">q1_ims-0</b>,<b name="data/Steinhardt.md_working_9.datq1_rms-p1">q1_rms-p1</b>,<b name="data/Steinhardt.md_working_9.datq1_ims-p1">q1_ims-p1</b>
<b name="data/Steinhardt.md_working_9.datq1_vmean" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_vmean","data/Steinhardt.md_working_9.datq1_vmean","black")'>q1_vmean</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_vmean">The CUSTOM action with label <b>q1_vmean</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_vmean</td><td width="5%"><font color="black">scalar</font></td><td>an arbitrary function</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_vmean2">q1_vmean2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1_norm2" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_norm2","data/Steinhardt.md_working_9.datq1_norm2","blue")'>q1_norm2</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_norm2">The COMBINE action with label <b>q1_norm2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.im-n1</b>,<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.rm-0</b>,<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.im-0</b>,<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_9.datq1_sp">q1_sp.im-p1</b>
<b name="data/Steinhardt.md_working_9.datq1_norm" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1_norm","data/Steinhardt.md_working_9.datq1_norm","blue")'>q1_norm</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1_norm">The CUSTOM action with label <b>q1_norm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_norm2">q1_norm2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_9.datq1" onclick='showPath("data/Steinhardt.md_working_9.dat","data/Steinhardt.md_working_9.datq1","data/Steinhardt.md_working_9.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_9.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_norm">q1_norm</b>,<b name="data/Steinhardt.md_working_9.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_9.datq1_vmean">q1_vmean</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

These are probably not the only two ways of averaging over all the Steinhardt parameters.  I hope, however, that from these two examples you can see just how much 
flexibility can be achieved by only modifying the input file.

# Calculating Leichner-Delago-style Steinhardt order parameters

In [this paper](https://arxiv.org/abs/0806.3345) Leichner and Delago proposed calculating local averages of the Steinhardt parameters.  In PLUMED you can calculate these 
order parameters using the following shortcut action:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_10.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_10.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_10.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the Steinhardt parameters</span>
<span id="data/Steinhardt.md_working_10.datq6_short"><b name="data/Steinhardt.md_working_10.datq6" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6","data/Steinhardt.md_working_10.datq6_shortcut","blue")'>q6</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_shortcut">The Q6 action with label <b>q6</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6</td><td width="5%"><font color="blue">vector</font></td><td>the norms of the vectors of spherical harmonic coefficients</td></tr></table></span>: <span class="plumedtooltip" style="color:green">Q6<span class="right">Calculate sixth order Steinhardt parameters. This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_10.datq6");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/Q6">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
</span><span id="data/Steinhardt.md_working_10.datq6_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_10.datq6")'># q6: Q6 SPECIES=1-100 SWITCH={RATIONAL D_0=2.0 R_0=1.0}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_10.datq6_grp" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_grp","data/Steinhardt.md_working_10.datq6_grp","violet")'>q6_grp</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_grp">The GROUP action with label <b>q6_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=1-100
<b name="data/Steinhardt.md_working_10.datq6_mat" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_mat","data/Steinhardt.md_working_10.datq6_mat","red")'>q6_mat</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_mat">The CONTACT_MATRIX action with label <b>q6_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_mat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">q6_mat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">q6_mat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">q6_mat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span>
<b name="data/Steinhardt.md_working_10.datq6_sh" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_sh","data/Steinhardt.md_working_10.datq6_sh","red")'>q6_sh</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_sh">The SPHERICAL_HARMONIC action with label <b>q6_sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_sh.rm-n6</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n6th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-n5</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n5th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-n4</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n4th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-n3</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n3th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-n2</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n2th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-p2</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p2th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-p3</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p3th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-p4</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p4th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-p5</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p5th of these quantities</td></tr><tr><td width="5%">q6_sh.rm-p6</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p6th of these quantities</td></tr><tr><td width="5%">q6_sh.im-n6</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n6th of these quantities</td></tr><tr><td width="5%">q6_sh.im-n5</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n5th of these quantities</td></tr><tr><td width="5%">q6_sh.im-n4</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n4th of these quantities</td></tr><tr><td width="5%">q6_sh.im-n3</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n3th of these quantities</td></tr><tr><td width="5%">q6_sh.im-n2</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n2th of these quantities</td></tr><tr><td width="5%">q6_sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q6_sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q6_sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">q6_sh.im-p2</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p2th of these quantities</td></tr><tr><td width="5%">q6_sh.im-p3</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p3th of these quantities</td></tr><tr><td width="5%">q6_sh.im-p4</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p4th of these quantities</td></tr><tr><td width="5%">q6_sh.im-p5</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p5th of these quantities</td></tr><tr><td width="5%">q6_sh.im-p6</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p6th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_mat">q6_mat.x</b>,<b name="data/Steinhardt.md_working_10.datq6_mat">q6_mat.y</b>,<b name="data/Steinhardt.md_working_10.datq6_mat">q6_mat.z</b>,<b name="data/Steinhardt.md_working_10.datq6_mat">q6_mat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=6
<b name="data/Steinhardt.md_working_10.datq6_denom_ones" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_denom_ones","data/Steinhardt.md_working_10.datq6_denom_ones","blue")'>q6_denom_ones</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_denom_ones">The CONSTANT action with label <b>q6_denom_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_denom_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_10.datq6_denom" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_denom","data/Steinhardt.md_working_10.datq6_denom","blue")'>q6_denom</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_denom">The MATRIX_VECTOR_PRODUCT action with label <b>q6_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_mat">q6_mat.w</b>,<b name="data/Steinhardt.md_working_10.datq6_denom_ones">q6_denom_ones</b>
<b name="data/Steinhardt.md_working_10.datq6_sp" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_sp","data/Steinhardt.md_working_10.datq6_sp","blue")'>q6_sp</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_sp">The MATRIX_VECTOR_PRODUCT action with label <b>q6_sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_sp.rm-n6</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-n6 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-n5</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-n5 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-n4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-n4 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-n3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-n3 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-n2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-n2 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-n1 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-0 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-p1 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-p2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-p2 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-p3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-p3 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-p4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-p4 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-p5</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-p5 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.rm-p6</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.rm-p6 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-n6</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-n6 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-n5</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-n5 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-n4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-n4 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-n3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-n3 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-n2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-n2 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-n1 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-0 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-p1 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-p2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-p2 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-p3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-p3 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-p4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-p4 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-p5</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-p5 and the vector q6_denom_ones</td></tr><tr><td width="5%">q6_sp.im-p6</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q6_sh.im-p6 and the vector q6_denom_ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sh">q6_sh.*</b>,<b name="data/Steinhardt.md_working_10.datq6_denom_ones">q6_denom_ones</b>
<b name="data/Steinhardt.md_working_10.datq6_norm2" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_norm2","data/Steinhardt.md_working_10.datq6_norm2","blue")'>q6_norm2</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_norm2">The COMBINE action with label <b>q6_norm2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_norm2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n6</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n6</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n5</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n5</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n4</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n4</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n3</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n3</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n2</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n2</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n1</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-0</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-0</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p1</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p2</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p2</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p3</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p3</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p4</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p4</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p5</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p5</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p6</b>,<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p6</b>
<b name="data/Steinhardt.md_working_10.datq6_norm" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_norm","data/Steinhardt.md_working_10.datq6_norm","blue")'>q6_norm</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_norm">The CUSTOM action with label <b>q6_norm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_norm</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_norm2">q6_norm2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6","data/Steinhardt.md_working_10.datq6","blue")'>q6</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6">The CUSTOM action with label <b>q6</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_norm">q6_norm</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Take a local average of the Steinhardt parameters</span>
<span id="data/Steinhardt.md_working_10.datlq6_short"><b name="data/Steinhardt.md_working_10.datlq6" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6","data/Steinhardt.md_working_10.datlq6_shortcut","blue")'>lq6</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_shortcut">The LOCAL_AVERAGE action with label <b>lq6</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6</td><td width="5%"><font color="blue">vector</font></td><td>the values of the local averages</td></tr></table></span>: <span class="plumedtooltip" style="color:green">LOCAL_AVERAGE<span class="right">Calculate averages over spherical regions centered on atoms This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_10.datlq6");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/LOCAL_AVERAGE">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6">q6</b> <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=3.0 R_0=1.5}
</span><span id="data/Steinhardt.md_working_10.datlq6_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_10.datlq6")'># lq6: LOCAL_AVERAGE SPECIES=q6 SWITCH={RATIONAL D_0=3.0 R_0=1.5}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_10.datlq6_grp" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_grp","data/Steinhardt.md_working_10.datlq6_grp","violet")'>lq6_grp</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_grp">The GROUP action with label <b>lq6_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6">q6</b>
<b name="data/Steinhardt.md_working_10.datlq6_mat" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_mat","data/Steinhardt.md_working_10.datlq6_mat","red")'>lq6_mat</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_mat">The CONTACT_MATRIX action with label <b>lq6_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_mat</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6">q6</b> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=3.0 R_0=1.5}
<b name="data/Steinhardt.md_working_10.datlq6_ones" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_ones","data/Steinhardt.md_working_10.datlq6_ones","blue")'>lq6_ones</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_ones">The CONSTANT action with label <b>lq6_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_10.datlq6_coord" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_coord","data/Steinhardt.md_working_10.datlq6_coord","blue")'>lq6_coord</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_coord">The MATRIX_VECTOR_PRODUCT action with label <b>lq6_coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datlq6_mat">lq6_mat</b>,<b name="data/Steinhardt.md_working_10.datlq6_ones">lq6_ones</b>
<b name="data/Steinhardt.md_working_10.datq6_rmn-n6" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-n6","data/Steinhardt.md_working_10.datq6_rmn-n6","blue")'>q6_rmn-n6</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-n6">The CUSTOM action with label <b>q6_rmn-n6</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-n6</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n6</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-n6" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-n6","data/Steinhardt.md_working_10.datq6_imn-n6","blue")'>q6_imn-n6</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-n6">The CUSTOM action with label <b>q6_imn-n6</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-n6</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n6</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-n5" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-n5","data/Steinhardt.md_working_10.datq6_rmn-n5","blue")'>q6_rmn-n5</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-n5">The CUSTOM action with label <b>q6_rmn-n5</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-n5</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n5</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-n5" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-n5","data/Steinhardt.md_working_10.datq6_imn-n5","blue")'>q6_imn-n5</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-n5">The CUSTOM action with label <b>q6_imn-n5</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-n5</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n5</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-n4" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-n4","data/Steinhardt.md_working_10.datq6_rmn-n4","blue")'>q6_rmn-n4</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-n4">The CUSTOM action with label <b>q6_rmn-n4</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-n4</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n4</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-n4" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-n4","data/Steinhardt.md_working_10.datq6_imn-n4","blue")'>q6_imn-n4</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-n4">The CUSTOM action with label <b>q6_imn-n4</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-n4</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n4</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-n3" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-n3","data/Steinhardt.md_working_10.datq6_rmn-n3","blue")'>q6_rmn-n3</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-n3">The CUSTOM action with label <b>q6_rmn-n3</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-n3</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n3</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-n3" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-n3","data/Steinhardt.md_working_10.datq6_imn-n3","blue")'>q6_imn-n3</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-n3">The CUSTOM action with label <b>q6_imn-n3</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-n3</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n3</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-n2" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-n2","data/Steinhardt.md_working_10.datq6_rmn-n2","blue")'>q6_rmn-n2</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-n2">The CUSTOM action with label <b>q6_rmn-n2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-n2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n2</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-n2" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-n2","data/Steinhardt.md_working_10.datq6_imn-n2","blue")'>q6_imn-n2</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-n2">The CUSTOM action with label <b>q6_imn-n2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-n2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n2</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-n1" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-n1","data/Steinhardt.md_working_10.datq6_rmn-n1","blue")'>q6_rmn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-n1">The CUSTOM action with label <b>q6_rmn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-n1" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-n1","data/Steinhardt.md_working_10.datq6_imn-n1","blue")'>q6_imn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-n1">The CUSTOM action with label <b>q6_imn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-n1</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-0" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-0","data/Steinhardt.md_working_10.datq6_rmn-0","blue")'>q6_rmn-0</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-0">The CUSTOM action with label <b>q6_rmn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-0</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-0" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-0","data/Steinhardt.md_working_10.datq6_imn-0","blue")'>q6_imn-0</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-0">The CUSTOM action with label <b>q6_imn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-0</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-p1" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-p1","data/Steinhardt.md_working_10.datq6_rmn-p1","blue")'>q6_rmn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-p1">The CUSTOM action with label <b>q6_rmn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-p1" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-p1","data/Steinhardt.md_working_10.datq6_imn-p1","blue")'>q6_imn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-p1">The CUSTOM action with label <b>q6_imn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p1</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-p2" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-p2","data/Steinhardt.md_working_10.datq6_rmn-p2","blue")'>q6_rmn-p2</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-p2">The CUSTOM action with label <b>q6_rmn-p2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-p2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p2</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-p2" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-p2","data/Steinhardt.md_working_10.datq6_imn-p2","blue")'>q6_imn-p2</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-p2">The CUSTOM action with label <b>q6_imn-p2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-p2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p2</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-p3" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-p3","data/Steinhardt.md_working_10.datq6_rmn-p3","blue")'>q6_rmn-p3</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-p3">The CUSTOM action with label <b>q6_rmn-p3</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-p3</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p3</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-p3" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-p3","data/Steinhardt.md_working_10.datq6_imn-p3","blue")'>q6_imn-p3</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-p3">The CUSTOM action with label <b>q6_imn-p3</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-p3</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p3</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-p4" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-p4","data/Steinhardt.md_working_10.datq6_rmn-p4","blue")'>q6_rmn-p4</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-p4">The CUSTOM action with label <b>q6_rmn-p4</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-p4</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p4</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-p4" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-p4","data/Steinhardt.md_working_10.datq6_imn-p4","blue")'>q6_imn-p4</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-p4">The CUSTOM action with label <b>q6_imn-p4</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-p4</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p4</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-p5" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-p5","data/Steinhardt.md_working_10.datq6_rmn-p5","blue")'>q6_rmn-p5</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-p5">The CUSTOM action with label <b>q6_rmn-p5</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-p5</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p5</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-p5" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-p5","data/Steinhardt.md_working_10.datq6_imn-p5","blue")'>q6_imn-p5</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-p5">The CUSTOM action with label <b>q6_imn-p5</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-p5</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p5</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_rmn-p6" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_rmn-p6","data/Steinhardt.md_working_10.datq6_rmn-p6","blue")'>q6_rmn-p6</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_rmn-p6">The CUSTOM action with label <b>q6_rmn-p6</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_rmn-p6</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.rm-p6</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datq6_imn-p6" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datq6_imn-p6","data/Steinhardt.md_working_10.datq6_imn-p6","blue")'>q6_imn-p6</b><span style="display:none;" id="data/Steinhardt.md_working_10.datq6_imn-p6">The CUSTOM action with label <b>q6_imn-p6</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q6_imn-p6</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_sp">q6_sp.im-p6</b>,<b name="data/Steinhardt.md_working_10.datq6_denom">q6_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datlq6_vstack" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_vstack","data/Steinhardt.md_working_10.datlq6_vstack","red")'>lq6_vstack</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_vstack">The VSTACK action with label <b>lq6_vstack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_vstack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datq6_rmn-n6">q6_rmn-n6</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n6">q6_imn-n6</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n5">q6_rmn-n5</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n5">q6_imn-n5</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n4">q6_rmn-n4</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n4">q6_imn-n4</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n3">q6_rmn-n3</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n3">q6_imn-n3</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n2">q6_rmn-n2</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n2">q6_imn-n2</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n1">q6_rmn-n1</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n1">q6_imn-n1</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-0">q6_rmn-0</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-0">q6_imn-0</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p1">q6_rmn-p1</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p1">q6_imn-p1</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p2">q6_rmn-p2</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p2">q6_imn-p2</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p3">q6_rmn-p3</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p3">q6_imn-p3</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p4">q6_rmn-p4</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p4">q6_imn-p4</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p5">q6_rmn-p5</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p5">q6_imn-p5</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p6">q6_rmn-p6</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p6">q6_imn-p6</b>
<b name="data/Steinhardt.md_working_10.datlq6_prod" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_prod","data/Steinhardt.md_working_10.datlq6_prod","blue")'>lq6_prod</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_prod">The MATRIX_VECTOR_PRODUCT action with label <b>lq6_prod</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_prod.q6_rmn-n6</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-n6</td></tr><tr><td width="5%">lq6_prod.q6_imn-n6</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-n6</td></tr><tr><td width="5%">lq6_prod.q6_rmn-n5</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-n5</td></tr><tr><td width="5%">lq6_prod.q6_imn-n5</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-n5</td></tr><tr><td width="5%">lq6_prod.q6_rmn-n4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-n4</td></tr><tr><td width="5%">lq6_prod.q6_imn-n4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-n4</td></tr><tr><td width="5%">lq6_prod.q6_rmn-n3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-n3</td></tr><tr><td width="5%">lq6_prod.q6_imn-n3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-n3</td></tr><tr><td width="5%">lq6_prod.q6_rmn-n2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-n2</td></tr><tr><td width="5%">lq6_prod.q6_imn-n2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-n2</td></tr><tr><td width="5%">lq6_prod.q6_rmn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-n1</td></tr><tr><td width="5%">lq6_prod.q6_imn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-n1</td></tr><tr><td width="5%">lq6_prod.q6_rmn-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-0</td></tr><tr><td width="5%">lq6_prod.q6_imn-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-0</td></tr><tr><td width="5%">lq6_prod.q6_rmn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-p1</td></tr><tr><td width="5%">lq6_prod.q6_imn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-p1</td></tr><tr><td width="5%">lq6_prod.q6_rmn-p2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-p2</td></tr><tr><td width="5%">lq6_prod.q6_imn-p2</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-p2</td></tr><tr><td width="5%">lq6_prod.q6_rmn-p3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-p3</td></tr><tr><td width="5%">lq6_prod.q6_imn-p3</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-p3</td></tr><tr><td width="5%">lq6_prod.q6_rmn-p4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-p4</td></tr><tr><td width="5%">lq6_prod.q6_imn-p4</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-p4</td></tr><tr><td width="5%">lq6_prod.q6_rmn-p5</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-p5</td></tr><tr><td width="5%">lq6_prod.q6_imn-p5</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-p5</td></tr><tr><td width="5%">lq6_prod.q6_rmn-p6</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_rmn-p6</td></tr><tr><td width="5%">lq6_prod.q6_imn-p6</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix lq6_mat and the vector q6_imn-p6</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datlq6_mat">lq6_mat</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n6">q6_rmn-n6</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n6">q6_imn-n6</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n5">q6_rmn-n5</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n5">q6_imn-n5</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n4">q6_rmn-n4</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n4">q6_imn-n4</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n3">q6_rmn-n3</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n3">q6_imn-n3</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n2">q6_rmn-n2</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n2">q6_imn-n2</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-n1">q6_rmn-n1</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-n1">q6_imn-n1</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-0">q6_rmn-0</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-0">q6_imn-0</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p1">q6_rmn-p1</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p1">q6_imn-p1</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p2">q6_rmn-p2</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p2">q6_imn-p2</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p3">q6_rmn-p3</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p3">q6_imn-p3</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p4">q6_rmn-p4</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p4">q6_imn-p4</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p5">q6_rmn-p5</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p5">q6_imn-p5</b>,<b name="data/Steinhardt.md_working_10.datq6_rmn-p6">q6_rmn-p6</b>,<b name="data/Steinhardt.md_working_10.datq6_imn-p6">q6_imn-p6</b>
<b name="data/Steinhardt.md_working_10.datlq6_vpstack" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_vpstack","data/Steinhardt.md_working_10.datlq6_vpstack","red")'>lq6_vpstack</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_vpstack">The VSTACK action with label <b>lq6_vpstack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_vpstack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-n6</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-n6</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-n5</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-n5</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-n4</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-n4</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-n3</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-n3</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-n2</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-n2</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-n1</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-n1</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-0</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-0</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-p1</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-p1</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-p2</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-p2</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-p3</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-p3</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-p4</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-p4</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-p5</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-p5</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_rmn-p6</b>,<b name="data/Steinhardt.md_working_10.datlq6_prod">lq6_prod.q6_imn-p6</b>
<b name="data/Steinhardt.md_working_10.datlq6_lones" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_lones","data/Steinhardt.md_working_10.datlq6_lones","blue")'>lq6_lones</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_lones">The CONSTANT action with label <b>lq6_lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_lones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=26
<b name="data/Steinhardt.md_working_10.datlq6_unorm" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_unorm","data/Steinhardt.md_working_10.datlq6_unorm","red")'>lq6_unorm</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_unorm">The OUTER_PRODUCT action with label <b>lq6_unorm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_unorm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datlq6_coord">lq6_coord</b>,<b name="data/Steinhardt.md_working_10.datlq6_lones">lq6_lones</b>
<b name="data/Steinhardt.md_working_10.datlq6_av" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_av","data/Steinhardt.md_working_10.datlq6_av","red")'>lq6_av</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_av">The CUSTOM action with label <b>lq6_av</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_av</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datlq6_vpstack">lq6_vpstack</b>,<b name="data/Steinhardt.md_working_10.datlq6_vstack">lq6_vstack</b>,<b name="data/Steinhardt.md_working_10.datlq6_unorm">lq6_unorm</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=(x+y)/(1+z) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datlq6_av2" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_av2","data/Steinhardt.md_working_10.datlq6_av2","red")'>lq6_av2</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_av2">The CUSTOM action with label <b>lq6_av2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_av2</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datlq6_av">lq6_av</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*x <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_10.datlq6_2" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6_2","data/Steinhardt.md_working_10.datlq6_2","blue")'>lq6_2</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6_2">The MATRIX_VECTOR_PRODUCT action with label <b>lq6_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datlq6_av2">lq6_av2</b>,<b name="data/Steinhardt.md_working_10.datlq6_lones">lq6_lones</b>
<b name="data/Steinhardt.md_working_10.datlq6" onclick='showPath("data/Steinhardt.md_working_10.dat","data/Steinhardt.md_working_10.datlq6","data/Steinhardt.md_working_10.datlq6","blue")'>lq6</b><span style="display:none;" id="data/Steinhardt.md_working_10.datlq6">The CUSTOM action with label <b>lq6</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq6</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datlq6_2">lq6_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># This prints out the vector of 100 locally averaged order paraemters</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_10.datlq6">lq6</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

The expanded version of this shortcut looks rather complicated so lets consider a simpler calculation first.  In the following input I am calculating a locally averaged 
value for the coordination number:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_11.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_11.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_11.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the coordination numbers of the first 100 atoms in the system in the usual way.</span>
<span style="color:blue" class="comment"># In other words, compute the contact matrix and multiply this matrix by a vector containing all ones.</span>
<b name="data/Steinhardt.md_working_11.datcmat" onclick='showPath("data/Steinhardt.md_working_11.dat","data/Steinhardt.md_working_11.datcmat","data/Steinhardt.md_working_11.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_11.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span id="data/Steinhardt.md_working_11.datones_short"><b name="data/Steinhardt.md_working_11.datones" onclick='showPath("data/Steinhardt.md_working_11.dat","data/Steinhardt.md_working_11.datones","data/Steinhardt.md_working_11.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_11.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_11.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
</span><span id="data/Steinhardt.md_working_11.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_11.datones")'># ones: ONES SIZE=100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_11.datones" onclick='showPath("data/Steinhardt.md_working_11.dat","data/Steinhardt.md_working_11.datones","data/Steinhardt.md_working_11.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_11.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><b name="data/Steinhardt.md_working_11.datcoord" onclick='showPath("data/Steinhardt.md_working_11.dat","data/Steinhardt.md_working_11.datcoord","data/Steinhardt.md_working_11.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_11.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_11.datcmat">cmat</b>,<b name="data/Steinhardt.md_working_11.datones">ones</b>
<span style="color:blue" class="comment"># Now calculate a second contact matrix, which we will use for our local averaging.</span>
<b name="data/Steinhardt.md_working_11.datcmat2" onclick='showPath("data/Steinhardt.md_working_11.dat","data/Steinhardt.md_working_11.datcmat2","data/Steinhardt.md_working_11.datcmat2","red")'>cmat2</b><span style="display:none;" id="data/Steinhardt.md_working_11.datcmat2">The CONTACT_MATRIX action with label <b>cmat2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat2</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span style="color:blue" class="comment"># Get a new set of coordination numbers from cmat2 by multiplying above matrix by vector of ones.</span>
<b name="data/Steinhardt.md_working_11.datcoord2" onclick='showPath("data/Steinhardt.md_working_11.dat","data/Steinhardt.md_working_11.datcoord2","data/Steinhardt.md_working_11.datcoord2","blue")'>coord2</b><span style="display:none;" id="data/Steinhardt.md_working_11.datcoord2">The MATRIX_VECTOR_PRODUCT action with label <b>coord2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord2</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_11.datcmat2">cmat2</b>,<b name="data/Steinhardt.md_working_11.datones">ones</b>
<span style="color:blue" class="comment"># Multiply the second contact matrix above by the vector containing the first set of coordination numbers</span>
<span style="color:blue" class="comment"># this gives us a vector that contains the sum of the coordination numbers for all the atoms in the first </span>
<span style="color:blue" class="comment"># coordination spheres</span>
<b name="data/Steinhardt.md_working_11.datprod" onclick='showPath("data/Steinhardt.md_working_11.dat","data/Steinhardt.md_working_11.datprod","data/Steinhardt.md_working_11.datprod","blue")'>prod</b><span style="display:none;" id="data/Steinhardt.md_working_11.datprod">The MATRIX_VECTOR_PRODUCT action with label <b>prod</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prod</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_11.datcmat2">cmat2</b>,<b name="data/Steinhardt.md_working_11.datcoord">coord</b>
<span style="color:blue" class="comment"># And compute the local average of the coordination number by taking the vector (prod) that contains the sum</span>
<span style="color:blue" class="comment"># of the coordination numbers in the first coordination sphere.  Add to this quantity the value of the coordination </span>
<span style="color:blue" class="comment"># number of the central atom and divide this sum by 1 + the number of atoms in the first coordination sphere.</span>
<b name="data/Steinhardt.md_working_11.datlav" onclick='showPath("data/Steinhardt.md_working_11.dat","data/Steinhardt.md_working_11.datlav","data/Steinhardt.md_working_11.datlav","blue")'>lav</b><span style="display:none;" id="data/Steinhardt.md_working_11.datlav">The CUSTOM action with label <b>lav</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lav</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_11.datprod">prod</b>,<b name="data/Steinhardt.md_working_11.datcoord">coord</b>,<b name="data/Steinhardt.md_working_11.datcoord2">coord2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=(x+y)/(1+z) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># This will print out the 100 average values for the local averages of the coordination numbers</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_11.datlav">lav</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar  
</pre>
 {% endraw %} 

The point I want to make with this input is that the heart of this process of taking a local average of a symmetry function involves multiplying the vector of symmetry function 
values by a contact matrix.  In other words, the locally averaged coordination number $\widehat{c}(i)$ can be computed as:

$$
\widehat{c}(i) = \frac{c(i) + \sum_{j\ne i} \sigma(r_{ij})c(j)}{1 + \sum_{j\ne i} \sigma(r_{ij})} 
$$

where $\sigma(r_{ij})$ is a switching function that acts on the distance $r_{ij}$ between atom $i$ and atom $j$ and $c(i)$ is the coordination number of atom $i$.

With that in mind lets now consder the full input for the Leichner and Delago order parameters, which is as follows:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_12.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_12.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_12.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># This is the usual input that we have for computing the Steinhardt parameters that is explained above.</span>
<b name="data/Steinhardt.md_working_12.datcmat" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datcmat","data/Steinhardt.md_working_12.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_12.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span id="data/Steinhardt.md_working_12.datones_short"><b name="data/Steinhardt.md_working_12.datones" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datones","data/Steinhardt.md_working_12.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_12.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_12.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
</span><span id="data/Steinhardt.md_working_12.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_12.datones")'># ones: ONES SIZE=100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_12.datones" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datones","data/Steinhardt.md_working_12.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_12.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><b name="data/Steinhardt.md_working_12.datcoord" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datcoord","data/Steinhardt.md_working_12.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_12.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_12.datones">ones</b>
<b name="data/Steinhardt.md_working_12.datsh" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datsh","data/Steinhardt.md_working_12.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_12.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_12.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_12.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_12.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_12.datsp" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datsp","data/Steinhardt.md_working_12.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_12.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_12.datones">ones</b>
<b name="data/Steinhardt.md_working_12.datq1-rmn-n1" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datq1-rmn-n1","data/Steinhardt.md_working_12.datq1-rmn-n1","blue")'>q1-rmn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_12.datq1-rmn-n1">The CUSTOM action with label <b>q1-rmn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_12.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_12.datq1-imn-n1" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datq1-imn-n1","data/Steinhardt.md_working_12.datq1-imn-n1","blue")'>q1-imn-n1</b><span style="display:none;" id="data/Steinhardt.md_working_12.datq1-imn-n1">The CUSTOM action with label <b>q1-imn-n1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_12.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_12.datq1-rmn-0" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datq1-rmn-0","data/Steinhardt.md_working_12.datq1-rmn-0","blue")'>q1-rmn-0</b><span style="display:none;" id="data/Steinhardt.md_working_12.datq1-rmn-0">The CUSTOM action with label <b>q1-rmn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_12.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_12.datq1-imn-0" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datq1-imn-0","data/Steinhardt.md_working_12.datq1-imn-0","blue")'>q1-imn-0</b><span style="display:none;" id="data/Steinhardt.md_working_12.datq1-imn-0">The CUSTOM action with label <b>q1-imn-0</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-0</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_12.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO 
<b name="data/Steinhardt.md_working_12.datq1-rmn-p1" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datq1-rmn-p1","data/Steinhardt.md_working_12.datq1-rmn-p1","blue")'>q1-rmn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_12.datq1-rmn-p1">The CUSTOM action with label <b>q1-rmn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-rmn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_12.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_12.datq1-imn-p1" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datq1-imn-p1","data/Steinhardt.md_working_12.datq1-imn-p1","blue")'>q1-imn-p1</b><span style="display:none;" id="data/Steinhardt.md_working_12.datq1-imn-p1">The CUSTOM action with label <b>q1-imn-p1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1-imn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datsp">sp.im-p1</b>,<b name="data/Steinhardt.md_working_12.datcoord">coord</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Now lets calculate the contact matrix that we will use for the local averaging</span>
<b name="data/Steinhardt.md_working_12.datcmat2" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datcmat2","data/Steinhardt.md_working_12.datcmat2","red")'>cmat2</b><span style="display:none;" id="data/Steinhardt.md_working_12.datcmat2">The CONTACT_MATRIX action with label <b>cmat2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat2</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span style="color:blue" class="comment"># Get a new set of coordination numbers from cmat2 by multiplying above matrix by vector of ones.</span>
<b name="data/Steinhardt.md_working_12.datcoord2" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datcoord2","data/Steinhardt.md_working_12.datcoord2","blue")'>coord2</b><span style="display:none;" id="data/Steinhardt.md_working_12.datcoord2">The MATRIX_VECTOR_PRODUCT action with label <b>coord2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord2</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datcmat2">cmat2</b>,<b name="data/Steinhardt.md_working_12.datones">ones</b>
<span style="color:blue" class="comment"># This action constructs a 100 x 6 matrix that contains the q_lm(i) values for all the atoms</span>
<b name="data/Steinhardt.md_working_12.datstack" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datstack","data/Steinhardt.md_working_12.datstack","red")'>stack</b><span style="display:none;" id="data/Steinhardt.md_working_12.datstack">The VSTACK action with label <b>stack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">stack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datq1-rmn-n1">q1-rmn-n1</b>,<b name="data/Steinhardt.md_working_12.datq1-imn-n1">q1-imn-n1</b>,<b name="data/Steinhardt.md_working_12.datq1-rmn-0">q1-rmn-0</b>,<b name="data/Steinhardt.md_working_12.datq1-imn-0">q1-imn-0</b>,<b name="data/Steinhardt.md_working_12.datq1-rmn-p1">q1-rmn-p1</b>,<b name="data/Steinhardt.md_working_12.datq1-imn-p1">q1-imn-p1</b> 
<span style="color:blue" class="comment"># We now multiply each 100 element vector of q_lm(i) values by the contact matrix.  The result is</span>
<span style="color:blue" class="comment"># 6 100 element vectors that contain.  Element i in these vector contains the sum of the q_lm(j) values</span>
<span style="color:blue" class="comment"># for those atoms that are in the first coordination sphere of atom i.</span>
<b name="data/Steinhardt.md_working_12.datprod" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datprod","data/Steinhardt.md_working_12.datprod","blue")'>prod</b><span style="display:none;" id="data/Steinhardt.md_working_12.datprod">The MATRIX_VECTOR_PRODUCT action with label <b>prod</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">prod.q1-rmn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix cmat2 and the vector q1-rmn-n1</td></tr><tr><td width="5%">prod.q1-imn-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix cmat2 and the vector q1-imn-n1</td></tr><tr><td width="5%">prod.q1-rmn-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix cmat2 and the vector q1-rmn-0</td></tr><tr><td width="5%">prod.q1-imn-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix cmat2 and the vector q1-imn-0</td></tr><tr><td width="5%">prod.q1-rmn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix cmat2 and the vector q1-rmn-p1</td></tr><tr><td width="5%">prod.q1-imn-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix cmat2 and the vector q1-imn-p1</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datcmat2">cmat2</b>,<b name="data/Steinhardt.md_working_12.datq1-rmn-n1">q1-rmn-n1</b>,<b name="data/Steinhardt.md_working_12.datq1-imn-n1">q1-imn-n1</b>,<b name="data/Steinhardt.md_working_12.datq1-rmn-0">q1-rmn-0</b>,<b name="data/Steinhardt.md_working_12.datq1-imn-0">q1-imn-0</b>,<b name="data/Steinhardt.md_working_12.datq1-rmn-p1">q1-rmn-p1</b>,<b name="data/Steinhardt.md_working_12.datq1-imn-p1">q1-imn-p1</b>
<span style="color:blue" class="comment"># The 6 vectors output by the command above are combined into a 100 x 6 matrix that contains the sums of </span>
<span style="color:blue" class="comment"># the q_lm(i) values for the neighbours of atom i.</span>
<b name="data/Steinhardt.md_working_12.datvpstack" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datvpstack","data/Steinhardt.md_working_12.datvpstack","red")'>vpstack</b><span style="display:none;" id="data/Steinhardt.md_working_12.datvpstack">The VSTACK action with label <b>vpstack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">vpstack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datprod">prod.q1-rmn-n1</b>,<b name="data/Steinhardt.md_working_12.datprod">prod.q1-imn-n1</b>,<b name="data/Steinhardt.md_working_12.datprod">prod.q1-rmn-0</b>,<b name="data/Steinhardt.md_working_12.datprod">prod.q1-imn-0</b>,<b name="data/Steinhardt.md_working_12.datprod">prod.q1-rmn-p1</b>,<b name="data/Steinhardt.md_working_12.datprod">prod.q1-imn-p1</b>
<span style="color:blue" class="comment"># These two commands create a 100 x 6 element matrix.  Every column of this matrix is identical and contains </span>
<span style="color:blue" class="comment"># the 100 coordination numbers for the atoms.</span>
<span id="data/Steinhardt.md_working_12.datlones_short"><b name="data/Steinhardt.md_working_12.datlones" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datlones","data/Steinhardt.md_working_12.datlones_shortcut","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_12.datlones_shortcut">The ONES action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_12.datlones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
</span><span id="data/Steinhardt.md_working_12.datlones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_12.datlones")'># lones: ONES SIZE=6</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_12.datlones" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datlones","data/Steinhardt.md_working_12.datlones","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_12.datlones">The CONSTANT action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span id="data/Steinhardt.md_working_12.datdefunorm_short"><b name="data/Steinhardt.md_working_12.datunorm" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datunorm","data/Steinhardt.md_working_12.datunorm","red")'>unorm</b><span style="display:none;" id="data/Steinhardt.md_working_12.datunorm">The OUTER_PRODUCT action with label <b>unorm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">unorm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_12.datdefunorm");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datcoord2">coord2</b>,<b name="data/Steinhardt.md_working_12.datlones">lones</b>
</span><span id="data/Steinhardt.md_working_12.datdefunorm_long" style="display:none;"><b name="data/Steinhardt.md_working_12.datunorm" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datunorm","data/Steinhardt.md_working_12.datunorm","red")'>unorm</b>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_12.datdefunorm");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datcoord2">coord2</b>,<b name="data/Steinhardt.md_working_12.datlones">lones</b>  <span class="plumedtooltip">FUNC<span class="right"> the function of the input vectors that should be put in the elements of the outer product<i></i></span></span>=x*y
</span><span style="color:blue" class="comment"># We now compute our local averages for q_lm(i).  The output here is a 100 x 6 matrix of local average values for q_lm(i)</span>
<b name="data/Steinhardt.md_working_12.datav" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datav","data/Steinhardt.md_working_12.datav","red")'>av</b><span style="display:none;" id="data/Steinhardt.md_working_12.datav">The CUSTOM action with label <b>av</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">av</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datvpstack">vpstack</b>,<b name="data/Steinhardt.md_working_12.datvpstack">vpstack</b>,<b name="data/Steinhardt.md_working_12.datunorm">unorm</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=(x+y)/(1+z) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Do an element-wise square of the matrix above.  This is not doing matrix multiplication.</span>
<b name="data/Steinhardt.md_working_12.datav2" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.datav2","data/Steinhardt.md_working_12.datav2","red")'>av2</b><span style="display:none;" id="data/Steinhardt.md_working_12.datav2">The CUSTOM action with label <b>av2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">av2</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datav">av</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*x <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># We now multiply our 100x6 matrix by a vector with 6 elements.  The result is a vector with 100 elements - one element</span>
<span style="color:blue" class="comment"># for each atom in the system.  This is essentially the square of the norm of the vectors of locally-averaged q_lm(i) values.</span>
<b name="data/Steinhardt.md_working_12.dataq1_2" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.dataq1_2","data/Steinhardt.md_working_12.dataq1_2","blue")'>aq1_2</b><span style="display:none;" id="data/Steinhardt.md_working_12.dataq1_2">The MATRIX_VECTOR_PRODUCT action with label <b>aq1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">aq1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_12.datav2">av2</b>,<b name="data/Steinhardt.md_working_12.datlones">lones</b> 
<span style="color:blue" class="comment"># And these are the norms of the vectors of locally-averaged q_lm(i) values.</span>
<b name="data/Steinhardt.md_working_12.dataq1" onclick='showPath("data/Steinhardt.md_working_12.dat","data/Steinhardt.md_working_12.dataq1","data/Steinhardt.md_working_12.dataq1","blue")'>aq1</b><span style="display:none;" id="data/Steinhardt.md_working_12.dataq1">The CUSTOM action with label <b>aq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">aq1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_12.dataq1_2">aq1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># We now print out our 100 locally averaged q_l values.</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_12.dataq1">aq1</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

Notice that we do the same here as we did with the coordination number input.  In other words, we calculate locally-averaged versions of the $q_{lm}(i)$ parameters using:

$$
\widehat{q}{lm}(i) = \frac{q_{lm}(i) + \sum_{j\ne i} \sigma(r_{ij})q_{lm}(j)}{1 + \sum_{j\ne i} \sigma(r_{ij})}
$$

The final, locally-averaged version of $\widehat{q}_l(i)$ is then defined as:

$$
\widehat{q}_{l}(i) = \sqrt{ \sum_{m=-l}^l | \widehat{q}_{lm}(i) |^2 }
$$

which is the familiar summing over the $l$ values that we have seen in earlier sectioms to make the final symmetry function rotationally invariant.

# Calculating ten-Wolde-Frenkel-style Steinhard order parameters

Before discussing how the ten-Wolde-Frenkel order parameters are computed it is useful to introduce yet another variant on the Steinhardt parameter.  This variant is computed as follows

$$
\overline{q}_{lm}(i) = \frac{1}{\overline{q}_l} \sum_{j \ne i } \sigma(r_{ij})Y_l^m(\theta_{ij},\phi_{ij}) \qquad \textrm{where} \qquad \overline{q}_l(i) = \sqrt{ \sum_{m=-l}^l |q_{lm}(i)|^2 }
$$ 

As always $\sigma(r_{ij})$ is a switching function that acts on the distance, $r_{ij}$, between atom $i$ and atom $j$.  $Y_l^m(\theta_{ij},\phi_{ij})$ is then the spherical harmonic function which depends
on the direction the bond between atom $i$ and atom $j$ point in.  Notice that this version of the Steinhardt parameter has the followign property:

$$
\sum_{m=-l}^l \overline{q}_{lm}(i)^{*} \overline{q}_{lm}(i) = 1
$$

We can compute the $\overline{q}_{lm}(i)$ values in PLUMED using the following input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_13.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_13.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_13.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># This is the usual input that we have for computing the Steinhardt parameters that is explained above.</span>
<b name="data/Steinhardt.md_working_13.datcmat" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datcmat","data/Steinhardt.md_working_13.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_13.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span id="data/Steinhardt.md_working_13.datones_short"><b name="data/Steinhardt.md_working_13.datones" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datones","data/Steinhardt.md_working_13.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_13.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_13.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
</span><span id="data/Steinhardt.md_working_13.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_13.datones")'># ones: ONES SIZE=100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_13.datones" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datones","data/Steinhardt.md_working_13.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_13.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><b name="data/Steinhardt.md_working_13.datcoord" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datcoord","data/Steinhardt.md_working_13.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_13.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_13.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_13.datones">ones</b> 
<b name="data/Steinhardt.md_working_13.datsh" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datsh","data/Steinhardt.md_working_13.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_13.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_13.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_13.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_13.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_13.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_13.datsp" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datsp","data/Steinhardt.md_working_13.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_13.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_13.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_13.datones">ones</b>
<span style="color:blue" class="comment"># This calculates the sum of the squares of the unormalized \overline{q}_lm(i) values.</span>
<b name="data/Steinhardt.md_working_13.datq1_2" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datq1_2","data/Steinhardt.md_working_13.datq1_2","blue")'>q1_2</b><span style="display:none;" id="data/Steinhardt.md_working_13.datq1_2">The COMBINE action with label <b>q1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_13.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_13.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_13.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_13.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_13.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_13.datsp">sp.im-p1</b>
<span style="color:blue" class="comment"># This calculates \overline{q}_l(i)</span>
<b name="data/Steinhardt.md_working_13.datq1" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datq1","data/Steinhardt.md_working_13.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_13.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_13.datq1_2">q1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Create a 100 x 6 matrix to hold all the unofrmalised \overline{q}_lm(i) values.</span>
<b name="data/Steinhardt.md_working_13.datstack" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datstack","data/Steinhardt.md_working_13.datstack","red")'>stack</b><span style="display:none;" id="data/Steinhardt.md_working_13.datstack">The VSTACK action with label <b>stack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">stack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_13.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_13.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_13.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_13.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_13.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_13.datsp">sp.im-p1</b>
<span style="color:blue" class="comment"># Create a second 100 x 6 matrix.  All the columns of this matrix are identical.  They just contain the 100 \overline{q}_l(i) values.</span>
<span id="data/Steinhardt.md_working_13.datlones_short"><b name="data/Steinhardt.md_working_13.datlones" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datlones","data/Steinhardt.md_working_13.datlones_shortcut","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_13.datlones_shortcut">The ONES action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_13.datlones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
</span><span id="data/Steinhardt.md_working_13.datlones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_13.datlones")'># lones: ONES SIZE=6</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_13.datlones" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datlones","data/Steinhardt.md_working_13.datlones","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_13.datlones">The CONSTANT action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span id="data/Steinhardt.md_working_13.datdefunorm_short"><b name="data/Steinhardt.md_working_13.datunorm" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datunorm","data/Steinhardt.md_working_13.datunorm","red")'>unorm</b><span style="display:none;" id="data/Steinhardt.md_working_13.datunorm">The OUTER_PRODUCT action with label <b>unorm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">unorm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_13.datdefunorm");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_13.datq1">q1</b>,<b name="data/Steinhardt.md_working_13.datlones">lones</b>
</span><span id="data/Steinhardt.md_working_13.datdefunorm_long" style="display:none;"><b name="data/Steinhardt.md_working_13.datunorm" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datunorm","data/Steinhardt.md_working_13.datunorm","red")'>unorm</b>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_13.datdefunorm");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_13.datq1">q1</b>,<b name="data/Steinhardt.md_working_13.datlones">lones</b>  <span class="plumedtooltip">FUNC<span class="right"> the function of the input vectors that should be put in the elements of the outer product<i></i></span></span>=x*y
</span><span style="color:blue" class="comment"># We can now calculate the \overline{q}_lm(i) values by dividing the unormalised values by the \overline{q}_l(i).</span>
<span style="color:blue" class="comment"># The output here is a 100 x 6 matrix</span>
<b name="data/Steinhardt.md_working_13.datoq1" onclick='showPath("data/Steinhardt.md_working_13.dat","data/Steinhardt.md_working_13.datoq1","data/Steinhardt.md_working_13.datoq1","red")'>oq1</b><span style="display:none;" id="data/Steinhardt.md_working_13.datoq1">The CUSTOM action with label <b>oq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_13.datstack">stack</b>,<b name="data/Steinhardt.md_working_13.datunorm">unorm</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># And finally print out the 100 x 6 matrix of overline{q}_lm(i) values.</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_13.datoq1">oq1</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

We introduce $\overline{q}_{lm}(i)$ as we can use the following inner product to measure the similarity between the environment around atom $i$ and the environment around atom $j$:

$$
S_{ij} = \sum_{m=-l}^l \overline{q}_{lm}(i)^{*} \overline{q}_{lm}(j)
$$

Notice furthermore that if we have $N$ atoms we can store all the real and imaginary parts of the $\overline{q}_{lm}(i)$ values in an $N \times 2l$ matrix $\mathbf{Q}$.  The 
inner product above can be computed for every pair of atoms in our system by doing the following piece of matrix algebra:

$$
\mathbf{S} = \mathbf{Q} \mathbf{Q}^T
$$

$S$ here is thus an $N\times N$ square matrix.  To calculate this matrix in PLUMED you would do the following:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_14.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_14.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_14.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># These lines compute the matrix of \overline{q}_lm(i) values in the way described above</span>
<b name="data/Steinhardt.md_working_14.datcmat" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datcmat","data/Steinhardt.md_working_14.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_14.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span id="data/Steinhardt.md_working_14.datones_short"><b name="data/Steinhardt.md_working_14.datones" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datones","data/Steinhardt.md_working_14.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_14.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_14.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
</span><span id="data/Steinhardt.md_working_14.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_14.datones")'># ones: ONES SIZE=100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_14.datones" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datones","data/Steinhardt.md_working_14.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_14.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><b name="data/Steinhardt.md_working_14.datcoord" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datcoord","data/Steinhardt.md_working_14.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_14.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_14.datones">ones</b>  
<b name="data/Steinhardt.md_working_14.datsh" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datsh","data/Steinhardt.md_working_14.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_14.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_14.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_14.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_14.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_14.datsp" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datsp","data/Steinhardt.md_working_14.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_14.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_14.datones">ones</b>
<b name="data/Steinhardt.md_working_14.datq1_2" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datq1_2","data/Steinhardt.md_working_14.datq1_2","blue")'>q1_2</b><span style="display:none;" id="data/Steinhardt.md_working_14.datq1_2">The COMBINE action with label <b>q1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_14.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_14.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_14.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_14.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_14.datsp">sp.im-p1</b>
<b name="data/Steinhardt.md_working_14.datq1" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datq1","data/Steinhardt.md_working_14.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_14.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datq1_2">q1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO 
<b name="data/Steinhardt.md_working_14.datstack" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datstack","data/Steinhardt.md_working_14.datstack","red")'>stack</b><span style="display:none;" id="data/Steinhardt.md_working_14.datstack">The VSTACK action with label <b>stack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">stack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_14.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_14.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_14.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_14.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_14.datsp">sp.im-p1</b>
<span id="data/Steinhardt.md_working_14.datlones_short"><b name="data/Steinhardt.md_working_14.datlones" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datlones","data/Steinhardt.md_working_14.datlones_shortcut","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_14.datlones_shortcut">The ONES action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_14.datlones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
</span><span id="data/Steinhardt.md_working_14.datlones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_14.datlones")'># lones: ONES SIZE=6</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_14.datlones" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datlones","data/Steinhardt.md_working_14.datlones","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_14.datlones">The CONSTANT action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span id="data/Steinhardt.md_working_14.datdefunorm_short"><b name="data/Steinhardt.md_working_14.datunorm" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datunorm","data/Steinhardt.md_working_14.datunorm","red")'>unorm</b><span style="display:none;" id="data/Steinhardt.md_working_14.datunorm">The OUTER_PRODUCT action with label <b>unorm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">unorm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_14.datdefunorm");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datq1">q1</b>,<b name="data/Steinhardt.md_working_14.datlones">lones</b>
</span><span id="data/Steinhardt.md_working_14.datdefunorm_long" style="display:none;"><b name="data/Steinhardt.md_working_14.datunorm" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datunorm","data/Steinhardt.md_working_14.datunorm","red")'>unorm</b>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_14.datdefunorm");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datq1">q1</b>,<b name="data/Steinhardt.md_working_14.datlones">lones</b>  <span class="plumedtooltip">FUNC<span class="right"> the function of the input vectors that should be put in the elements of the outer product<i></i></span></span>=x*y
</span><b name="data/Steinhardt.md_working_14.datoq1" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datoq1","data/Steinhardt.md_working_14.datoq1","red")'>oq1</b><span style="display:none;" id="data/Steinhardt.md_working_14.datoq1">The CUSTOM action with label <b>oq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datstack">stack</b>,<b name="data/Steinhardt.md_working_14.datunorm">unorm</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Now transpose the matrix of \overline{q}_lm(i) values</span>
<b name="data/Steinhardt.md_working_14.datoq1T" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.datoq1T","data/Steinhardt.md_working_14.datoq1T","red")'>oq1T</b><span style="display:none;" id="data/Steinhardt.md_working_14.datoq1T">The TRANSPOSE action with label <b>oq1T</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1T</td><td width="5%"><font color="red">matrix</font></td><td>the transpose of the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">TRANSPOSE<span class="right">Calculate the transpose of a matrix <a href="https://www.plumed.org/doc-master/user-doc/html/TRANSPOSE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the vector or matrix that should be transposed<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datoq1">oq1</b>
<span style="color:blue" class="comment"># Calculate the matrix product</span>
<b name="data/Steinhardt.md_working_14.dats" onclick='showPath("data/Steinhardt.md_working_14.dat","data/Steinhardt.md_working_14.dats","data/Steinhardt.md_working_14.dats","red")'>s</b><span style="display:none;" id="data/Steinhardt.md_working_14.dats">The MATRIX_PRODUCT action with label <b>s</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">s</td><td width="5%"><font color="red">matrix</font></td><td>the product of the two input matrices</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_PRODUCT<span class="right">Calculate the product of two matrices <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the two matrices from which the product is calculated<i></i></span></span>=<b name="data/Steinhardt.md_working_14.datoq1">oq1</b>,<b name="data/Steinhardt.md_working_14.datoq1T">oq1T</b>
<span style="color:blue" class="comment"># And output the 100 x 100 matrix of inner products</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_14.dats">s</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

The matrix $\mathbf{S}$ defined above is not the one used when you are computing the ten-Wolde and Frenkel style order parametres.  Element $i,j$ of the matrix, $\mathbf{F}$, that is used when computing the ten-Wolde and Frenkel style order 
parameters is large when atoms $i$ and $j$ are within a certain cutoff of each other AND when the environment around the two atoms are similar.  Element $i,j$ of this matrix is thus computed as:

$$
F_{ij} = \sigma(r_{ij}) \sum_{m=-l}^l \overline{q}_{lm}(i)^{*} \overline{q}_{lm}(j)
$$

where $\sigma$ is a switching function that acts on the distance $r_{ij}$ between atom $i$ and atom $j$.  The full matrix can be computed in PLUMED using the following input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_15.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_15.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_15.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># These lines compute the matrix of \overline{q}_lm(i) values in the way described above</span>
<b name="data/Steinhardt.md_working_15.datcmat" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datcmat","data/Steinhardt.md_working_15.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_15.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span id="data/Steinhardt.md_working_15.datones_short"><b name="data/Steinhardt.md_working_15.datones" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datones","data/Steinhardt.md_working_15.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_15.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_15.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
</span><span id="data/Steinhardt.md_working_15.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_15.datones")'># ones: ONES SIZE=100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_15.datones" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datones","data/Steinhardt.md_working_15.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_15.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><b name="data/Steinhardt.md_working_15.datcoord" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datcoord","data/Steinhardt.md_working_15.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_15.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_15.datones">ones</b>
<b name="data/Steinhardt.md_working_15.datsh" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datsh","data/Steinhardt.md_working_15.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_15.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_15.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_15.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_15.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_15.datsp" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datsp","data/Steinhardt.md_working_15.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_15.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_15.datones">ones</b>
<b name="data/Steinhardt.md_working_15.datq1_2" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datq1_2","data/Steinhardt.md_working_15.datq1_2","blue")'>q1_2</b><span style="display:none;" id="data/Steinhardt.md_working_15.datq1_2">The COMBINE action with label <b>q1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_15.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_15.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_15.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_15.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_15.datsp">sp.im-p1</b>
<b name="data/Steinhardt.md_working_15.datq1" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datq1","data/Steinhardt.md_working_15.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_15.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datq1_2">q1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO 
<b name="data/Steinhardt.md_working_15.datstack" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datstack","data/Steinhardt.md_working_15.datstack","red")'>stack</b><span style="display:none;" id="data/Steinhardt.md_working_15.datstack">The VSTACK action with label <b>stack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">stack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_15.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_15.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_15.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_15.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_15.datsp">sp.im-p1</b>
<span id="data/Steinhardt.md_working_15.datlones_short"><b name="data/Steinhardt.md_working_15.datlones" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datlones","data/Steinhardt.md_working_15.datlones_shortcut","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_15.datlones_shortcut">The ONES action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_15.datlones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
</span><span id="data/Steinhardt.md_working_15.datlones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_15.datlones")'># lones: ONES SIZE=6</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_15.datlones" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datlones","data/Steinhardt.md_working_15.datlones","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_15.datlones">The CONSTANT action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span id="data/Steinhardt.md_working_15.datdefunorm_short"><b name="data/Steinhardt.md_working_15.datunorm" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datunorm","data/Steinhardt.md_working_15.datunorm","red")'>unorm</b><span style="display:none;" id="data/Steinhardt.md_working_15.datunorm">The OUTER_PRODUCT action with label <b>unorm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">unorm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_15.datdefunorm");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datq1">q1</b>,<b name="data/Steinhardt.md_working_15.datlones">lones</b>
</span><span id="data/Steinhardt.md_working_15.datdefunorm_long" style="display:none;"><b name="data/Steinhardt.md_working_15.datunorm" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datunorm","data/Steinhardt.md_working_15.datunorm","red")'>unorm</b>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_15.datdefunorm");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datq1">q1</b>,<b name="data/Steinhardt.md_working_15.datlones">lones</b>  <span class="plumedtooltip">FUNC<span class="right"> the function of the input vectors that should be put in the elements of the outer product<i></i></span></span>=x*y
</span><b name="data/Steinhardt.md_working_15.datoq1" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datoq1","data/Steinhardt.md_working_15.datoq1","red")'>oq1</b><span style="display:none;" id="data/Steinhardt.md_working_15.datoq1">The CUSTOM action with label <b>oq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datstack">stack</b>,<b name="data/Steinhardt.md_working_15.datunorm">unorm</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Now transpose the matrix of \overline{q}_lm(i) values</span>
<b name="data/Steinhardt.md_working_15.datoq1T" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datoq1T","data/Steinhardt.md_working_15.datoq1T","red")'>oq1T</b><span style="display:none;" id="data/Steinhardt.md_working_15.datoq1T">The TRANSPOSE action with label <b>oq1T</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1T</td><td width="5%"><font color="red">matrix</font></td><td>the transpose of the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">TRANSPOSE<span class="right">Calculate the transpose of a matrix <a href="https://www.plumed.org/doc-master/user-doc/html/TRANSPOSE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the vector or matrix that should be transposed<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datoq1">oq1</b>
<span style="color:blue" class="comment"># Calculate a second contact matrix.  This will contain the \sigma(r_ij) values in the second equation above.</span>
<b name="data/Steinhardt.md_working_15.datcmat2" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datcmat2","data/Steinhardt.md_working_15.datcmat2","red")'>cmat2</b><span style="display:none;" id="data/Steinhardt.md_working_15.datcmat2">The CONTACT_MATRIX action with label <b>cmat2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat2</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span style="color:blue" class="comment"># Calculate the matrix product, S, described above</span>
<b name="data/Steinhardt.md_working_15.dats" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.dats","data/Steinhardt.md_working_15.dats","red")'>s</b><span style="display:none;" id="data/Steinhardt.md_working_15.dats">The MATRIX_PRODUCT action with label <b>s</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">s</td><td width="5%"><font color="red">matrix</font></td><td>the product of the two input matrices</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_PRODUCT<span class="right">Calculate the product of two matrices <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the two matrices from which the product is calculated<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datoq1">oq1</b>,<b name="data/Steinhardt.md_working_15.datoq1T">oq1T</b>
<span style="color:blue" class="comment"># Now take the element-wise product of the contact matrix and the matrix of inner products.</span>
<b name="data/Steinhardt.md_working_15.datf" onclick='showPath("data/Steinhardt.md_working_15.dat","data/Steinhardt.md_working_15.datf","data/Steinhardt.md_working_15.datf","red")'>f</b><span style="display:none;" id="data/Steinhardt.md_working_15.datf">The CUSTOM action with label <b>f</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">f</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datcmat2">cmat2</b>,<b name="data/Steinhardt.md_working_15.dats">s</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># And output the 100 x 100 matrix </span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_15.datf">f</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

Once you ahve computed the matrix $F$ there are many things that you can do with it.  You can for instance sum all the elements of the matrix using an input like this:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_16.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_16.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_16.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># These lines compute the matrix F</span>
<b name="data/Steinhardt.md_working_16.datcmat" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datcmat","data/Steinhardt.md_working_16.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_16.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span id="data/Steinhardt.md_working_16.datones_short"><b name="data/Steinhardt.md_working_16.datones" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datones","data/Steinhardt.md_working_16.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_16.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_16.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
</span><span id="data/Steinhardt.md_working_16.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_16.datones")'># ones: ONES SIZE=100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_16.datones" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datones","data/Steinhardt.md_working_16.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_16.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><b name="data/Steinhardt.md_working_16.datcoord" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datcoord","data/Steinhardt.md_working_16.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_16.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_16.datones">ones</b>
<b name="data/Steinhardt.md_working_16.datsh" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datsh","data/Steinhardt.md_working_16.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_16.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_16.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_16.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_16.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_16.datsp" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datsp","data/Steinhardt.md_working_16.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_16.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_16.datones">ones</b>
<b name="data/Steinhardt.md_working_16.datq1_2" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datq1_2","data/Steinhardt.md_working_16.datq1_2","blue")'>q1_2</b><span style="display:none;" id="data/Steinhardt.md_working_16.datq1_2">The COMBINE action with label <b>q1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_16.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_16.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_16.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_16.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_16.datsp">sp.im-p1</b>
<b name="data/Steinhardt.md_working_16.datq1" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datq1","data/Steinhardt.md_working_16.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_16.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datq1_2">q1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_16.datstack" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datstack","data/Steinhardt.md_working_16.datstack","red")'>stack</b><span style="display:none;" id="data/Steinhardt.md_working_16.datstack">The VSTACK action with label <b>stack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">stack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_16.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_16.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_16.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_16.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_16.datsp">sp.im-p1</b>
<span id="data/Steinhardt.md_working_16.datlones_short"><b name="data/Steinhardt.md_working_16.datlones" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datlones","data/Steinhardt.md_working_16.datlones_shortcut","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_16.datlones_shortcut">The ONES action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_16.datlones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
</span><span id="data/Steinhardt.md_working_16.datlones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_16.datlones")'># lones: ONES SIZE=6</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_16.datlones" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datlones","data/Steinhardt.md_working_16.datlones","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_16.datlones">The CONSTANT action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span id="data/Steinhardt.md_working_16.datdefunorm_short"><b name="data/Steinhardt.md_working_16.datunorm" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datunorm","data/Steinhardt.md_working_16.datunorm","red")'>unorm</b><span style="display:none;" id="data/Steinhardt.md_working_16.datunorm">The OUTER_PRODUCT action with label <b>unorm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">unorm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_16.datdefunorm");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datq1">q1</b>,<b name="data/Steinhardt.md_working_16.datlones">lones</b>
</span><span id="data/Steinhardt.md_working_16.datdefunorm_long" style="display:none;"><b name="data/Steinhardt.md_working_16.datunorm" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datunorm","data/Steinhardt.md_working_16.datunorm","red")'>unorm</b>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_16.datdefunorm");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datq1">q1</b>,<b name="data/Steinhardt.md_working_16.datlones">lones</b>  <span class="plumedtooltip">FUNC<span class="right"> the function of the input vectors that should be put in the elements of the outer product<i></i></span></span>=x*y
</span><b name="data/Steinhardt.md_working_16.datoq1" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datoq1","data/Steinhardt.md_working_16.datoq1","red")'>oq1</b><span style="display:none;" id="data/Steinhardt.md_working_16.datoq1">The CUSTOM action with label <b>oq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datstack">stack</b>,<b name="data/Steinhardt.md_working_16.datunorm">unorm</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_16.datoq1T" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datoq1T","data/Steinhardt.md_working_16.datoq1T","red")'>oq1T</b><span style="display:none;" id="data/Steinhardt.md_working_16.datoq1T">The TRANSPOSE action with label <b>oq1T</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1T</td><td width="5%"><font color="red">matrix</font></td><td>the transpose of the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">TRANSPOSE<span class="right">Calculate the transpose of a matrix <a href="https://www.plumed.org/doc-master/user-doc/html/TRANSPOSE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the vector or matrix that should be transposed<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datoq1">oq1</b>
<b name="data/Steinhardt.md_working_16.datcmat2" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datcmat2","data/Steinhardt.md_working_16.datcmat2","red")'>cmat2</b><span style="display:none;" id="data/Steinhardt.md_working_16.datcmat2">The CONTACT_MATRIX action with label <b>cmat2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat2</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<b name="data/Steinhardt.md_working_16.dats" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.dats","data/Steinhardt.md_working_16.dats","red")'>s</b><span style="display:none;" id="data/Steinhardt.md_working_16.dats">The MATRIX_PRODUCT action with label <b>s</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">s</td><td width="5%"><font color="red">matrix</font></td><td>the product of the two input matrices</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_PRODUCT<span class="right">Calculate the product of two matrices <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the two matrices from which the product is calculated<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datoq1">oq1</b>,<b name="data/Steinhardt.md_working_16.datoq1T">oq1T</b>
<b name="data/Steinhardt.md_working_16.datf" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datf","data/Steinhardt.md_working_16.datf","red")'>f</b><span style="display:none;" id="data/Steinhardt.md_working_16.datf">The CUSTOM action with label <b>f</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">f</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datcmat2">cmat2</b>,<b name="data/Steinhardt.md_working_16.dats">s</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Add all the elemnets of the matrix f together</span>
<b name="data/Steinhardt.md_working_16.datfs" onclick='showPath("data/Steinhardt.md_working_16.dat","data/Steinhardt.md_working_16.datfs","data/Steinhardt.md_working_16.datfs","black")'>fs</b><span style="display:none;" id="data/Steinhardt.md_working_16.datfs">The SUM action with label <b>fs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">fs</td><td width="5%"><font color="black">scalar</font></td><td>the SUM of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SUM<span class="right">Calculate the sum of the arguments <a href="https://www.plumed.org/doc-master/user-doc/html/SUM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datf">f</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># This outputs a single scalar</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_16.datfs">fs</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

Some people prefer to apply a switching function to the elements of $F$ before summing like this:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_17.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_17.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_17.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># These lines compute the matrix F</span>
<b name="data/Steinhardt.md_working_17.datcmat" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datcmat","data/Steinhardt.md_working_17.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_17.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span id="data/Steinhardt.md_working_17.datones_short"><b name="data/Steinhardt.md_working_17.datones" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datones","data/Steinhardt.md_working_17.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_17.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_17.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
</span><span id="data/Steinhardt.md_working_17.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_17.datones")'># ones: ONES SIZE=100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_17.datones" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datones","data/Steinhardt.md_working_17.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_17.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><b name="data/Steinhardt.md_working_17.datcoord" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datcoord","data/Steinhardt.md_working_17.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_17.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_17.datones">ones</b>
<b name="data/Steinhardt.md_working_17.datsh" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datsh","data/Steinhardt.md_working_17.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_17.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_17.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_17.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_17.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_17.datsp" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datsp","data/Steinhardt.md_working_17.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_17.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_17.datones">ones</b>
<b name="data/Steinhardt.md_working_17.datq1_2" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datq1_2","data/Steinhardt.md_working_17.datq1_2","blue")'>q1_2</b><span style="display:none;" id="data/Steinhardt.md_working_17.datq1_2">The COMBINE action with label <b>q1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_17.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_17.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_17.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_17.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_17.datsp">sp.im-p1</b>
<b name="data/Steinhardt.md_working_17.datq1" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datq1","data/Steinhardt.md_working_17.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_17.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datq1_2">q1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_17.datstack" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datstack","data/Steinhardt.md_working_17.datstack","red")'>stack</b><span style="display:none;" id="data/Steinhardt.md_working_17.datstack">The VSTACK action with label <b>stack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">stack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_17.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_17.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_17.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_17.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_17.datsp">sp.im-p1</b>
<span id="data/Steinhardt.md_working_17.datlones_short"><b name="data/Steinhardt.md_working_17.datlones" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datlones","data/Steinhardt.md_working_17.datlones_shortcut","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_17.datlones_shortcut">The ONES action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_17.datlones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
</span><span id="data/Steinhardt.md_working_17.datlones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_17.datlones")'># lones: ONES SIZE=6</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_17.datlones" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datlones","data/Steinhardt.md_working_17.datlones","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_17.datlones">The CONSTANT action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span id="data/Steinhardt.md_working_17.datdefunorm_short"><b name="data/Steinhardt.md_working_17.datunorm" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datunorm","data/Steinhardt.md_working_17.datunorm","red")'>unorm</b><span style="display:none;" id="data/Steinhardt.md_working_17.datunorm">The OUTER_PRODUCT action with label <b>unorm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">unorm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_17.datdefunorm");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datq1">q1</b>,<b name="data/Steinhardt.md_working_17.datlones">lones</b>
</span><span id="data/Steinhardt.md_working_17.datdefunorm_long" style="display:none;"><b name="data/Steinhardt.md_working_17.datunorm" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datunorm","data/Steinhardt.md_working_17.datunorm","red")'>unorm</b>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_17.datdefunorm");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datq1">q1</b>,<b name="data/Steinhardt.md_working_17.datlones">lones</b>  <span class="plumedtooltip">FUNC<span class="right"> the function of the input vectors that should be put in the elements of the outer product<i></i></span></span>=x*y
</span><b name="data/Steinhardt.md_working_17.datoq1" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datoq1","data/Steinhardt.md_working_17.datoq1","red")'>oq1</b><span style="display:none;" id="data/Steinhardt.md_working_17.datoq1">The CUSTOM action with label <b>oq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datstack">stack</b>,<b name="data/Steinhardt.md_working_17.datunorm">unorm</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_17.datoq1T" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datoq1T","data/Steinhardt.md_working_17.datoq1T","red")'>oq1T</b><span style="display:none;" id="data/Steinhardt.md_working_17.datoq1T">The TRANSPOSE action with label <b>oq1T</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1T</td><td width="5%"><font color="red">matrix</font></td><td>the transpose of the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">TRANSPOSE<span class="right">Calculate the transpose of a matrix <a href="https://www.plumed.org/doc-master/user-doc/html/TRANSPOSE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the vector or matrix that should be transposed<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datoq1">oq1</b>
<b name="data/Steinhardt.md_working_17.datcmat2" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datcmat2","data/Steinhardt.md_working_17.datcmat2","red")'>cmat2</b><span style="display:none;" id="data/Steinhardt.md_working_17.datcmat2">The CONTACT_MATRIX action with label <b>cmat2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat2</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<b name="data/Steinhardt.md_working_17.dats" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.dats","data/Steinhardt.md_working_17.dats","red")'>s</b><span style="display:none;" id="data/Steinhardt.md_working_17.dats">The MATRIX_PRODUCT action with label <b>s</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">s</td><td width="5%"><font color="red">matrix</font></td><td>the product of the two input matrices</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_PRODUCT<span class="right">Calculate the product of two matrices <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the two matrices from which the product is calculated<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datoq1">oq1</b>,<b name="data/Steinhardt.md_working_17.datoq1T">oq1T</b>
<b name="data/Steinhardt.md_working_17.datf" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datf","data/Steinhardt.md_working_17.datf","red")'>f</b><span style="display:none;" id="data/Steinhardt.md_working_17.datf">The CUSTOM action with label <b>f</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">f</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datcmat2">cmat2</b>,<b name="data/Steinhardt.md_working_17.dats">s</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># Tranform all the elements of f with a switching function that is one when f_ij&gt;0.5</span>
<b name="data/Steinhardt.md_working_17.datfmt" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datfmt","data/Steinhardt.md_working_17.datfmt","red")'>fmt</b><span style="display:none;" id="data/Steinhardt.md_working_17.datfmt">The MORE_THAN action with label <b>fmt</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">fmt</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of a function that is one if the if the input is more than a threshold to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MORE_THAN<span class="right">Use a switching function to determine how many of the input variables are more than a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/MORE_THAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datf">f</b> <span class="plumedtooltip">SWITCH<span class="right">This keyword is used if you want to employ an alternative to the continuous swiching function defined above<i></i></span></span>={RATIONAL R_0=0.5}
<span style="color:blue" class="comment"># Add all the elemnets of the matrix fmt together</span>
<b name="data/Steinhardt.md_working_17.datfs" onclick='showPath("data/Steinhardt.md_working_17.dat","data/Steinhardt.md_working_17.datfs","data/Steinhardt.md_working_17.datfs","black")'>fs</b><span style="display:none;" id="data/Steinhardt.md_working_17.datfs">The SUM action with label <b>fs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">fs</td><td width="5%"><font color="black">scalar</font></td><td>the SUM of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SUM<span class="right">Calculate the sum of the arguments <a href="https://www.plumed.org/doc-master/user-doc/html/SUM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datfmt">fmt</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># This outputs a single scalar </span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_17.datfs">fs</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

You could even apply the switching function to $S$ and only then multiply the transformed version of $S$ by the second contact matrix.
Alternatively, you can calculate a new symmetry function for each of the atoms in your system by multiplying $F$ by a vector of all ones as following:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_18.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_18.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_18.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<b name="data/Steinhardt.md_working_18.datcmat" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datcmat","data/Steinhardt.md_working_18.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_18.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span id="data/Steinhardt.md_working_18.datones_short"><b name="data/Steinhardt.md_working_18.datones" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datones","data/Steinhardt.md_working_18.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_18.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_18.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
</span><span id="data/Steinhardt.md_working_18.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_18.datones")'># ones: ONES SIZE=100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_18.datones" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datones","data/Steinhardt.md_working_18.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_18.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><b name="data/Steinhardt.md_working_18.datcoord" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datcoord","data/Steinhardt.md_working_18.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_18.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_18.datones">ones</b>
<b name="data/Steinhardt.md_working_18.datsh" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datsh","data/Steinhardt.md_working_18.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_18.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_18.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_18.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_18.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_18.datsp" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datsp","data/Steinhardt.md_working_18.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_18.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_18.datones">ones</b>    
<b name="data/Steinhardt.md_working_18.datq1_2" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datq1_2","data/Steinhardt.md_working_18.datq1_2","blue")'>q1_2</b><span style="display:none;" id="data/Steinhardt.md_working_18.datq1_2">The COMBINE action with label <b>q1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_18.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_18.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_18.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_18.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_18.datsp">sp.im-p1</b>
<b name="data/Steinhardt.md_working_18.datq1" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datq1","data/Steinhardt.md_working_18.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_18.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datq1_2">q1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_18.datstack" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datstack","data/Steinhardt.md_working_18.datstack","red")'>stack</b><span style="display:none;" id="data/Steinhardt.md_working_18.datstack">The VSTACK action with label <b>stack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">stack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_18.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_18.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_18.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_18.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_18.datsp">sp.im-p1</b>
<span id="data/Steinhardt.md_working_18.datlones_short"><b name="data/Steinhardt.md_working_18.datlones" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datlones","data/Steinhardt.md_working_18.datlones_shortcut","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_18.datlones_shortcut">The ONES action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_18.datlones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
</span><span id="data/Steinhardt.md_working_18.datlones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_18.datlones")'># lones: ONES SIZE=6</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_18.datlones" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datlones","data/Steinhardt.md_working_18.datlones","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_18.datlones">The CONSTANT action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span id="data/Steinhardt.md_working_18.datdefunorm_short"><b name="data/Steinhardt.md_working_18.datunorm" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datunorm","data/Steinhardt.md_working_18.datunorm","red")'>unorm</b><span style="display:none;" id="data/Steinhardt.md_working_18.datunorm">The OUTER_PRODUCT action with label <b>unorm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">unorm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_18.datdefunorm");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datq1">q1</b>,<b name="data/Steinhardt.md_working_18.datlones">lones</b>
</span><span id="data/Steinhardt.md_working_18.datdefunorm_long" style="display:none;"><b name="data/Steinhardt.md_working_18.datunorm" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datunorm","data/Steinhardt.md_working_18.datunorm","red")'>unorm</b>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_18.datdefunorm");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datq1">q1</b>,<b name="data/Steinhardt.md_working_18.datlones">lones</b>  <span class="plumedtooltip">FUNC<span class="right"> the function of the input vectors that should be put in the elements of the outer product<i></i></span></span>=x*y
</span><b name="data/Steinhardt.md_working_18.datoq1" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datoq1","data/Steinhardt.md_working_18.datoq1","red")'>oq1</b><span style="display:none;" id="data/Steinhardt.md_working_18.datoq1">The CUSTOM action with label <b>oq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datstack">stack</b>,<b name="data/Steinhardt.md_working_18.datunorm">unorm</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_18.datoq1T" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datoq1T","data/Steinhardt.md_working_18.datoq1T","red")'>oq1T</b><span style="display:none;" id="data/Steinhardt.md_working_18.datoq1T">The TRANSPOSE action with label <b>oq1T</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1T</td><td width="5%"><font color="red">matrix</font></td><td>the transpose of the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">TRANSPOSE<span class="right">Calculate the transpose of a matrix <a href="https://www.plumed.org/doc-master/user-doc/html/TRANSPOSE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the vector or matrix that should be transposed<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datoq1">oq1</b>
<b name="data/Steinhardt.md_working_18.datcmat2" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datcmat2","data/Steinhardt.md_working_18.datcmat2","red")'>cmat2</b><span style="display:none;" id="data/Steinhardt.md_working_18.datcmat2">The CONTACT_MATRIX action with label <b>cmat2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat2</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<b name="data/Steinhardt.md_working_18.dats" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.dats","data/Steinhardt.md_working_18.dats","red")'>s</b><span style="display:none;" id="data/Steinhardt.md_working_18.dats">The MATRIX_PRODUCT action with label <b>s</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">s</td><td width="5%"><font color="red">matrix</font></td><td>the product of the two input matrices</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_PRODUCT<span class="right">Calculate the product of two matrices <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the two matrices from which the product is calculated<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datoq1">oq1</b>,<b name="data/Steinhardt.md_working_18.datoq1T">oq1T</b>
<b name="data/Steinhardt.md_working_18.datf" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datf","data/Steinhardt.md_working_18.datf","red")'>f</b><span style="display:none;" id="data/Steinhardt.md_working_18.datf">The CUSTOM action with label <b>f</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">f</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datcmat2">cmat2</b>,<b name="data/Steinhardt.md_working_18.dats">s</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO  
<span style="color:blue" class="comment"># This outputs a vector with 100 elements </span>
<b name="data/Steinhardt.md_working_18.datlq1" onclick='showPath("data/Steinhardt.md_working_18.dat","data/Steinhardt.md_working_18.datlq1","data/Steinhardt.md_working_18.datlq1","blue")'>lq1</b><span style="display:none;" id="data/Steinhardt.md_working_18.datlq1">The MATRIX_VECTOR_PRODUCT action with label <b>lq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datf">f</b>,<b name="data/Steinhardt.md_working_18.datones">ones</b> 
<span style="color:blue" class="comment"># This prints the 100 symmetry function values to the file colvar</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_18.datlq1">lq1</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

There is a shortcut that does the same as this last input which works as follows:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_19.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_19.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_19.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the steinhardt parameters</span>
<span id="data/Steinhardt.md_working_19.datq1_short"><b name="data/Steinhardt.md_working_19.datq1" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datq1","data/Steinhardt.md_working_19.datq1_shortcut","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_19.datq1_shortcut">The Q1 action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the norms of the vectors of spherical harmonic coefficients</td></tr></table></span>: <span class="plumedtooltip" style="color:green">Q1<span class="right">Calculate 1st order Steinhardt parameters This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_19.datq1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/Q1">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
</span><span id="data/Steinhardt.md_working_19.datq1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_19.datq1")'># q1: Q1 SPECIES=1-100 SWITCH={RATIONAL D_0=2.0 R_0=1.0}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_19.datq1_grp" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datq1_grp","data/Steinhardt.md_working_19.datq1_grp","violet")'>q1_grp</b><span style="display:none;" id="data/Steinhardt.md_working_19.datq1_grp">The GROUP action with label <b>q1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=1-100
<b name="data/Steinhardt.md_working_19.datq1_mat" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datq1_mat","data/Steinhardt.md_working_19.datq1_mat","red")'>q1_mat</b><span style="display:none;" id="data/Steinhardt.md_working_19.datq1_mat">The CONTACT_MATRIX action with label <b>q1_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_mat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">q1_mat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">q1_mat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">q1_mat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span>
<b name="data/Steinhardt.md_working_19.datq1_sh" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datq1_sh","data/Steinhardt.md_working_19.datq1_sh","red")'>q1_sh</b><span style="display:none;" id="data/Steinhardt.md_working_19.datq1_sh">The SPHERICAL_HARMONIC action with label <b>q1_sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1_mat">q1_mat.x</b>,<b name="data/Steinhardt.md_working_19.datq1_mat">q1_mat.y</b>,<b name="data/Steinhardt.md_working_19.datq1_mat">q1_mat.z</b>,<b name="data/Steinhardt.md_working_19.datq1_mat">q1_mat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_19.datq1_denom_ones" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datq1_denom_ones","data/Steinhardt.md_working_19.datq1_denom_ones","blue")'>q1_denom_ones</b><span style="display:none;" id="data/Steinhardt.md_working_19.datq1_denom_ones">The CONSTANT action with label <b>q1_denom_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_19.datq1_denom" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datq1_denom","data/Steinhardt.md_working_19.datq1_denom","blue")'>q1_denom</b><span style="display:none;" id="data/Steinhardt.md_working_19.datq1_denom">The MATRIX_VECTOR_PRODUCT action with label <b>q1_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1_mat">q1_mat.w</b>,<b name="data/Steinhardt.md_working_19.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_19.datq1_sp" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datq1_sp","data/Steinhardt.md_working_19.datq1_sp","blue")'>q1_sp</b><span style="display:none;" id="data/Steinhardt.md_working_19.datq1_sp">The MATRIX_VECTOR_PRODUCT action with label <b>q1_sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-p1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-p1 and the vector q1_denom_ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1_sh">q1_sh.*</b>,<b name="data/Steinhardt.md_working_19.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_19.datq1_norm2" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datq1_norm2","data/Steinhardt.md_working_19.datq1_norm2","blue")'>q1_norm2</b><span style="display:none;" id="data/Steinhardt.md_working_19.datq1_norm2">The COMBINE action with label <b>q1_norm2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.im-n1</b>,<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.rm-0</b>,<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.im-0</b>,<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.im-p1</b>
<b name="data/Steinhardt.md_working_19.datq1_norm" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datq1_norm","data/Steinhardt.md_working_19.datq1_norm","blue")'>q1_norm</b><span style="display:none;" id="data/Steinhardt.md_working_19.datq1_norm">The CUSTOM action with label <b>q1_norm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1_norm2">q1_norm2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_19.datq1" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datq1","data/Steinhardt.md_working_19.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_19.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1_norm">q1_norm</b>,<b name="data/Steinhardt.md_working_19.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Calculate the local steinhard parameters</span>
<span id="data/Steinhardt.md_working_19.datlq1_short"><b name="data/Steinhardt.md_working_19.datlq1" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1","data/Steinhardt.md_working_19.datlq1_shortcut","blue")'>lq1</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_shortcut">The LOCAL_Q1 action with label <b>lq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1</td><td width="5%"><font color="blue">vector</font></td><td>the values of the local steinhardt parameters for the input atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">LOCAL_Q1<span class="right">Calculate the local degree of order around an atoms by taking the average dot product between the q_1 vector on the central atom and the q_3 vector on the atoms in the first coordination sphere. This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_19.datlq1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/LOCAL_Q1">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the label of the action that computes the Steinhardt parameters for which you would like to calculate local steinhardt parameters<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1">q1</b> <span class="plumedtooltip">SWITCH<span class="right">This keyword is used if you want to employ an alternative to the continuous swiching function defined above<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
</span><span id="data/Steinhardt.md_working_19.datlq1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_19.datlq1")'># lq1: LOCAL_Q1 SPECIES=q1 SWITCH={RATIONAL D_0=2.0 R_0=1.0}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_19.datlq1_uvec" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_uvec","data/Steinhardt.md_working_19.datlq1_uvec","blue")'>lq1_uvec</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_uvec">The CONSTANT action with label <b>lq1_uvec</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_uvec</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
<b name="data/Steinhardt.md_working_19.datlq1_grp" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_grp","data/Steinhardt.md_working_19.datlq1_grp","violet")'>lq1_grp</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_grp">The GROUP action with label <b>lq1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1">q1</b>
<b name="data/Steinhardt.md_working_19.datlq1_nmat" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_nmat","data/Steinhardt.md_working_19.datlq1_nmat","red")'>lq1_nmat</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_nmat">The OUTER_PRODUCT action with label <b>lq1_nmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_nmat</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1_norm">q1_norm</b>,<b name="data/Steinhardt.md_working_19.datlq1_uvec">lq1_uvec</b>
<b name="data/Steinhardt.md_working_19.datlq1_uvecs" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_uvecs","data/Steinhardt.md_working_19.datlq1_uvecs","red")'>lq1_uvecs</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_uvecs">The VSTACK action with label <b>lq1_uvecs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_uvecs</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.im-n1</b>,<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.rm-0</b>,<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.im-0</b>,<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_19.datq1_sp">q1_sp.im-p1</b>
<b name="data/Steinhardt.md_working_19.datlq1_vecs" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_vecs","data/Steinhardt.md_working_19.datlq1_vecs","red")'>lq1_vecs</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_vecs">The CUSTOM action with label <b>lq1_vecs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_vecs</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datlq1_uvecs">lq1_uvecs</b>,<b name="data/Steinhardt.md_working_19.datlq1_nmat">lq1_nmat</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_19.datlq1_vecsT" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_vecsT","data/Steinhardt.md_working_19.datlq1_vecsT","red")'>lq1_vecsT</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_vecsT">The TRANSPOSE action with label <b>lq1_vecsT</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_vecsT</td><td width="5%"><font color="red">matrix</font></td><td>the transpose of the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">TRANSPOSE<span class="right">Calculate the transpose of a matrix <a href="https://www.plumed.org/doc-master/user-doc/html/TRANSPOSE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the vector or matrix that should be transposed<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datlq1_vecs">lq1_vecs</b>
<b name="data/Steinhardt.md_working_19.datlq1_cmap" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_cmap","data/Steinhardt.md_working_19.datlq1_cmap","red")'>lq1_cmap</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_cmap">The CONTACT_MATRIX action with label <b>lq1_cmap</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_cmap</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datq1">q1</b> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<b name="data/Steinhardt.md_working_19.datlq1_dpmat" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_dpmat","data/Steinhardt.md_working_19.datlq1_dpmat","red")'>lq1_dpmat</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_dpmat">The MATRIX_PRODUCT action with label <b>lq1_dpmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_dpmat</td><td width="5%"><font color="red">matrix</font></td><td>the product of the two input matrices</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_PRODUCT<span class="right">Calculate the product of two matrices <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the two matrices from which the product is calculated<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datlq1_vecs">lq1_vecs</b>,<b name="data/Steinhardt.md_working_19.datlq1_vecsT">lq1_vecsT</b> <span class="plumedtooltip">MASK<span class="right">a matrix that is used to used to determine which elements of the output matrix to compute<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datlq1_cmap">lq1_cmap</b>
<b name="data/Steinhardt.md_working_19.datlq1_prod" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_prod","data/Steinhardt.md_working_19.datlq1_prod","red")'>lq1_prod</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_prod">The CUSTOM action with label <b>lq1_prod</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_prod</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datlq1_cmap">lq1_cmap</b>,<b name="data/Steinhardt.md_working_19.datlq1_dpmat">lq1_dpmat</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_19.datlq1_ones" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_ones","data/Steinhardt.md_working_19.datlq1_ones","blue")'>lq1_ones</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_ones">The CONSTANT action with label <b>lq1_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_19.datlq1" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1","data/Steinhardt.md_working_19.datlq1","blue")'>lq1</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1">The MATRIX_VECTOR_PRODUCT action with label <b>lq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datlq1_prod">lq1_prod</b>,<b name="data/Steinhardt.md_working_19.datlq1_ones">lq1_ones</b>
<b name="data/Steinhardt.md_working_19.datlq1_denom" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_denom","data/Steinhardt.md_working_19.datlq1_denom","blue")'>lq1_denom</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_denom">The MATRIX_VECTOR_PRODUCT action with label <b>lq1_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datlq1_cmap">lq1_cmap</b>,<b name="data/Steinhardt.md_working_19.datlq1_ones">lq1_ones</b>
<b name="data/Steinhardt.md_working_19.datlq1_av" onclick='showPath("data/Steinhardt.md_working_19.dat","data/Steinhardt.md_working_19.datlq1_av","data/Steinhardt.md_working_19.datlq1_av","blue")'>lq1_av</b><span style="display:none;" id="data/Steinhardt.md_working_19.datlq1_av">The CUSTOM action with label <b>lq1_av</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_av</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datlq1">lq1</b>,<b name="data/Steinhardt.md_working_19.datlq1_denom">lq1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Print the local steinhardt parameters</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_19.datlq1">lq1</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

Please note that if you use the following input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_20.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_20.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_20.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the steinhardt parameters</span>
<span id="data/Steinhardt.md_working_20.datq1_short"><b name="data/Steinhardt.md_working_20.datq1" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datq1","data/Steinhardt.md_working_20.datq1_shortcut","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_20.datq1_shortcut">The Q1 action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the norms of the vectors of spherical harmonic coefficients</td></tr></table></span>: <span class="plumedtooltip" style="color:green">Q1<span class="right">Calculate 1st order Steinhardt parameters This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_20.datq1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/Q1">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
</span><span id="data/Steinhardt.md_working_20.datq1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_20.datq1")'># q1: Q1 SPECIES=1-100 SWITCH={RATIONAL D_0=2.0 R_0=1.0}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_20.datq1_grp" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datq1_grp","data/Steinhardt.md_working_20.datq1_grp","violet")'>q1_grp</b><span style="display:none;" id="data/Steinhardt.md_working_20.datq1_grp">The GROUP action with label <b>q1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=1-100
<b name="data/Steinhardt.md_working_20.datq1_mat" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datq1_mat","data/Steinhardt.md_working_20.datq1_mat","red")'>q1_mat</b><span style="display:none;" id="data/Steinhardt.md_working_20.datq1_mat">The CONTACT_MATRIX action with label <b>q1_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_mat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">q1_mat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">q1_mat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">q1_mat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span>
<b name="data/Steinhardt.md_working_20.datq1_sh" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datq1_sh","data/Steinhardt.md_working_20.datq1_sh","red")'>q1_sh</b><span style="display:none;" id="data/Steinhardt.md_working_20.datq1_sh">The SPHERICAL_HARMONIC action with label <b>q1_sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1_mat">q1_mat.x</b>,<b name="data/Steinhardt.md_working_20.datq1_mat">q1_mat.y</b>,<b name="data/Steinhardt.md_working_20.datq1_mat">q1_mat.z</b>,<b name="data/Steinhardt.md_working_20.datq1_mat">q1_mat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_20.datq1_denom_ones" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datq1_denom_ones","data/Steinhardt.md_working_20.datq1_denom_ones","blue")'>q1_denom_ones</b><span style="display:none;" id="data/Steinhardt.md_working_20.datq1_denom_ones">The CONSTANT action with label <b>q1_denom_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_20.datq1_denom" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datq1_denom","data/Steinhardt.md_working_20.datq1_denom","blue")'>q1_denom</b><span style="display:none;" id="data/Steinhardt.md_working_20.datq1_denom">The MATRIX_VECTOR_PRODUCT action with label <b>q1_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1_mat">q1_mat.w</b>,<b name="data/Steinhardt.md_working_20.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_20.datq1_sp" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datq1_sp","data/Steinhardt.md_working_20.datq1_sp","blue")'>q1_sp</b><span style="display:none;" id="data/Steinhardt.md_working_20.datq1_sp">The MATRIX_VECTOR_PRODUCT action with label <b>q1_sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-p1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-p1 and the vector q1_denom_ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1_sh">q1_sh.*</b>,<b name="data/Steinhardt.md_working_20.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_20.datq1_norm2" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datq1_norm2","data/Steinhardt.md_working_20.datq1_norm2","blue")'>q1_norm2</b><span style="display:none;" id="data/Steinhardt.md_working_20.datq1_norm2">The COMBINE action with label <b>q1_norm2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.im-n1</b>,<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.rm-0</b>,<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.im-0</b>,<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.im-p1</b>
<b name="data/Steinhardt.md_working_20.datq1_norm" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datq1_norm","data/Steinhardt.md_working_20.datq1_norm","blue")'>q1_norm</b><span style="display:none;" id="data/Steinhardt.md_working_20.datq1_norm">The CUSTOM action with label <b>q1_norm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1_norm2">q1_norm2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_20.datq1" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datq1","data/Steinhardt.md_working_20.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_20.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1_norm">q1_norm</b>,<b name="data/Steinhardt.md_working_20.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Calculate the local steinhard parameters</span>
<span id="data/Steinhardt.md_working_20.datlq1_short"><b name="data/Steinhardt.md_working_20.datlq1" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1","data/Steinhardt.md_working_20.datlq1_shortcut","blue")'>lq1</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_shortcut">The LOCAL_Q1 action with label <b>lq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1</td><td width="5%"><font color="blue">vector</font></td><td>the values of the local steinhardt parameters for the input atoms</td></tr><tr><td width="5%">lq1_mean</td><td width="5%"><font color="black">scalar</font></td><td>the mean of the colvars</td></tr></table></span>: <span class="plumedtooltip" style="color:green">LOCAL_Q1<span class="right">Calculate the local degree of order around an atoms by taking the average dot product between the q_1 vector on the central atom and the q_3 vector on the atoms in the first coordination sphere. This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_20.datlq1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/LOCAL_Q1">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the label of the action that computes the Steinhardt parameters for which you would like to calculate local steinhardt parameters<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1">q1</b> <span class="plumedtooltip">SWITCH<span class="right">This keyword is used if you want to employ an alternative to the continuous swiching function defined above<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">MEAN<span class="right"> calculate the mean of all the quantities<i></i></span></span>
</span><span id="data/Steinhardt.md_working_20.datlq1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_20.datlq1")'># lq1: LOCAL_Q1 SPECIES=q1 SWITCH={RATIONAL D_0=2.0 R_0=1.0} MEAN</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_20.datlq1_uvec" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_uvec","data/Steinhardt.md_working_20.datlq1_uvec","blue")'>lq1_uvec</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_uvec">The CONSTANT action with label <b>lq1_uvec</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_uvec</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
<b name="data/Steinhardt.md_working_20.datlq1_grp" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_grp","data/Steinhardt.md_working_20.datlq1_grp","violet")'>lq1_grp</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_grp">The GROUP action with label <b>lq1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1">q1</b>
<b name="data/Steinhardt.md_working_20.datlq1_nmat" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_nmat","data/Steinhardt.md_working_20.datlq1_nmat","red")'>lq1_nmat</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_nmat">The OUTER_PRODUCT action with label <b>lq1_nmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_nmat</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1_norm">q1_norm</b>,<b name="data/Steinhardt.md_working_20.datlq1_uvec">lq1_uvec</b>
<b name="data/Steinhardt.md_working_20.datlq1_uvecs" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_uvecs","data/Steinhardt.md_working_20.datlq1_uvecs","red")'>lq1_uvecs</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_uvecs">The VSTACK action with label <b>lq1_uvecs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_uvecs</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.im-n1</b>,<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.rm-0</b>,<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.im-0</b>,<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_20.datq1_sp">q1_sp.im-p1</b>
<b name="data/Steinhardt.md_working_20.datlq1_vecs" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_vecs","data/Steinhardt.md_working_20.datlq1_vecs","red")'>lq1_vecs</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_vecs">The CUSTOM action with label <b>lq1_vecs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_vecs</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datlq1_uvecs">lq1_uvecs</b>,<b name="data/Steinhardt.md_working_20.datlq1_nmat">lq1_nmat</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_20.datlq1_vecsT" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_vecsT","data/Steinhardt.md_working_20.datlq1_vecsT","red")'>lq1_vecsT</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_vecsT">The TRANSPOSE action with label <b>lq1_vecsT</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_vecsT</td><td width="5%"><font color="red">matrix</font></td><td>the transpose of the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">TRANSPOSE<span class="right">Calculate the transpose of a matrix <a href="https://www.plumed.org/doc-master/user-doc/html/TRANSPOSE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the vector or matrix that should be transposed<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datlq1_vecs">lq1_vecs</b>
<b name="data/Steinhardt.md_working_20.datlq1_cmap" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_cmap","data/Steinhardt.md_working_20.datlq1_cmap","red")'>lq1_cmap</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_cmap">The CONTACT_MATRIX action with label <b>lq1_cmap</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_cmap</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datq1">q1</b> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<b name="data/Steinhardt.md_working_20.datlq1_dpmat" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_dpmat","data/Steinhardt.md_working_20.datlq1_dpmat","red")'>lq1_dpmat</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_dpmat">The MATRIX_PRODUCT action with label <b>lq1_dpmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_dpmat</td><td width="5%"><font color="red">matrix</font></td><td>the product of the two input matrices</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_PRODUCT<span class="right">Calculate the product of two matrices <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the two matrices from which the product is calculated<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datlq1_vecs">lq1_vecs</b>,<b name="data/Steinhardt.md_working_20.datlq1_vecsT">lq1_vecsT</b> <span class="plumedtooltip">MASK<span class="right">a matrix that is used to used to determine which elements of the output matrix to compute<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datlq1_cmap">lq1_cmap</b>
<b name="data/Steinhardt.md_working_20.datlq1_prod" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_prod","data/Steinhardt.md_working_20.datlq1_prod","red")'>lq1_prod</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_prod">The CUSTOM action with label <b>lq1_prod</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_prod</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datlq1_cmap">lq1_cmap</b>,<b name="data/Steinhardt.md_working_20.datlq1_dpmat">lq1_dpmat</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_20.datlq1_ones" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_ones","data/Steinhardt.md_working_20.datlq1_ones","blue")'>lq1_ones</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_ones">The CONSTANT action with label <b>lq1_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_20.datlq1" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1","data/Steinhardt.md_working_20.datlq1","blue")'>lq1</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1">The MATRIX_VECTOR_PRODUCT action with label <b>lq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datlq1_prod">lq1_prod</b>,<b name="data/Steinhardt.md_working_20.datlq1_ones">lq1_ones</b>
<b name="data/Steinhardt.md_working_20.datlq1_denom" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_denom","data/Steinhardt.md_working_20.datlq1_denom","blue")'>lq1_denom</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_denom">The MATRIX_VECTOR_PRODUCT action with label <b>lq1_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datlq1_cmap">lq1_cmap</b>,<b name="data/Steinhardt.md_working_20.datlq1_ones">lq1_ones</b>
<b name="data/Steinhardt.md_working_20.datlq1_av" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_av","data/Steinhardt.md_working_20.datlq1_av","blue")'>lq1_av</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_av">The CUSTOM action with label <b>lq1_av</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_av</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datlq1">lq1</b>,<b name="data/Steinhardt.md_working_20.datlq1_denom">lq1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_20.datlq1_mean" onclick='showPath("data/Steinhardt.md_working_20.dat","data/Steinhardt.md_working_20.datlq1_mean","data/Steinhardt.md_working_20.datlq1_mean","black")'>lq1_mean</b><span style="display:none;" id="data/Steinhardt.md_working_20.datlq1_mean">The MEAN action with label <b>lq1_mean</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_mean</td><td width="5%"><font color="black">scalar</font></td><td>the MEAN of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MEAN<span class="right">Calculate the arithmetic mean of the elements in a vector <a href="https://www.plumed.org/doc-master/user-doc/html/MEAN" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datlq1_av">lq1_av</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Print the local steinhardt parameters</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_20.datlq1">lq1.mean</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

the quantity in the vector that is averaged is:

$$
s_i = \frac{ \sum_j F_{ij} }{ \sum_j \sigma(r_{ij}) }
$$

This is not the same vector that is output in the last but one example input above.  If you would like to output a vector that contains all the values for the quantity above you can calculate it using the following long input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_21.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_21.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_21.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<b name="data/Steinhardt.md_working_21.datcmat" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datcmat","data/Steinhardt.md_working_21.datcmat","red")'>cmat</b><span style="display:none;" id="data/Steinhardt.md_working_21.datcmat">The CONTACT_MATRIX action with label <b>cmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">cmat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">cmat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">cmat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<span id="data/Steinhardt.md_working_21.datones_short"><b name="data/Steinhardt.md_working_21.datones" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datones","data/Steinhardt.md_working_21.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_21.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_21.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100 
</span><span id="data/Steinhardt.md_working_21.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_21.datones")'># ones: ONES SIZE=100 </span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_21.datones" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datones","data/Steinhardt.md_working_21.datones","blue")'>ones</b><span style="display:none;" id="data/Steinhardt.md_working_21.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><b name="data/Steinhardt.md_working_21.datcoord" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datcoord","data/Steinhardt.md_working_21.datcoord","blue")'>coord</b><span style="display:none;" id="data/Steinhardt.md_working_21.datcoord">The MATRIX_VECTOR_PRODUCT action with label <b>coord</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coord</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datcmat">cmat.w</b>,<b name="data/Steinhardt.md_working_21.datones">ones</b>
<b name="data/Steinhardt.md_working_21.datsh" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datsh","data/Steinhardt.md_working_21.datsh","red")'>sh</b><span style="display:none;" id="data/Steinhardt.md_working_21.datsh">The SPHERICAL_HARMONIC action with label <b>sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datcmat">cmat.x</b>,<b name="data/Steinhardt.md_working_21.datcmat">cmat.y</b>,<b name="data/Steinhardt.md_working_21.datcmat">cmat.z</b>,<b name="data/Steinhardt.md_working_21.datcmat">cmat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_21.datsp" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datsp","data/Steinhardt.md_working_21.datsp","blue")'>sp</b><span style="display:none;" id="data/Steinhardt.md_working_21.datsp">The MATRIX_VECTOR_PRODUCT action with label <b>sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-n1 and the vector ones</td></tr><tr><td width="5%">sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-0 and the vector ones</td></tr><tr><td width="5%">sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.rm-p1 and the vector ones</td></tr><tr><td width="5%">sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-n1 and the vector ones</td></tr><tr><td width="5%">sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-0 and the vector ones</td></tr><tr><td width="5%">sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix sh.im-p1 and the vector ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datsh">sh.*</b>,<b name="data/Steinhardt.md_working_21.datones">ones</b>
<b name="data/Steinhardt.md_working_21.datq1_2" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datq1_2","data/Steinhardt.md_working_21.datq1_2","blue")'>q1_2</b><span style="display:none;" id="data/Steinhardt.md_working_21.datq1_2">The COMBINE action with label <b>q1_2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_21.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_21.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_21.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_21.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_21.datsp">sp.im-p1</b>
<b name="data/Steinhardt.md_working_21.datq1" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datq1","data/Steinhardt.md_working_21.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_21.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datq1_2">q1_2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_21.datstack" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datstack","data/Steinhardt.md_working_21.datstack","red")'>stack</b><span style="display:none;" id="data/Steinhardt.md_working_21.datstack">The VSTACK action with label <b>stack</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">stack</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datsp">sp.rm-n1</b>,<b name="data/Steinhardt.md_working_21.datsp">sp.im-n1</b>,<b name="data/Steinhardt.md_working_21.datsp">sp.rm-0</b>,<b name="data/Steinhardt.md_working_21.datsp">sp.im-0</b>,<b name="data/Steinhardt.md_working_21.datsp">sp.rm-p1</b>,<b name="data/Steinhardt.md_working_21.datsp">sp.im-p1</b>
<span id="data/Steinhardt.md_working_21.datlones_short"><b name="data/Steinhardt.md_working_21.datlones" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datlones","data/Steinhardt.md_working_21.datlones_shortcut","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_21.datlones_shortcut">The ONES action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_21.datlones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
</span><span id="data/Steinhardt.md_working_21.datlones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_21.datlones")'># lones: ONES SIZE=6</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_21.datlones" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datlones","data/Steinhardt.md_working_21.datlones","blue")'>lones</b><span style="display:none;" id="data/Steinhardt.md_working_21.datlones">The CONSTANT action with label <b>lones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><span id="data/Steinhardt.md_working_21.datdefunorm_short"><b name="data/Steinhardt.md_working_21.datunorm" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datunorm","data/Steinhardt.md_working_21.datunorm","red")'>unorm</b><span style="display:none;" id="data/Steinhardt.md_working_21.datunorm">The OUTER_PRODUCT action with label <b>unorm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">unorm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action has <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_21.datdefunorm");'>hidden defaults</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datq1">q1</b>,<b name="data/Steinhardt.md_working_21.datlones">lones</b> 
</span><span id="data/Steinhardt.md_working_21.datdefunorm_long" style="display:none;"><b name="data/Steinhardt.md_working_21.datunorm" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datunorm","data/Steinhardt.md_working_21.datunorm","red")'>unorm</b>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors This action uses the <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_21.datdefunorm");'>defaults shown here</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datq1">q1</b>,<b name="data/Steinhardt.md_working_21.datlones">lones</b>  <span class="plumedtooltip">FUNC<span class="right"> the function of the input vectors that should be put in the elements of the outer product<i></i></span></span>=x*y
</span><b name="data/Steinhardt.md_working_21.datoq1" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datoq1","data/Steinhardt.md_working_21.datoq1","red")'>oq1</b><span style="display:none;" id="data/Steinhardt.md_working_21.datoq1">The CUSTOM action with label <b>oq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datstack">stack</b>,<b name="data/Steinhardt.md_working_21.datunorm">unorm</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_21.datoq1T" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datoq1T","data/Steinhardt.md_working_21.datoq1T","red")'>oq1T</b><span style="display:none;" id="data/Steinhardt.md_working_21.datoq1T">The TRANSPOSE action with label <b>oq1T</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">oq1T</td><td width="5%"><font color="red">matrix</font></td><td>the transpose of the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">TRANSPOSE<span class="right">Calculate the transpose of a matrix <a href="https://www.plumed.org/doc-master/user-doc/html/TRANSPOSE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the vector or matrix that should be transposed<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datoq1">oq1</b>
<b name="data/Steinhardt.md_working_21.datcmat2" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datcmat2","data/Steinhardt.md_working_21.datcmat2","red")'>cmat2</b><span style="display:none;" id="data/Steinhardt.md_working_21.datcmat2">The CONTACT_MATRIX action with label <b>cmat2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cmat2</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<b name="data/Steinhardt.md_working_21.dats" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.dats","data/Steinhardt.md_working_21.dats","red")'>s</b><span style="display:none;" id="data/Steinhardt.md_working_21.dats">The MATRIX_PRODUCT action with label <b>s</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">s</td><td width="5%"><font color="red">matrix</font></td><td>the product of the two input matrices</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_PRODUCT<span class="right">Calculate the product of two matrices <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the two matrices from which the product is calculated<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datoq1">oq1</b>,<b name="data/Steinhardt.md_working_21.datoq1T">oq1T</b>
<b name="data/Steinhardt.md_working_21.datf" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datf","data/Steinhardt.md_working_21.datf","red")'>f</b><span style="display:none;" id="data/Steinhardt.md_working_21.datf">The CUSTOM action with label <b>f</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">f</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datcmat2">cmat2</b>,<b name="data/Steinhardt.md_working_21.dats">s</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO  
<span style="color:blue" class="comment"># This outputs a vector with 100 elements </span>
<b name="data/Steinhardt.md_working_21.datlq1" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datlq1","data/Steinhardt.md_working_21.datlq1","blue")'>lq1</b><span style="display:none;" id="data/Steinhardt.md_working_21.datlq1">The MATRIX_VECTOR_PRODUCT action with label <b>lq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datf">f</b>,<b name="data/Steinhardt.md_working_21.datones">ones</b> 
<span style="color:blue" class="comment"># This calculates the coordination number again, which is used as the demominator in the expression above</span>
<b name="data/Steinhardt.md_working_21.datdenom" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datdenom","data/Steinhardt.md_working_21.datdenom","blue")'>denom</b><span style="display:none;" id="data/Steinhardt.md_working_21.datdenom">The MATRIX_VECTOR_PRODUCT action with label <b>denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datcmat2">cmat2</b>,<b name="data/Steinhardt.md_working_21.datones">ones</b>
<span style="color:blue" class="comment"># And now we normalise by dividing by the coordination number</span>
<b name="data/Steinhardt.md_working_21.datlq1_av" onclick='showPath("data/Steinhardt.md_working_21.dat","data/Steinhardt.md_working_21.datlq1_av","data/Steinhardt.md_working_21.datlq1_av","blue")'>lq1_av</b><span style="display:none;" id="data/Steinhardt.md_working_21.datlq1_av">The CUSTOM action with label <b>lq1_av</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_av</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datlq1">lq1</b>,<b name="data/Steinhardt.md_working_21.datdenom">denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># This prints the 100 symmetry function values to the file colvar</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_21.datlq1_av">lq1_av</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

Alternatively, if you want to use the shortcut you can use:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Steinhardt.md_working_22.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Steinhardt.md_working_22.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Steinhardt.md_working_22.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the steinhardt parameters</span>
<span id="data/Steinhardt.md_working_22.datq1_short"><b name="data/Steinhardt.md_working_22.datq1" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datq1","data/Steinhardt.md_working_22.datq1_shortcut","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_22.datq1_shortcut">The Q1 action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the norms of the vectors of spherical harmonic coefficients</td></tr></table></span>: <span class="plumedtooltip" style="color:green">Q1<span class="right">Calculate 1st order Steinhardt parameters This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_22.datq1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/Q1">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
</span><span id="data/Steinhardt.md_working_22.datq1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_22.datq1")'># q1: Q1 SPECIES=1-100 SWITCH={RATIONAL D_0=2.0 R_0=1.0}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_22.datq1_grp" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datq1_grp","data/Steinhardt.md_working_22.datq1_grp","violet")'>q1_grp</b><span style="display:none;" id="data/Steinhardt.md_working_22.datq1_grp">The GROUP action with label <b>q1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=1-100
<b name="data/Steinhardt.md_working_22.datq1_mat" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datq1_mat","data/Steinhardt.md_working_22.datq1_mat","red")'>q1_mat</b><span style="display:none;" id="data/Steinhardt.md_working_22.datq1_mat">The CONTACT_MATRIX action with label <b>q1_mat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_mat.w</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr><tr><td width="5%">q1_mat.x</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the x axis</td></tr><tr><td width="5%">q1_mat.y</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the y axis</td></tr><tr><td width="5%">q1_mat.z</td><td width="5%"><font color="red">matrix</font></td><td>the projection of the bond on the z axis</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0} <span class="plumedtooltip">COMPONENTS<span class="right"> also calculate the components of the vector connecting the atoms in the contact matrix<i></i></span></span>
<b name="data/Steinhardt.md_working_22.datq1_sh" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datq1_sh","data/Steinhardt.md_working_22.datq1_sh","red")'>q1_sh</b><span style="display:none;" id="data/Steinhardt.md_working_22.datq1_sh">The SPHERICAL_HARMONIC action with label <b>q1_sh</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sh.rm-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.rm-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-n1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the n1th of these quantities</td></tr><tr><td width="5%">q1_sh.im-0</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the 0th of these quantities</td></tr><tr><td width="5%">q1_sh.im-p1</td><td width="5%"><font color="red">matrix</font></td><td>the real parts of the spherical harmonic values with the m value given  This is the p1th of these quantities</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SPHERICAL_HARMONIC<span class="right">Calculate the values of all the spherical harmonic funtions for a particular value of l. <a href="https://www.plumed.org/doc-master/user-doc/html/SPHERICAL_HARMONIC" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1_mat">q1_mat.x</b>,<b name="data/Steinhardt.md_working_22.datq1_mat">q1_mat.y</b>,<b name="data/Steinhardt.md_working_22.datq1_mat">q1_mat.z</b>,<b name="data/Steinhardt.md_working_22.datq1_mat">q1_mat.w</b> <span class="plumedtooltip">L<span class="right">the value of the angular momentum<i></i></span></span>=1
<b name="data/Steinhardt.md_working_22.datq1_denom_ones" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datq1_denom_ones","data/Steinhardt.md_working_22.datq1_denom_ones","blue")'>q1_denom_ones</b><span style="display:none;" id="data/Steinhardt.md_working_22.datq1_denom_ones">The CONSTANT action with label <b>q1_denom_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_22.datq1_denom" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datq1_denom","data/Steinhardt.md_working_22.datq1_denom","blue")'>q1_denom</b><span style="display:none;" id="data/Steinhardt.md_working_22.datq1_denom">The MATRIX_VECTOR_PRODUCT action with label <b>q1_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1_mat">q1_mat.w</b>,<b name="data/Steinhardt.md_working_22.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_22.datq1_sp" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datq1_sp","data/Steinhardt.md_working_22.datq1_sp","blue")'>q1_sp</b><span style="display:none;" id="data/Steinhardt.md_working_22.datq1_sp">The MATRIX_VECTOR_PRODUCT action with label <b>q1_sp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_sp.rm-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.rm-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.rm-p1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-n1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-n1 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-0</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-0 and the vector q1_denom_ones</td></tr><tr><td width="5%">q1_sp.im-p1</td><td width="5%"><font color="blue">vector</font></td><td>the product of the matrix q1_sh.im-p1 and the vector q1_denom_ones</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1_sh">q1_sh.*</b>,<b name="data/Steinhardt.md_working_22.datq1_denom_ones">q1_denom_ones</b>
<b name="data/Steinhardt.md_working_22.datq1_norm2" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datq1_norm2","data/Steinhardt.md_working_22.datq1_norm2","blue")'>q1_norm2</b><span style="display:none;" id="data/Steinhardt.md_working_22.datq1_norm2">The COMBINE action with label <b>q1_norm2</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm2</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of a linear compbination to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">COMBINE<span class="right">Calculate a polynomial combination of a set of other variables. <a href="https://www.plumed.org/doc-master/user-doc/html/COMBINE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO <span class="plumedtooltip">POWERS<span class="right"> the powers to which you are raising each of the arguments in your function<i></i></span></span>=2,2,2,2,2,2 <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.im-n1</b>,<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.rm-0</b>,<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.im-0</b>,<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.im-p1</b>
<b name="data/Steinhardt.md_working_22.datq1_norm" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datq1_norm","data/Steinhardt.md_working_22.datq1_norm","blue")'>q1_norm</b><span style="display:none;" id="data/Steinhardt.md_working_22.datq1_norm">The CUSTOM action with label <b>q1_norm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1_norm</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1_norm2">q1_norm2</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=sqrt(x) <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_22.datq1" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datq1","data/Steinhardt.md_working_22.datq1","blue")'>q1</b><span style="display:none;" id="data/Steinhardt.md_working_22.datq1">The CUSTOM action with label <b>q1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">q1</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1_norm">q1_norm</b>,<b name="data/Steinhardt.md_working_22.datq1_denom">q1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Calculate the local steinhard parameters</span>
<span id="data/Steinhardt.md_working_22.datlq1_short"><b name="data/Steinhardt.md_working_22.datlq1" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1","data/Steinhardt.md_working_22.datlq1_shortcut","blue")'>lq1</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_shortcut">The LOCAL_Q1 action with label <b>lq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1</td><td width="5%"><font color="blue">vector</font></td><td>the values of the local steinhardt parameters for the input atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">LOCAL_Q1<span class="right">Calculate the local degree of order around an atoms by taking the average dot product between the q_1 vector on the central atom and the q_3 vector on the atoms in the first coordination sphere. This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Steinhardt.md_working_22.datlq1");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/LOCAL_Q1">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the label of the action that computes the Steinhardt parameters for which you would like to calculate local steinhardt parameters<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1">q1</b> <span class="plumedtooltip">SWITCH<span class="right">This keyword is used if you want to employ an alternative to the continuous swiching function defined above<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
</span><span id="data/Steinhardt.md_working_22.datlq1_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Steinhardt.md_working_22.datlq1")'># lq1: LOCAL_Q1 SPECIES=q1 SWITCH={RATIONAL D_0=2.0 R_0=1.0}</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Steinhardt.md_working_22.datlq1_uvec" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_uvec","data/Steinhardt.md_working_22.datlq1_uvec","blue")'>lq1_uvec</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_uvec">The CONSTANT action with label <b>lq1_uvec</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_uvec</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=6
<b name="data/Steinhardt.md_working_22.datlq1_grp" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_grp","data/Steinhardt.md_working_22.datlq1_grp","violet")'>lq1_grp</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_grp">The GROUP action with label <b>lq1_grp</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_grp</td><td width="5%"><font color="violet">atoms</font></td><td>indices of atoms specified in GROUP</td></tr></table></span>: <span class="plumedtooltip" style="color:green">GROUP<span class="right">Define a group of atoms so that a particular list of atoms can be referenced with a single label in definitions of CVs or virtual atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/GROUP" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ATOMS<span class="right">the numerical indexes for the set of atoms in the group<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1">q1</b>
<b name="data/Steinhardt.md_working_22.datlq1_nmat" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_nmat","data/Steinhardt.md_working_22.datlq1_nmat","red")'>lq1_nmat</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_nmat">The OUTER_PRODUCT action with label <b>lq1_nmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_nmat</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the outer product of the two input vectors that was obtained using the function that was input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">OUTER_PRODUCT<span class="right">Calculate the outer product matrix of two vectors <a href="https://www.plumed.org/doc-master/user-doc/html/OUTER_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the two vectors from which the outer product is being computed<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1_norm">q1_norm</b>,<b name="data/Steinhardt.md_working_22.datlq1_uvec">lq1_uvec</b>
<b name="data/Steinhardt.md_working_22.datlq1_uvecs" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_uvecs","data/Steinhardt.md_working_22.datlq1_uvecs","red")'>lq1_uvecs</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_uvecs">The VSTACK action with label <b>lq1_uvecs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_uvecs</td><td width="5%"><font color="red">matrix</font></td><td>a matrix that contains the input vectors in its columns</td></tr></table></span>: <span class="plumedtooltip" style="color:green">VSTACK<span class="right">Create a matrix by stacking vectors together <a href="https://www.plumed.org/doc-master/user-doc/html/VSTACK" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values that you would like to stack together to construct the output matrix<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.rm-n1</b>,<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.im-n1</b>,<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.rm-0</b>,<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.im-0</b>,<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.rm-p1</b>,<b name="data/Steinhardt.md_working_22.datq1_sp">q1_sp.im-p1</b>
<b name="data/Steinhardt.md_working_22.datlq1_vecs" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_vecs","data/Steinhardt.md_working_22.datlq1_vecs","red")'>lq1_vecs</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_vecs">The CUSTOM action with label <b>lq1_vecs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_vecs</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datlq1_uvecs">lq1_uvecs</b>,<b name="data/Steinhardt.md_working_22.datlq1_nmat">lq1_nmat</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_22.datlq1_vecsT" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_vecsT","data/Steinhardt.md_working_22.datlq1_vecsT","red")'>lq1_vecsT</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_vecsT">The TRANSPOSE action with label <b>lq1_vecsT</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_vecsT</td><td width="5%"><font color="red">matrix</font></td><td>the transpose of the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">TRANSPOSE<span class="right">Calculate the transpose of a matrix <a href="https://www.plumed.org/doc-master/user-doc/html/TRANSPOSE" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the vector or matrix that should be transposed<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datlq1_vecs">lq1_vecs</b>
<b name="data/Steinhardt.md_working_22.datlq1_cmap" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_cmap","data/Steinhardt.md_working_22.datlq1_cmap","red")'>lq1_cmap</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_cmap">The CONTACT_MATRIX action with label <b>lq1_cmap</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_cmap</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datq1">q1</b> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={RATIONAL D_0=2.0 R_0=1.0}
<b name="data/Steinhardt.md_working_22.datlq1_dpmat" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_dpmat","data/Steinhardt.md_working_22.datlq1_dpmat","red")'>lq1_dpmat</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_dpmat">The MATRIX_PRODUCT action with label <b>lq1_dpmat</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_dpmat</td><td width="5%"><font color="red">matrix</font></td><td>the product of the two input matrices</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_PRODUCT<span class="right">Calculate the product of two matrices <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label of the two matrices from which the product is calculated<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datlq1_vecs">lq1_vecs</b>,<b name="data/Steinhardt.md_working_22.datlq1_vecsT">lq1_vecsT</b> <span class="plumedtooltip">MASK<span class="right">a matrix that is used to used to determine which elements of the output matrix to compute<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datlq1_cmap">lq1_cmap</b>
<b name="data/Steinhardt.md_working_22.datlq1_prod" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_prod","data/Steinhardt.md_working_22.datlq1_prod","red")'>lq1_prod</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_prod">The CUSTOM action with label <b>lq1_prod</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_prod</td><td width="5%"><font color="red">matrix</font></td><td>the matrix obtained by doing an element-wise application of an arbitrary function to the input matrix</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datlq1_cmap">lq1_cmap</b>,<b name="data/Steinhardt.md_working_22.datlq1_dpmat">lq1_dpmat</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<b name="data/Steinhardt.md_working_22.datlq1_ones" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_ones","data/Steinhardt.md_working_22.datlq1_ones","blue")'>lq1_ones</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_ones">The CONSTANT action with label <b>lq1_ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one <a href="https://www.plumed.org/doc-master/user-doc/html/ONES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
<b name="data/Steinhardt.md_working_22.datlq1" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1","data/Steinhardt.md_working_22.datlq1","blue")'>lq1</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1">The MATRIX_VECTOR_PRODUCT action with label <b>lq1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datlq1_prod">lq1_prod</b>,<b name="data/Steinhardt.md_working_22.datlq1_ones">lq1_ones</b>
<b name="data/Steinhardt.md_working_22.datlq1_denom" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_denom","data/Steinhardt.md_working_22.datlq1_denom","blue")'>lq1_denom</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_denom">The MATRIX_VECTOR_PRODUCT action with label <b>lq1_denom</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_denom</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datlq1_cmap">lq1_cmap</b>,<b name="data/Steinhardt.md_working_22.datlq1_ones">lq1_ones</b>
<b name="data/Steinhardt.md_working_22.datlq1_av" onclick='showPath("data/Steinhardt.md_working_22.dat","data/Steinhardt.md_working_22.datlq1_av","data/Steinhardt.md_working_22.datlq1_av","blue")'>lq1_av</b><span style="display:none;" id="data/Steinhardt.md_working_22.datlq1_av">The CUSTOM action with label <b>lq1_av</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq1_av</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datlq1">lq1</b>,<b name="data/Steinhardt.md_working_22.datlq1_denom">lq1_denom</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x/y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue"># --- End of included input --- </span></span><span style="color:blue" class="comment"># Print the local steinhardt parameters</span>
<span class="plumedtooltip" style="color:green">PRINT<span class="right">Print quantities to a file. <a href="https://www.plumed.org/doc-master/user-doc/html/PRINT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the labels of the values that you would like to print to the file<i></i></span></span>=<b name="data/Steinhardt.md_working_22.datlq1_av">lq1_av</b> <span class="plumedtooltip">FILE<span class="right">the name of the file on which to output these quantities<i></i></span></span>=colvar
</pre>
 {% endraw %} 

## Conclusion

The implementation of the Steinhardt parameters in previous versions of PLUMED grew rather organically, which made the code confusing and difficult to use.  I hope this article 
convinces readers that the changes that have been made are worthwhile.  This new structure exposes the linear algebra that is being used to compute all the variants on these particular
order parameters in the input file.  It is thus easier to determine what PLUMED is actually computing.  

All the old inputs should still work as I have included shortcuts that reproduce new-style input files that reproduce what PLUMED used to do in the past.  However, I hope that folks will not use 
these shortcuts in the future as when these new inputs are used it is much easier for folks to understand what has been done.
