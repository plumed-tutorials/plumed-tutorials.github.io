# Clustering

When studying nucleation it is often useful to use a clustering atoms to determine how many atoms are in the largest crystalline nucleus.
The implementation of this approach in PLUMED is detailed in [this paper](https://pubs.acs.org/doi/abs/10.1021/acs.jctc.6b01073).  A typical 
input in that paper for calcluating the number of atoms in the largest cluster is shown below:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Clusters.md_working_1.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Clusters.md_working_1.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Clusters.md_working_1.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-failed-red.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Ccalculate the coordination numbers of the atoms</span>
<b name="data/Clusters.md_working_1.datlq" onclick='showPath("data/Clusters.md_working_1.dat","data/Clusters.md_working_1.datlq","data/Clusters.md_working_1.datlq","brown")'>lq</b>: <span class="plumedtooltip" style="color:green">COORDINATIONNUMBER<span class="right">Calculate the coordination numbers of atoms so that you can then calculate functions of the distribution of <a href="https://www.plumed.org/doc-master/user-doc/html/COORDINATIONNUMBER" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">SPECIES<span class="right">the list of atoms for which the symmetry function is being calculated and the atoms that can be in the environments<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the switching function that it used in the construction of the contact matrix. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={CUBIC D_0=0.45 D_MAX=0.55}
<span style="color:blue" class="comment"># Calculate the contact matrix for the atoms for which we calculated the coordinaion numbers</span>
<span style="display:none;" id="data/Clusters.md_working_1.datlq">The COORDINATIONNUMBER action with label <b>lq</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">lq.value</td><td>the coordination numbers of the specified atoms</td></tr></table></span><b name="data/Clusters.md_working_1.datcm" onclick='showPath("data/Clusters.md_working_1.dat","data/Clusters.md_working_1.datcm","data/Clusters.md_working_1.datcm","brown")'>cm</b>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=<b name="data/Clusters.md_working_1.datlq">lq</b> <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={CUBIC D_0=0.45 D_MAX=0.55}
<span style="color:blue" class="comment"># Do a clustering using the contact matrix above</span>
<span style="display:none;" id="data/Clusters.md_working_1.datcm">The CONTACT_MATRIX action with label <b>cm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cm.value</td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span><b name="data/Clusters.md_working_1.datdfs" onclick='showPath("data/Clusters.md_working_1.dat","data/Clusters.md_working_1.datdfs","data/Clusters.md_working_1.datdfs","brown")'>dfs</b>: <span class="plumedtooltip" style="color:green">DFSCLUSTERING<span class="right">Find the connected components of the matrix using the depth first search clustering algorithm. <a href="https://www.plumed.org/doc-master/user-doc/html/DFSCLUSTERING" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">MATRIX<span class="right">You should use ARG instead of this keyword which was used in older versions of PLUMED and is provided for back compatibility only<i></i></span></span>=<b name="data/Clusters.md_working_1.datcm">cm</b>
<span style="color:blue" class="comment"># Sum the coordination numbers for the atoms in the largest cluster</span>
<span style="display:none;" id="data/Clusters.md_working_1.datdfs">The DFSCLUSTERING action with label <b>dfs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">dfs.value</td><td>vector with length that is equal to the number of rows in the input matrix</td></tr></table></span><b name="data/Clusters.md_working_1.datclust1" onclick='showPath("data/Clusters.md_working_1.dat","data/Clusters.md_working_1.datclust1","data/Clusters.md_working_1.datclust1","brown")'>clust1</b>: <span class="plumedtooltip" style="color:green">CLUSTER_PROPERTIES<span class="right">Calculate properties of the distribution of some quantities that are part of a connected component <a href="https://www.plumed.org/doc-master/user-doc/html/CLUSTER_PROPERTIES" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">CLUSTERS<span class="right">the label of the action that does the clustering<i></i></span></span>=<b name="data/Clusters.md_working_1.datdfs">dfs</b> <span class="plumedtooltip">ARG<span class="right">calculate the sum of the arguments calculated by this action for the cluster<i></i></span></span>=<b name="data/Clusters.md_working_1.datlq">lq</b> <span class="plumedtooltip">CLUSTER<span class="right"> which cluster would you like to look at 1 is the largest cluster, 2 is the second largest, 3 is the the third largest and so on<i></i></span></span>=1 <span class="plumedtooltip">SUM<span class="right"> calculate the sum of all the quantities<i></i></span></span>
<span style="display:none;" id="data/Clusters.md_working_1.datclust1">The CLUSTER_PROPERTIES action with label <b>clust1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">clust1.value</td><td>a vector that is one if the atom is part of the cluster or interest and zero otherwise</td></tr><tr><td width="5%">clust1.sum</td><td>the sum of the colvars</td></tr></table></span></pre>
 {% endraw %} 

This input is fine but it is also somewhat unweildy and a little confusing.  The problem is that you have to calculate the coordination numbers 
of all the atoms in order to do the clustering and (unless you have a deep understanding of the way the code is implemented) it is not clear why.
With the new sytax you can achieve the same result as follows:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Clusters.md_working_2.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Clusters.md_working_2.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Clusters.md_working_2.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the contact matrix.  This action computes a 100x100 matrix</span>
<b name="data/Clusters.md_working_2.datcm" onclick='showPath("data/Clusters.md_working_2.dat","data/Clusters.md_working_2.datcm","data/Clusters.md_working_2.datcm","red")'>cm</b><span style="display:none;" id="data/Clusters.md_working_2.datcm">The CONTACT_MATRIX action with label <b>cm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={CUBIC D_0=0.45 D_MAX=0.55}
<span style="color:blue" class="comment"># Do a clustering using the contact matrix that was computed above as input</span>
<span style="color:blue" class="comment"># This action returns a 100 dimensional vector. If element i of this matrix</span>
<span style="color:blue" class="comment"># is equal to 5 this means that atom i in the input to the contact matrix above</span>
<span style="color:blue" class="comment"># is part of the 5th largest cluster.  </span>
<b name="data/Clusters.md_working_2.datdfs" onclick='showPath("data/Clusters.md_working_2.dat","data/Clusters.md_working_2.datdfs","data/Clusters.md_working_2.datdfs","blue")'>dfs</b><span style="display:none;" id="data/Clusters.md_working_2.datdfs">The DFSCLUSTERING action with label <b>dfs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">dfs</td><td width="5%"><font color="blue">vector</font></td><td>vector with length that is equal to the number of rows in the input matrix.  Elements of this vector are equal to the cluster that each node is a part of</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DFSCLUSTERING<span class="right">Find the connected components of the matrix using the depth first search clustering algorithm. <a href="https://www.plumed.org/doc-master/user-doc/html/DFSCLUSTERING" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the input matrix<i></i></span></span>=<b name="data/Clusters.md_working_2.datcm">cm</b>
<span style="color:blue" class="comment"># This next action returns a vector with 100 elements. If element i is equal to 1 then atom </span>
<span style="color:blue" class="comment"># i is part of the largest cluster.  If it is equal to zero then it is part of some </span>
<span style="color:blue" class="comment"># other cluster.</span>
<b name="data/Clusters.md_working_2.datc1" onclick='showPath("data/Clusters.md_working_2.dat","data/Clusters.md_working_2.datc1","data/Clusters.md_working_2.datc1","blue")'>c1</b><span style="display:none;" id="data/Clusters.md_working_2.datc1">The CLUSTER_WEIGHTS action with label <b>c1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1</td><td width="5%"><font color="blue">vector</font></td><td>vector with elements that are one if the atom of interest is part of the required cluster and zero otherwise</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CLUSTER_WEIGHTS<span class="right">Setup a vector that has one for all the atoms that form part of the cluster of interest and that has zero for all other atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/CLUSTER_WEIGHTS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">CLUSTERS<span class="right">the label of the action that does the clustering<i></i></span></span>=<b name="data/Clusters.md_working_2.datdfs">dfs</b> <span class="plumedtooltip">CLUSTER<span class="right"> which cluster would you like to look at 1 is the largest cluster, 2 is the second largest, 3 is the the third largest and so on<i></i></span></span>=1
<span style="color:blue" class="comment"># Now calculate the coordination numbers using the usual matrix multiplication trick</span>
<span id="data/Clusters.md_working_2.datones_short"><b name="data/Clusters.md_working_2.datones" onclick='showPath("data/Clusters.md_working_2.dat","data/Clusters.md_working_2.datones","data/Clusters.md_working_2.datones_shortcut","blue")'>ones</b><span style="display:none;" id="data/Clusters.md_working_2.datones_shortcut">The ONES action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>a vector of ones with the required number of elements</td></tr></table></span>: <span class="plumedtooltip" style="color:green">ONES<span class="right">Create a constant vector with all elements equal to one This action is <a class="toggler" href='javascript:;' onclick='toggleDisplay("data/Clusters.md_working_2.datones");'>a shortcut</a>. <a href="https://www.plumed.org/doc-master/user-doc/html/ONES">More details</a><i></i></span></span> <span class="plumedtooltip">SIZE<span class="right">the number of ones that you would like to create<i></i></span></span>=100
</span><span id="data/Clusters.md_working_2.datones_long" style="display:none;"><span style="color:blue" class="comment"># PLUMED interprets the command:
</span><span class="toggler" style="color:red" onclick='toggleDisplay("data/Clusters.md_working_2.datones")'># ones: ONES SIZE=100</span>
<span style="color:blue" class="comment"># as follows (Click the red comment above to revert to the short version of the input):</span>
<b name="data/Clusters.md_working_2.datones" onclick='showPath("data/Clusters.md_working_2.dat","data/Clusters.md_working_2.datones","data/Clusters.md_working_2.datones","blue")'>ones</b><span style="display:none;" id="data/Clusters.md_working_2.datones">The CONSTANT action with label <b>ones</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">ones</td><td width="5%"><font color="blue">vector</font></td><td>the constant value that was read from the plumed input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONSTANT<span class="right">Create a constant value that can be passed to actions <a href="https://www.plumed.org/doc-master/user-doc/html/CONSTANT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">NOLOG<span class="right"> do not report all the read in scalars in the log<i></i></span></span> <span class="plumedtooltip">VALUES<span class="right">the numbers that are in your constant value<i></i></span></span>=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
<span style="color:blue"># --- End of included input --- </span></span><b name="data/Clusters.md_working_2.datcoords" onclick='showPath("data/Clusters.md_working_2.dat","data/Clusters.md_working_2.datcoords","data/Clusters.md_working_2.datcoords","blue")'>coords</b><span style="display:none;" id="data/Clusters.md_working_2.datcoords">The MATRIX_VECTOR_PRODUCT action with label <b>coords</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coords</td><td width="5%"><font color="blue">vector</font></td><td>the vector that is obtained by taking the product between the matrix and the vector that were input</td></tr></table></span>: <span class="plumedtooltip" style="color:green">MATRIX_VECTOR_PRODUCT<span class="right">Calculate the product of the matrix and the vector <a href="https://www.plumed.org/doc-master/user-doc/html/MATRIX_VECTOR_PRODUCT" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the label for the matrix and the vector/scalar that are being multiplied<i></i></span></span>=<b name="data/Clusters.md_working_2.datcm">cm</b>,<b name="data/Clusters.md_working_2.datones">ones</b>
<span style="color:blue" class="comment"># Multiply the coordination numbers by c1.  We now have a vector where element i is equal to the </span>
<span style="color:blue" class="comment"># coordiation number of atom i if atom i is part of the largest cluster and zero otherwise.</span>
<b name="data/Clusters.md_working_2.datfcoords" onclick='showPath("data/Clusters.md_working_2.dat","data/Clusters.md_working_2.datfcoords","data/Clusters.md_working_2.datfcoords","blue")'>fcoords</b><span style="display:none;" id="data/Clusters.md_working_2.datfcoords">The CUSTOM action with label <b>fcoords</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">fcoords</td><td width="5%"><font color="blue">vector</font></td><td>the vector obtained by doing an element-wise application of an arbitrary function to the input vectors</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CUSTOM<span class="right">Calculate a combination of variables using a custom expression. <a href="https://www.plumed.org/doc-master/user-doc/html/CUSTOM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the values input to this function<i></i></span></span>=<b name="data/Clusters.md_working_2.datcoords">coords</b>,<b name="data/Clusters.md_working_2.datc1">c1</b> <span class="plumedtooltip">FUNC<span class="right">the function you wish to evaluate<i></i></span></span>=x*y <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
<span style="color:blue" class="comment"># And lastly sum the coordination numbers of the atoms in the largest cluster</span>
<b name="data/Clusters.md_working_2.datcoordsum" onclick='showPath("data/Clusters.md_working_2.dat","data/Clusters.md_working_2.datcoordsum","data/Clusters.md_working_2.datcoordsum","black")'>coordsum</b><span style="display:none;" id="data/Clusters.md_working_2.datcoordsum">The SUM action with label <b>coordsum</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">coordsum</td><td width="5%"><font color="black">scalar</font></td><td>the SUM of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SUM<span class="right">Calculate the sum of the arguments <a href="https://www.plumed.org/doc-master/user-doc/html/SUM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Clusters.md_working_2.datfcoords">fcoords</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
</pre>
 {% endraw %} 

This new syntax is much more clear as the clustering operation is performed on the CONTACT_MATRIX directly.  The vector returned by the DFSCLUSTERING object 
then tells you which cluster each atom belongs to.  You can thus use simple logical operations on this vector to determine the properties for all your clusters. 
Furthermore, you don't even need to use the coordination numbers.  If you simply want to calculate the number of atoms in the largest cluster you can use the following
input:

{% raw %}
<div class="plumedpreheader">
<div class="headerInfo" id="value_details_data/Clusters.md_working_3.dat"> Click on the labels of the actions for more information on what each action computes </div>
<div class="containerBadge">
<div class="headerBadge"><a href="Clusters.md_working_3.dat.plumed.stderr"><img src="https://img.shields.io/badge/v2.9-failed-red.svg" alt="tested onv2.9" /></a></div>
<div class="headerBadge"><a href="Clusters.md_working_3.dat.plumed_master.stderr"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested onmaster" /></a></div>
</div>
</div>
<pre class="plumedlisting">
<span style="color:blue" class="comment"># Calculate the contact matrix.  This action computes a 100x100 matrix</span>
<b name="data/Clusters.md_working_3.datcm" onclick='showPath("data/Clusters.md_working_3.dat","data/Clusters.md_working_3.datcm","data/Clusters.md_working_3.datcm","red")'>cm</b><span style="display:none;" id="data/Clusters.md_working_3.datcm">The CONTACT_MATRIX action with label <b>cm</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">cm</td><td width="5%"><font color="red">matrix</font></td><td>a matrix containing the weights for the bonds between each pair of atoms</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CONTACT_MATRIX<span class="right">Adjacency matrix in which two atoms are adjacent if they are within a certain cutoff. <a href="https://www.plumed.org/doc-master/user-doc/html/CONTACT_MATRIX" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">GROUP<span class="right">specifies the list of atoms that should be assumed indistinguishable<i></i></span></span>=1-100 <span class="plumedtooltip">SWITCH<span class="right">the input for the switching function that acts upon the distance between each pair of atoms. Options for this keyword are explained in the documentation for <a href="https://www.plumed.org/doc-master/user-doc/html/LESS_THAN">LESS_THAN</a>.<i></i></span></span>={CUBIC D_0=0.45 D_MAX=0.55}
<span style="color:blue" class="comment"># Do the clustering</span>
<b name="data/Clusters.md_working_3.datdfs" onclick='showPath("data/Clusters.md_working_3.dat","data/Clusters.md_working_3.datdfs","data/Clusters.md_working_3.datdfs","blue")'>dfs</b><span style="display:none;" id="data/Clusters.md_working_3.datdfs">The DFSCLUSTERING action with label <b>dfs</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">dfs</td><td width="5%"><font color="blue">vector</font></td><td>vector with length that is equal to the number of rows in the input matrix.  Elements of this vector are equal to the cluster that each node is a part of</td></tr></table></span>: <span class="plumedtooltip" style="color:green">DFSCLUSTERING<span class="right">Find the connected components of the matrix using the depth first search clustering algorithm. <a href="https://www.plumed.org/doc-master/user-doc/html/DFSCLUSTERING" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the input matrix<i></i></span></span>=<b name="data/Clusters.md_working_3.datcm">cm</b>
<span style="color:blue" class="comment"># Get a 100 element vector that has ones for those atoms that are part of the largest cluster</span>
<b name="data/Clusters.md_working_3.datc1" onclick='showPath("data/Clusters.md_working_3.dat","data/Clusters.md_working_3.datc1","data/Clusters.md_working_3.datc1","blue")'>c1</b><span style="display:none;" id="data/Clusters.md_working_3.datc1">The CLUSTER_WEIGHTS action with label <b>c1</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">c1</td><td width="5%"><font color="blue">vector</font></td><td>vector with elements that are one if the atom of interest is part of the required cluster and zero otherwise</td></tr></table></span>: <span class="plumedtooltip" style="color:green">CLUSTER_WEIGHTS<span class="right">Setup a vector that has one for all the atoms that form part of the cluster of interest and that has zero for all other atoms. <a href="https://www.plumed.org/doc-master/user-doc/html/CLUSTER_WEIGHTS" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">CLUSTERS<span class="right">the label of the action that does the clustering<i></i></span></span>=<b name="data/Clusters.md_working_3.datdfs">dfs</b> <span class="plumedtooltip">CLUSTER<span class="right"> which cluster would you like to look at 1 is the largest cluster, 2 is the second largest, 3 is the the third largest and so on<i></i></span></span>=1   
<span style="color:blue" class="comment"># Sum the vector above to get the number of atoms in the largest cluster</span>
<b name="data/Clusters.md_working_3.datsuml" onclick='showPath("data/Clusters.md_working_3.dat","data/Clusters.md_working_3.datsuml","data/Clusters.md_working_3.datsuml","black")'>suml</b><span style="display:none;" id="data/Clusters.md_working_3.datsuml">The SUM action with label <b>suml</b> calculates the following quantities:<table  align="center" frame="void" width="95%" cellpadding="5%"><tr><td width="5%"><b> Quantity </b>  </td><td width="5%"><b> Type </b>  </td><td><b> Description </b> </td></tr><tr><td width="5%">suml</td><td width="5%"><font color="black">scalar</font></td><td>the SUM of the elements in the input value</td></tr></table></span>: <span class="plumedtooltip" style="color:green">SUM<span class="right">Calculate the sum of the arguments <a href="https://www.plumed.org/doc-master/user-doc/html/SUM" style="color:green">More details</a><i></i></span></span> <span class="plumedtooltip">ARG<span class="right">the vector/matrix/grid whose elements shuld be added together<i></i></span></span>=<b name="data/Clusters.md_working_3.datc1">c1</b> <span class="plumedtooltip">PERIODIC<span class="right">if the output of your function is periodic then you should specify the periodicity of the function<i></i></span></span>=NO
</pre>
 {% endraw %} 
